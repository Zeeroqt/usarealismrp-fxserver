import{R as I,r as m,a as o,j as s,F as L}from"./jsx-runtime-7cf68bf7.js";import{b as h,p as P,a as v,L as d,c as k,f as z,a1 as B,a2 as j,a3 as M,a4 as $,a5 as V,N as W,a6 as Y,a7 as F,a8 as G}from"./PhoneProvider-fb5cb781.js";function O(e){return O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},O(e)}function C(e,n,a,r){if(O(a)!==r)throw new TypeError("Invalid prop '".concat(n,"' of type '").concat(O(a),"' supplied to '").concat(e,"', expected '").concat(r,"'."))}function H(e,n){n===void 0&&(n={});var a=n.insertAt;if(e&&typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",a==="top"&&r.firstChild?r.insertBefore(t,r.firstChild):r.appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}}var U="Ring-module_container__1mCd7";function Q(e){var n=e.size,a=n===void 0?40:n,r=e.color,t=r===void 0?"black":r,c=e.lineWeight,p=c===void 0?5:c,l=e.speed,g=l===void 0?2:l;return C("Ring","size",a,"number"),C("Ring","color",t,"string"),C("Ring","lineWeight",p,"number"),C("Ring","speed",g,"number"),I.createElement("svg",{height:a,width:a,className:U,viewBox:"25 25 50 50",style:{"--uib-size":a+"px","--uib-color":t,"--uib-speed":g+"s"}},I.createElement("circle",{cx:"50",cy:"50",r:"20",strokeWidth:p}))}H(".Ring-module_container__1mCd7{animation:Ring-module_rotate__RBwLl var(--uib-speed) linear infinite;height:var(--uib-size);transform-origin:center;vertical-align:middle;width:var(--uib-size);will-change:transform}.Ring-module_container__1mCd7 circle{fill:none;stroke:var(--uib-color);stroke-dasharray:1,200;stroke-dashoffset:0;stroke-linecap:round;animation:Ring-module_stretch__L-1Qd calc(var(--uib-speed)*.75) ease-in-out infinite;will-change:stroke-dasharray,stroke-dashoffset}@keyframes Ring-module_rotate__RBwLl{to{transform:rotate(1turn)}}@keyframes Ring-module_stretch__L-1Qd{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,200;stroke-dashoffset:-35px}to{stroke-dashoffset:-124px}}");function T({app:e,showImages:n,big:a}){const{fetchAndSetAppInfo:r}=m.useContext(S),t=h(v.Settings),c=h(k),p=h(f),l=m.useRef(p),g=m.useRef(!0);m.useEffect(()=>{if(g.current){g.current=!1;return}},[t.apps]),m.useEffect(()=>{l.current=p},[p]);const y=()=>{let i=1,u;for(;;){if(t.apps[i]||(t.apps[i]=[]),u=t.apps[i].filter(A=>c.apps[A]!==void 0),u.length<24)return i;i++}},R=async()=>new Promise(async i=>{f.set([...f.value,{app:e.key,progress:20}]),i(await _())}),_=()=>new Promise(i=>{let u=y(),A={...t};A.apps[u??1].push(e.key),v.Settings.set(A),z("setSettings",A);let x=setInterval(()=>{l.current.forEach(N=>{if(N.app==e.key){let E=Math.floor(Math.random()*2)+1.5;if(N.progress+E>=100){N.progress=100;let w=f.value.filter(D=>D.app!=e.key);f.set(w),l.current=w}else N.progress+=E;f.set([...f.value.filter(w=>w.app!==e.key),N])}(l.current.length==0||l.current.every(E=>E.progress==100))&&(f.reset(),clearInterval(x),i(!0))})},250)});return m.useEffect(()=>{if(!a)return;const i=document.querySelector(".images");if(i)return i.addEventListener("wheel",u=>{u.preventDefault(),i.scrollLeft+=u.deltaY}),()=>{i.removeEventListener("wheel",u=>{u.preventDefault(),i.scrollLeft+=u.deltaY})}},[a]),o("div",{className:"app-item",onClick:()=>{a||r(e)},style:{cursor:a?"default":"pointer"},children:[o("div",{className:"upper",children:[o("div",{className:"app-info","data-big":a,children:[s("img",{className:"app-icon",src:e.icon??`./assets/img/icons/apps/${e.key}.png`}),o("div",{className:"app-content",children:[o("div",{className:"text",children:[s("div",{className:"app-name",children:e.name}),s("div",{className:"app-description",children:e.description})]}),a&&s(b,{app:e,installed:P(e.key,t.apps),installing:l.current.some(i=>i.app==e.key)&&l.current.find(i=>i.app==e.key).progress<100,cb:()=>{R().then(()=>{v.Settings.patch({storage:{...t.storage,used:t.storage.used+e.size}})})}})]})]}),!a&&s(b,{app:e,installed:P(e.key,t.apps),installing:l.current.some(i=>i.app==e.key)&&l.current.find(i=>i.app==e.key).progress<100,cb:()=>{R().then(()=>{v.Settings.patch({storage:{...t.storage,used:t.storage.used+e.size}})})}})]}),(a||n)&&e.images&&e.images.length>=0&&(a||!P(e.key,t.apps)||p.filter(i=>i.app===e.key).length>0)&&s("div",{className:"images","data-big":a,children:e.images&&e.images.filter((i,u)=>a?!0:u<3).map((i,u)=>s("img",{src:i},u))}),a&&o("section",{children:[s("div",{className:"title",children:d("APPS.APPSTORE.INFORMATION")}),o("div",{className:"items",children:[o("div",{className:"item",children:[s("div",{className:"title",children:d("APPS.APPSTORE.PROVIDER")}),s("div",{className:"value",children:(e.custom&&e.developer)??"LB Phone"})]}),o("div",{className:"item",children:[s("div",{className:"title",children:d("APPS.APPSTORE.SIZE")}),o("div",{className:"value",children:[e.size/1e3," MB"]})]}),o("div",{className:"item",children:[s("div",{className:"title",children:d("APPS.APPSTORE.COMPATIBILITY")}),s("div",{className:"value",children:"Works with this Phone"})]}),o("div",{className:"item",children:[s("div",{className:"title",children:d("APPS.APPSTORE.IN_APP_PURCHASES")}),s("div",{className:"value",children:"No"})]})]})]})]})}const b=({app:e,installed:n,installing:a,cb:r})=>a?s(Q,{size:25,lineWeight:5,speed:3,color:"#0a84ff"}):n?s("div",{className:"button",onClick:t=>{t.stopPropagation(),v.App.set({name:e.key})},children:d("APPS.APPSTORE.OPEN")}):s("div",{className:"button",onClick:t=>{t.stopPropagation(),r()},children:d("APPS.APPSTORE.GET")});function q(){const{App:e}=m.useContext(S),[n]=e;return s("div",{className:"appstore-app",children:s("div",{className:"appstore-app-body",children:s(T,{app:n,big:!0})})})}function Z(){const e=h(v.Settings),n=h(k);return s("div",{className:"appstore-page left",children:o("section",{children:[s("div",{className:"title",children:"Popular Apps"}),s("div",{className:"apps",children:Object.keys(n.apps).filter(a=>{var r;return((r=n.apps[a])==null?void 0:r.removable)&&!n.apps[a].game}).map((a,r)=>{if(!n.apps[a])return;let t={...n.apps[a],key:a};return s(T,{app:{...t,installed:P(t.key,e.apps)}},r)})})]})})}function J(){const e=h(v.Settings),n=h(k);return s("div",{className:"appstore-page left",children:o("section",{children:[s("div",{className:"title",children:d("APPS.APPSTORE.WHAT_WE_PLAYING")}),s("div",{className:"apps",children:Object.keys(n.apps).filter(a=>{var r;return((r=n.apps[a])==null?void 0:r.removable)&&n.apps[a].game}).map((a,r)=>{if(!n.apps[a])return;let t={...n.apps[a],key:a};return s(T,{app:{...t,installed:P(t.key,e.apps)}},r)})})]})})}function K(){const{View:e}=m.useContext(S),[n,a]=e,r=[{name:d("APPS.APPSTORE.TODAY"),value:"today",icon:s(B,{})},{name:d("APPS.APPSTORE.GAMES"),value:"games",icon:s(j,{})},{name:d("APPS.APPSTORE.TITLE"),value:"apps",icon:s(M,{})},{name:d("APPS.APPSTORE.SEARCH"),value:"search",icon:s($,{})}];return s("div",{className:"appstore-footer",children:r.map((t,c)=>o("div",{className:"item","data-active":t.value===n,onClick:()=>a(t.value),children:[t.icon,s("div",{className:"name",children:t.name})]},c))})}function X({hidden:e}){const{View:n,LastPage:a}=m.useContext(S),r=h(k),[t,c]=n,[p]=a,l={today:d("APPS.APPSTORE.TODAY"),apps:d("APPS.APPSTORE.APPS"),games:d("APPS.APPSTORE.GAMES"),search:d("APPS.APPSTORE.SEARCH")};return s(L,{children:o("div",{className:"appstore-header",children:[o("div",{className:"info",children:[t==="today"&&s("div",{className:"date",children:(()=>{const y=new Date,R=y.toLocaleString(r.DateLocale,{weekday:"long"}),_=y.getDate(),i=y.toLocaleString(r.DateLocale,{month:"long"});return`${R.toUpperCase()} ${_} ${i.toUpperCase()}`})()}),t==="app"?o("div",{className:"back",onClick:()=>c(p),children:[s(V,{}),W(p)]}):s("div",{className:"title",children:l[t]})]}),s(Y,{})]})})}function ee(){const e=h(v.Settings),n=h(k),[a,r]=m.useState("");return o("div",{className:"appstore-search left",children:[s(F,{placeholder:"Search",onChange:t=>r(t.target.value)}),s("div",{className:"app-list",children:Object.keys(n.apps).filter(t=>{var c;return(c=n.apps[t])==null?void 0:c.removable}).filter(t=>t.toLowerCase().includes(a.toLowerCase())).map((t,c)=>{if(!n.apps[t])return;let p={...n.apps[t],key:t};return s(T,{app:{...p,installed:P(p.key,e.apps)},showImages:!0},c)})})]})}const S=m.createContext(null),f=G([]);function te(){const[e,n]=m.useState("search"),[a,r]=m.useState("search"),[t,c]=m.useState(null),p={app:s(q,{}),games:s(J,{}),apps:s(Z,{}),search:s(ee,{})},l=g=>{c(g),r(e),n("app")};return s("div",{className:"appstore-container",children:s(L,{children:o(S.Provider,{value:{View:[e,n],App:[t,c],LastPage:[a,r],fetchAndSetAppInfo:l},children:[s(X,{hidden:e==="app"}),s("div",{className:"appstore-wrapper",children:p[e]}),s(K,{})]})})})}const ne=Object.freeze(Object.defineProperty({__proto__:null,AppStoreContext:S,Downloads:f,default:te},Symbol.toStringTag,{value:"Module"}));export{ne as A,f as D,H as e,Q as o,C as t};
