import{j as e,F as B,r as s,a}from"./jsx-runtime-55b9ff2c.js";import{u as ae,b as se,H as z,O as q,f as A,au as Le,C as H,L as i,X as ie,D as Re,aw as Me,e as ce,bs as Ae,W as Q,ay as Oe,bt as oe,S as ne,b1 as ye,K as de,h as X,a1 as me,bp as Pe,Q as re,q as J,a5 as te,a8 as pe,bu as Ge,r as fe,v as he,M as Ie,bv as Ve,Z as ve,_ as Ne,ar as _e,bw as be,B as Fe}from"./Phone-aba84f0c.js";import{r as De}from"./number-28525126.js";import{C as Ue}from"./Check-07e22bd8.js";import{formatNumber as xe}from"./Tiktok-106b1186.js";import{a as We}from"./DotSpinner-bb37008a.js";function Ce(n){const P=ae(se.Settings);return e(B,{children:n.liked?e("svg",{onClick:n.onClick,color:"#ed4956",fill:"#ed4956",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{onClick:n.onClick,color:P.display.theme==="dark"?"#ffffff":"#262626",fill:P.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})})})}function we(n){const{Account:P,View:E,Func:c,UserPanel:f}=s.useContext($),l=ae(se.Settings),[h]=P,[k,M]=E,[m,I]=f,[t,C]=s.useState(n.data),w=s.useRef(null);s.useRef(null);const[g,v]=s.useState(0),[N,b]=s.useState(!1),O={pos:{startLeft:0,startX:0},onMouseDown:r=>{O.pos={startLeft:w.current.scrollLeft,startX:r.clientX},w.current.style.userSelect="none",document.addEventListener("mouseup",O.onMouseUp),document.addEventListener("mousemove",O.onMove)},onMove:r=>{const p=(r.clientX-O.pos.startX)/Me(l.display.size);w.current.scrollLeft=O.pos.startLeft-p;const u=w.current.getBoundingClientRect();(u.left-5>r.clientX||r.clientX>u.right-5)&&O.onMouseUp()},onMouseUp:()=>{w.current.style.removeProperty("user-select"),document.removeEventListener("mouseup",O.onMouseUp),document.removeEventListener("mousemove",O.onMove);const r=JSON.parse(t.media),p=w.current.clientWidth;let u=g;const y=w.current.scrollLeft-O.pos.startLeft;y>p/2&&u<r.length-1?u++:y<-p/2&&u>0&&u--,V(u)}},V=r=>{w.current.scrollTo({left:r*w.current.offsetWidth,behavior:"smooth"}),v(r)};z("instagram:setLikes",r=>{r.postId!==t.id||r.isComment||C({...t,like_count:r.likes})});const F=r=>{if(r.detail===2){if(!t.id)return;t.liked||A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(p=>{C({...t,liked:p.liked,like_count:p.likes})}),b(!0),setTimeout(()=>{b(!1)},1e3)}};return a("div",{className:"post",id:n.last?"last":"",children:[a("div",{className:"post-header",children:[e("img",{className:"profile-picture",onClick:()=>{c.fetchAndSetProfile(t.username)},src:c.getAvatar(t.avatar)}),a("div",{className:"name",onClick:()=>c.fetchAndSetProfile(t.username),children:[t.username,t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),a("div",{className:"post-body",children:[N&&e("div",{className:`popup-heart ${N?"show":"hide"}`,children:e("svg",{color:"#e3e3e3",fill:"#e3e3e3",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})})}),e("div",{className:"image-container",ref:w,onMouseDown:O.onMouseDown,children:JSON.parse(t.media).map((r,p)=>e("div",{className:"image",onClick:F,children:q(r)?e("video",{src:r,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:r})},p))}),a("div",{className:"actions",children:[a("div",{className:"like-comment",children:[e(Ce,{liked:t.liked,onClick:()=>{t.id&&A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(r=>{C({...t,liked:r.liked,like_count:r.likes})})}}),e("svg",{onClick:()=>c.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp}),color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M20.656 17.008a9.993 9.993 0 10-3.59 3.615L22 22z",fill:"none",stroke:"currentColor",strokeWidth:"2px"})}),(t.username===h.username||h.isAdmin)&&e(Le,{onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.TITLE"),description:i("APPS.INSTAGRAM.DELETE_POST_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"deletePost",id:t.id}).then(r=>{r&&M("feed")})}}]})}})]}),JSON.parse(t.media).length>1&&e("div",{className:"scroll-dots",children:JSON.parse(t.media).map((r,p)=>e("div",{className:`dot ${g==p?"active":""}`,onClick:()=>V(p)},p))})]}),a("div",{className:"liked-by",onClick:()=>{I({display:!0,data:{title:i("APPS.INSTAGRAM.LIKED_BY"),postId:t.id,cb:()=>{M("feed")}}})},children:[t.like_count," ",i("APPS.INSTAGRAM.LIKES")]}),a("div",{className:"caption",children:[e("span",{className:"user",onClick:r=>{r.stopPropagation(),c.fetchAndSetProfile(t.username)},children:t.username}),ie(t.caption)," "]}),e("div",{className:"comments",onClick:r=>{r.stopPropagation(),c.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp})},children:t.comment_count>0?i("APPS.INSTAGRAM.VIEW_ALL_COMMENTS").format({count:t.comment_count}):i("APPS.INSTAGRAM.FIRST_COMMENT")}),e("div",{className:"date",children:Re(t.timestamp)})]})]})}function Be(){const{Account:n,View:P,Func:E,Stories:c}=s.useContext($),[f,l]=P,[h]=n,[k,M]=s.useState([]),[m,I]=s.useState([]),[t,C]=c,[w,g]=s.useState(0),[v,N]=s.useState(!1),[b,O]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getPosts",filters:{following:!0},page:0}).then(r=>{r&&M(r)})},[]),s.useEffect(()=>{f==="feed"&&(A("Instagram",{action:"getLives"}).then(r=>{r&&I(r)}),A("Instagram",{action:"getStories"}).then(r=>{r&&C([...r.sort((p,u)=>{if(p.seen===u.seen)return 0;if(p.seen===1)return 1;if(u.seen===1)return-1})])}))},[f]);const V=()=>{if(v||b)return;let r=document.querySelector("#last");if(!r)return;!Q(r)&&(O(!0),A("Instagram",{action:"getPosts",filters:{following:!0},page:w+1}).then(u=>{u&&u.length>0?(M([...k,...u]),O(!1)):N(!0)}),g(u=>u+1))};s.useEffect(()=>{const r=document.querySelector(".stories");r.addEventListener("wheel",p=>{p.preventDefault(),r.scrollLeft+=p.deltaY})},[]),z("instagram:updateLives",r=>{r&&I(r)});const F=()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.TITLE"),description:i("APPS.INSTAGRAM.GO_LIVE_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"goLive",user:{username:h.username,avatar:E.getAvatar(h==null?void 0:h.avatar),verified:h.verified}}),l("live")}}]})};return a(B,{children:[a("div",{className:"instagram-header feed-header",children:[a("div",{className:"name",children:[h.username,h.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),a("svg",{onClick:()=>l("dmList"),color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[e("line",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2",x1:"22",x2:"9.218",y1:"3",y2:"10.083"}),e("polygon",{fill:"none",points:"11.698 20.334 22 3.001 2 3.001 9.218 10.084 11.698 20.334",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})]})]}),a("div",{className:"feed",onScroll:V,children:[e("div",{className:"stories-wrapper",children:a("div",{className:"stories",children:[a("div",{className:"story self",onClick:()=>{H.ContextMenu.set({buttons:[{title:i("APPS.INSTAGRAM.GO_LIVE"),cb:()=>{F()}},{title:i("APPS.INSTAGRAM.CREATE_STORY"),cb:()=>{var r,p,u;H.Gallery.set({includeVideos:!0,allowExternal:(u=(p=(r=ce)==null?void 0:r.value)==null?void 0:p.AllowExternal)==null?void 0:u.Instagram,onSelect:y=>{A("Instagram",{action:"addToStory",media:y.src}).then(L=>{L&&C([{username:h.username,avatar:h.avatar,verified:h.verified,seen:0,id:L},...t.filter(o=>o.username!==h.username)])})}})}}]})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${E.getAvatar(h==null?void 0:h.avatar)})`},children:e("div",{className:"plus",children:e("i",{className:"far fa-plus"})})}),e("div",{className:"name",children:i("APPS.INSTAGRAM.YOUR_STORY")})]}),Object.keys(m).map((r,p)=>{var u;return a("div",{className:"story",onClick:()=>{A("Instagram",{action:"viewLive",username:r}),l("live")},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${E.getAvatar((u=m[r])==null?void 0:u.avatar)})`},children:e("img",{className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"})}),e("div",{className:"name",children:r})]},p)}),t.map((r,p)=>a("div",{className:"story",onClick:u=>{let[y,L]=Ae(u);E.fetchAndSetStory(r,null,{x:y,y:L})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${E.getAvatar(r==null?void 0:r.avatar)})`},children:e("img",{className:"circle","data-seen":r.seen===1,src:"./assets/img/icons/instagram/StoryCircle.png"})}),e("div",{className:"name",children:r.username})]},p))]})}),k.length===0&&e("div",{className:"no-posts",children:i("APPS.INSTAGRAM.EMPTY_FEED")}),k.map((r,p)=>{let u=p===k.length-1;return e(we,{data:r,last:u},p)})]})]})}function $e(){const{View:n,Account:P,Func:E}=s.useContext($),[c,f]=n,[l]=P,h=ae(ce),[k,M]=s.useState(""),[m,I]=s.useState(!1),[t,C]=s.useState(!1),w=s.useRef(null),[g,v]=s.useState({id:null,user:{username:"",avatar:"",verified:!1},viewers:0}),N=s.useRef(null),b=s.useRef(null),O=s.useRef(null),[V,F]=s.useState([]),[r,p]=s.useState([]),[u,y]=s.useState(null);s.useEffect(()=>{b.current.scrollTop=b.current.scrollHeight},[r]),s.useEffect(()=>{if(!u||O.current)return;let S=new Oe(u);O.current=S,S.resizeByAspect(3/4);const d=window.innerWidth;d>1280&&S.setQuality(1280/d)},[u]),s.useEffect(()=>()=>{O.current&&O.current.destroy()},[]),s.useEffect(()=>{const S=g;if(!(S!=null&&S.id)||!N.current||m)return;const d=h.ice?new oe({config:{iceTransportPolicy:"relay",iceServers:h.ice}}):new oe;d.on("open",()=>{const G=document.createElement("canvas");G.width=5,G.height=5;const R=G.captureStream(0),U=d.call(S.id,R);F([...V,U]),U.on("close",()=>{G.remove()}),U.on("error",()=>{G.remove()}),U.on("stream",x=>{const _=N.current;_.onloadeddata=()=>{_.play()},_.srcObject=x,A("Instagram",{action:"addCall",id:U.connectionId,username:l.username})})})},[N.current,g.user]),s.useEffect(()=>{if(I(l.username===(g==null?void 0:g.user.username)),(g==null?void 0:g.user.username)!==l.username||!u)return;const S=h.ice?new oe({config:{iceTransportPolicy:"relay",iceServers:h.ice}}):new oe;S.on("open",G=>{A("Instagram",{action:"setLive",username:l.username,verified:l.verified,id:G})});const d=u.captureStream(24);S.on("call",G=>{G.answer(d),G.on("close",()=>{F(V.filter(R=>R.connectionId!==G.connectionId))}),F([...V,G])})},[g,u]);const L=()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.END_LIVE_POPUP.TITLE"),description:i("APPS.INSTAGRAM.END_LIVE_POPUP.DESCRIPTION").format({action:(m?i("APPS.INSTAGRAM.END_LIVE_POPUP.END"):i("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE")).toLowerCase()}),buttons:[{title:i("APPS.INSTAGRAM.END_LIVE_POPUP.CANCEL")},{title:m?i("APPS.INSTAGRAM.END_LIVE_POPUP.END"):i("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE"),color:"red",cb:()=>{ne.ShouldClose.set(!0),T(!0)}}]})},o=()=>{A("Instagram",{action:"sendLiveMessage",data:{user:{username:l.username,avatar:l.avatar,verified:l.verified},live:g.user.username,content:k}}),M("")},T=(S,d)=>{if(m)A("Instagram",{action:"endLive",username:l.username}).then(()=>{f("feed")});else if(A("Instagram",{action:"stopViewing",username:g.user.username}),S)ne.ShouldClose.set(!0),v({...g,ended:!0});else{if(d===!1)return;f("feed")}V.forEach(G=>{G.close()}),F([])};return z("instagram:addMessage",S=>{S.live===g.user.username&&p([...r,S])}),z("instagram:updateViewers",S=>{S.username===(g==null?void 0:g.user.username)&&v({...g,viewers:S.viewers})}),z("instagram:setLive",S=>{v(S),ne.ShouldClose.set(!1)}),z("instagram:liveEnded",S=>{S===(g==null?void 0:g.user.username)&&T(!0)}),z("instagram:stopLive",()=>{f("feed")}),z("instagram:endCall",S=>{V.forEach(d=>{d.connectionId===S&&d.close()}),F(V.filter(d=>d.connectionId!==S))}),a(B,{children:[e("div",{className:"instagram-stream",children:m?e("canvas",{ref:S=>y(S)}):e("video",{ref:N})}),g.ended&&a("div",{className:"instagram-stream-ended",children:[e(ye,{onClick:()=>f("feed")}),e("div",{className:"title",children:i("APPS.INSTAGRAM.LIVE_ENDED")})]}),e(de,{children:t&&e(He,{username:g.user.username,owner:m,endLive:T,close:()=>C(!1)})}),a("div",{className:"instagram-live",children:[a("div",{className:"live-header",children:[a("div",{className:"profile",onClick:()=>{m||(T(),E.fetchAndSetProfile(g.user.username))},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${g.user.avatar?g.user.avatar:"./assets/img/icons/instagram/unknown-pfp.jpg"})`}}),a("div",{className:"name",children:[g.user.username.length>12?g.user.username.substring(0,12)+"...":g.user.username,g.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),a("div",{className:"stats",children:[e("div",{className:"live",children:i("APPS.INSTAGRAM.LIVE")}),a("div",{className:"viewers",onClick:()=>C(!0),children:[e("i",{className:"fas fa-eye"}),g.viewers]}),e("i",{className:"far fa-times x",onClick:()=>{m?L():T(!1)}})]})]}),a("div",{className:"comment-section",children:[e("div",{className:"comment-feed",ref:b,children:r.map((S,d)=>{let G=S.user.avatar??"./assets/img/icons/instagram/unknown-pfp.jpg";return a("div",{className:"comment",children:[e("img",{src:G}),a("div",{className:"info",children:[a("div",{className:"name",children:[S.user.username,S.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"comment-text",children:S.content})]})]},d)})}),a("div",{className:"comment-input",children:[e(X,{type:"text",ref:w,placeholder:i("APPS.INSTAGRAM.COMMENT_PLACEHOLDER"),onChange:S=>M(S.target.value),onKeyDown:S=>{S.key==="Enter"&&k.replace(/ /g,"").length>0&&(o(),w.current.value="")}}),e("i",{className:"far fa-paper-plane",onClick:()=>{k.replace(/ /g,"").length>0&&(o(),w.current.value="")}}),m&&e("i",{className:"fas fa-repeat",onClick:()=>{A("Instagram",{action:"flipCamera"})}})]})]})]})]})}const He=n=>{const{Func:P}=s.useContext($),[E,c]=s.useState([]);return s.useEffect(()=>{A("Instagram",{action:"getLiveViewers",username:n.username}).then(f=>{f&&c(f)})},[]),a(me.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[a("div",{className:"story-modal-header",children:[a("div",{className:"views",children:[e(Pe,{})," ",e("div",{className:"views",children:E.length})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),a("div",{className:"story-modal-content",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",children:E.map((f,l)=>{let h=l===E.length-1?"last":"";return e("div",{className:"item",id:h,children:a("div",{className:"user",onClick:()=>{n.owner||(n.endLive(!1,!1),P.fetchAndSetProfile(f.username))},children:[e("div",{className:"profile-picture",children:e("img",{src:P.getAvatar(f.avatar)})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[f.username,f.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:f.name})]})]})},l)})})]})]})};function Se(){const{View:n,Account:P,LoggedIn:E}=s.useContext($),c=ae(se.Settings),[f,l]=s.useState(""),[h,k]=s.useState(""),[M,m]=s.useState(""),[I,t]=s.useState(!1),[C,w]=s.useState(!1),[g,v]=s.useState(!1),[N,b]=n,[O,V]=P,[F,r]=E,[p,u]=s.useState("login"),y=()=>{t(!1),w(!1),A("Instagram",{action:"logIn",username:h,password:M}).then(o=>{o.success&&o.account?(w(!1),t(!1),A("isAdmin").then(T=>{J.APPS.INSTAGRAM.account.set(o.account),V({...o.account,isAdmin:T}),b("feed"),r(!0)})):o.error=="no account"?t(!0):o.error=="wrong password"?w(!0):console.log("Unknown error, please contact support with: Instagram LogIn.jsx onLogIn:43 [ALREADY LOGGED IN]",o==null?void 0:o.error)})},L=()=>{let o=h.toLowerCase().replace(/\s/g,"");o.length<3||o.length>15||A("Instagram",{action:"createAccount",name:f,username:o,password:M}).then(T=>{T.success?(w(!1),t(!1),A("isAdmin").then(S=>{let d={name:f,username:o,posts:0,followers:0,following:0};J.APPS.INSTAGRAM.account.set(d),V({...d,isAdmin:S}),b("feed"),r(!0)})):console.log("couldn't create account",T)})};return s.useEffect(()=>{w(!1),t(!1)},[p]),e("div",{className:"log-in",children:a(B,{children:[e("div",{className:"wrapper",children:p==="login"?a(B,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":c.display.theme}),a("div",{className:"form",children:[e(X,{placeholder:i("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:o=>k(o.target.value.replace(/\s/g,"")),maxLength:15}),I&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.NO_ACCOUNT")}),e(X,{placeholder:i("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:o=>m(o.target.value),maxLength:50}),C&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.WRONG_USERNAME_OR_PASSWORD")}),e("div",{className:"button",onClick:y,children:i("APPS.INSTAGRAM.LOG_IN")})]})]}):a(B,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":c.display.theme}),a("div",{className:"form",children:[e(X,{placeholder:i("APPS.INSTAGRAM.NAME_PLACEHOLDER"),type:"text",onChange:o=>l(o.target.value),maxLength:20}),e(X,{placeholder:i("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:o=>k(o.target.value.replace(/\s/g,"")),maxLength:15}),g&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.ACCOUNT_WITH_USERNAME")}),e(X,{placeholder:i("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:o=>m(o.target.value),maxLength:50}),e("div",{className:"button",onClick:L,children:i("APPS.INSTAGRAM.CREATE_ACCOUNT")})]})]})}),e("div",{className:"footer",children:p==="login"?a(B,{children:[i("APPS.INSTAGRAM.NOT_HAVE_ACCOUNT")," ",e("span",{onClick:()=>u("createAccount"),children:i("APPS.INSTAGRAM.CREATE_ACCOUNT")})]}):a(B,{children:[i("APPS.INSTAGRAM.HAVE_ACCOUNT")," ",e("span",{onClick:()=>u("login"),children:i("APPS.INSTAGRAM.LOG_IN")})]})})]})})}function je(){const[n,P]=s.useState([]),[E,c]=s.useState(0),[f,l]=s.useState(!1),[h,k]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getNotifications"}).then(m=>{m&&P(m)})},[]);const M=()=>{if(f||h)return;let m=document.querySelector("#last");if(!m)return;!Q(m)&&(k(!0),A("Instagram",{action:"getNotifications",page:E+1}).then(t=>{t&&t.length>0?(P([...n,...t]),k(!1)):l(!0)}),c(t=>t+1))};return a("div",{className:"notifications-container",children:[e("div",{className:"notifications-header",children:i("APPS.INSTAGRAM.ACTIVITY")}),e("div",{className:"notifications-body",onScroll:M,children:n.map((m,I)=>{let t=I===n.length-1?"last":"";return e(Ye,{notification:m,last:t},I)})})]})}const Ye=({notification:n,last:P})=>{const{Account:E,Func:c}=s.useContext($),[f]=E,[l,h]=s.useState(n.isFollowing);switch(n.type){case"like_photo":return a("div",{className:"notification-item",id:P,onClick:()=>c.fetchAndSetPost(n.postId),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:M=>{M.stopPropagation(),c.fetchAndSetProfile(n.username)}}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.LIKED_PHOTO"),e("span",{className:"date",children:te(n.timestamp)})]})]}),q(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"like_comment":return e("div",{className:"notification-item",id:P,onClick:()=>c.fetchAndSetPost(n.postId,!0),children:a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:M=>{M.stopPropagation(),c.fetchAndSetProfile(n.username)}}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.LIKED_COMMENT").format({comment:n.comment}),e("span",{className:"date",children:te(n.timestamp)})]})]})});case"comment":return a("div",{className:"notification-item",id:P,onClick:()=>c.fetchAndSetPost(n.postId,!0),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:M=>{M.stopPropagation(),c.fetchAndSetProfile(n.username)}}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.COMMENTED").format({comment:n.comment}),e("span",{className:"date",children:te(n.timestamp)})]})]}),q(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"follow":return a("div",{className:"notification-item",id:P,onClick:()=>c.fetchAndSetProfile(n.username),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:()=>c.fetchAndSetProfile(n.username)}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.FOLLOWED"),e("span",{className:"date",children:te(n.timestamp)})]})]}),e("div",{className:`button ${l?"following":"follow"}`,onClick:M=>{M.stopPropagation(),f.username!==n.username&&(l?H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:n.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:n.username,following:!l}}).then(()=>{h(m=>!m)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:n.username,following:!l}}).then(()=>{h(m=>!m)}))},children:l?i("APPS.INSTAGRAM.FOLLOWING"):i("APPS.INSTAGRAM.FOLLOW")})]})}};function ze(){const{View:n,Profile:P,Account:E,Func:c,GoBack:f,Post:l,UserPanel:h,LoggedIn:k,Dm:M}=s.useContext($),[m,I]=n,[t,C]=P,[w,g]=k,[v,N]=E,[b,O]=l,[V,F]=M,[r,p]=h,[u,y]=f,[L,o]=s.useState(!1),[T,S]=s.useState(!1),[d,G]=s.useState(null),[R,U]=s.useState(0),[x,_]=s.useState(!1),[W,j]=s.useState(!1);s.useEffect(()=>{t.username&&(o(v.username===t.username),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:0}).then(D=>{D&&G(D)}))},[t]);const ee=()=>{if(x||W)return;let D=document.querySelector("#last");if(!D)return;!Q(D)&&(j(!0),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:R+1}).then(Y=>{Y&&Y.length>0?(G([...d,...Y]),j(!1)):_(!0)}),U(Y=>Y+1))},ke=()=>{t.name&&A("Instagram",{action:"updateProfile",data:{name:t.name,bio:t.bio,avatar:t.avatar}}).then(D=>{D&&S(!1)})};z("instagram:setFollowers",D=>{D.username===t.username&&C({...t,followers:D.followers})}),z("instagram:setFollowing",D=>{D.username===t.username&&C({...t,following:D.following})});const ge=s.useRef(!0);s.useEffect(()=>{if(ge.current){ge.current=!1;return}A("Instagram",{action:"toggleFollow",data:{username:t.username,following:t.isFollowing}})},[t.isFollowing]);const Te=()=>{A("AccountSwitcher",{action:"getAccounts",app:"Instagram"}).then(D=>{var Z;if(!D)return fe("info","No accounts found");let K=v.isAdmin,Y=(Z=D==null?void 0:D.filter(le=>le!==t.username))==null?void 0:Z.map(le=>({title:le,cb:()=>{A("AccountSwitcher",{action:"switch",app:"Instagram",account:le}).then(ct=>{A("Instagram",{action:"isLoggedIn"}).then(ue=>{ue?(J.APPS.INSTAGRAM.account.set(ue),N({...ue,isAdmin:K}),I("feed"),g(!0)):J.APPS.INSTAGRAM.account.set(!1)})})}}));H.ContextMenu.set({buttons:[{title:v.username},...Y,{title:"Add Account",cb:()=>{g(!1)}}]})})};return e(B,{children:t&&a("div",{className:"profile",children:[e(de,{children:T&&a(me.div,{className:"edit-profile",initial:{y:750,opacity:.75},animate:{y:0,opacity:1},exit:{y:750,opacity:.75},transition:{duration:.3,ease:"easeInOut"},children:[a("div",{className:"edit-profile-header",children:[e("div",{className:"cancel",onClick:()=>S(!1),children:i("CANCEL")}),e("div",{className:"title",children:i("APPS.INSTAGRAM.EDIT_PROFILE")}),e("div",{className:"save",onClick:()=>ke(),children:i("APPS.INSTAGRAM.DONE")})]}),a("div",{className:"edit-profile-body",children:[a("div",{className:"profile-picture",onClick:()=>{var D,K,Y;H.Gallery.set({allowExternal:(Y=(K=(D=ce)==null?void 0:D.value)==null?void 0:K.AllowExternal)==null?void 0:Y.Instagram,onSelect:Z=>{C({...t,avatar:Z.src}),N({...v,avatar:Z.src})}})},children:[e("img",{src:c.getAvatar(t.avatar),alt:"profile"}),e("span",{children:i("APPS.INSTAGRAM.CHANGE_PICTURE")})]}),a("div",{className:"profile-items",children:[a("div",{className:"item",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.NAME")}),e(X,{placeholder:i("APPS.INSTAGRAM.NAME_PLACEHOLDER"),onChange:D=>{C({...t,name:D.target.value})},maxLength:30,defaultValue:t.name})]}),a("div",{className:"item",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.BIO")}),e(pe,{placeholder:i("APPS.INSTAGRAM.BIO"),onChange:D=>{C({...t,bio:D.target.value})},maxLength:100,defaultValue:t.bio??""})]})]}),e("div",{className:"sign-out",onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.TITLE"),description:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"signOut"}).then(D=>{g(null),N(null),J.APPS.INSTAGRAM.account.set(!1)})}}]})},children:"Sign Out"})]})]})}),L?e("div",{className:"instagram-header",children:a("div",{className:"name",style:{cursor:"pointer"},onClick:()=>Te(),children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})}),e(Ge,{})]})}):a("div",{className:"profile-header",children:[e("i",{className:"fas fa-chevron-left",onClick:()=>{u!=null&&u.cb?u.cb():I("feed")}}),a("div",{className:"name",children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("span",{})]}),a("div",{className:"profile-body",children:[a("div",{className:"profile-wrapper",children:[a("div",{className:"top",children:[a("div",{className:"profile-picture",style:{backgroundImage:`url(${c.getAvatar(t.avatar)})`},children:[t.isLive&&e("img",{onClick:()=>{A("Instagram",{action:"viewLive",username:t.username}),I("live")},className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"}),t.hasStory&&!t.isLive?e("img",{className:"circle","data-seen":t.seenStory===1,src:"./assets/img/icons/instagram/StoryCircle.png",onClick:D=>{let[K,Y]=Ae(D);c.fetchAndSetStory({username:t.username,avatar:t.avatar,verified:t.verified},null,{x:K,y:Y})}}):null]}),a("div",{className:"stats",children:[a("div",{children:[e("div",{className:"value",children:t.posts}),e("div",{className:"label",children:t.posts===1?i("APPS.INSTAGRAM.POST"):i("APPS.INSTAGRAM.POSTS")})]}),a("div",{onClick:()=>{p({display:!0,data:{title:"Followers",username:t.username,cb:()=>{C(t),I("profile"),p({display:!1})}}})},children:[e("div",{className:"value",children:t.followers}),e("div",{className:"label",children:t.followers===1?i("APPS.INSTAGRAM.FOLLOWER"):i("APPS.INSTAGRAM.FOLLOWERS")})]}),a("div",{onClick:()=>{p({display:!0,data:{title:i("APPS.INSTAGRAM.FOLLOWING"),username:t.username,cb:()=>{C(t),I("profile"),p({display:!1})}}})},children:[e("div",{className:"value",children:t.following}),e("div",{className:"label",children:i("APPS.INSTAGRAM.FOLLOWING")})]})]})]}),e("div",{className:"name",children:t.name}),e("div",{className:"description",children:ie(t.bio)??""}),e("div",{className:"buttons",children:L?L&&e("div",{className:"button edit",onClick:()=>{S(!0)},children:i("APPS.INSTAGRAM.EDIT_PROFILE")}):a(B,{children:[t.isFollowing?e("div",{className:"button following",onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:t.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{C({...t,isFollowing:!1})}}]})},children:i("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",onClick:()=>{C({...t,isFollowing:!0})},children:i("APPS.INSTAGRAM.FOLLOW")}),e("div",{className:"button following",onClick:()=>{F({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),I("dm")},children:i("APPS.INSTAGRAM.MESSAGE")})]})})]}),e("div",{className:"posts",onScroll:ee,children:d&&d.map((D,K)=>{let Y=K===d.length-1?"last":"",Z=JSON.parse(D.media)[0];return e("div",{id:Y,onClick:()=>{y({cb:()=>{C(t),I("profile"),O(null),y(null)}}),O(D),I("post")},children:q(Z)?e("video",{src:Z,muted:!0,autoPlay:!0,loop:!0}):e("img",{src:Z})},K)})})]})]})})}function Xe(){const{Func:n,View:P,GoBack:E,Post:c}=s.useContext($),[f,l]=P,[h,k]=E,[M,m]=c,[I,t]=s.useState(""),[C,w]=s.useState(""),[g,v]=s.useState([]);s.useState([]);const[N,b]=s.useState([]),[O,V]=s.useState(0),[F,r]=s.useState(!1),[p,u]=s.useState(!1);return s.useEffect(()=>{A("Instagram",{action:"getPosts",page:0}).then(L=>{L&&b(L)})},[]),s.useEffect(()=>{const L=setTimeout(()=>t(C),500);return()=>clearTimeout(L)},[C]),s.useEffect(()=>{I.length>0&&A("Instagram",{action:"search",query:I}).then(L=>{L&&v(L)})},[I]),a("div",{className:"search-container",children:[e("div",{className:"search-header",children:e(he,{placeholder:"Search",onChange:L=>w(L.target.value)})}),e("div",{className:"search-body",onScroll:()=>{if(F||p||I.length>0)return;let L=document.querySelector("#last");if(!L)return;!Q(L)&&(u(!0),A("Instagram",{action:"getPosts",page:O+1}).then(T=>{T&&T.length>0?(b([...N,...T]),u(!1)):r(!0)}),V(T=>T+1))},children:I.length>0?e("div",{className:"search-results",children:g.map(L=>a("div",{className:"item",onClick:()=>{n.fetchAndSetProfile(L.username)},children:[e("div",{className:"profile-picture",children:e("img",{src:n.getAvatar(L.avatar),alt:"profile"})}),a("div",{className:"user",children:[a("div",{className:"username",children:[L.username,L.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:L.name})]})]}))}):e("div",{className:"feed-grid",children:N.map((L,o)=>{let S=Math.floor(o/3)%2==0,d=!1;d=o%3==(S?1:0),N[o+1]||(d=!1);let G=JSON.parse(L.media)[0],R=o==N.length-1?"last":"";return e("div",{id:R,className:`grid-post${d?" big":""}`,onClick:()=>{k({cb:()=>{l("search"),k(null)}}),m(L),l("post")},children:q(G)?e("video",{src:G,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:G,alt:"post"})},o)})})})]})}function qe(){const{View:n,GoBack:P,Comments:E,Account:c,Func:f}=s.useContext($),[l]=c,[h,k]=n,[M]=P,[m,I]=E,[t,C]=s.useState(""),w=s.useRef(null),[g,v]=s.useState(0),[N,b]=s.useState(!1),[O,V]=s.useState(!1),F=()=>{t.length!==0&&A("Instagram",{action:"postComment",data:{postId:m.post.id,comment:t}}).then(()=>{C(""),w.current.value="",I({...m,post:m.post,comments:[{user:{username:l.username,avatar:l.avatar,verified:l.verified},comment:{content:t,timestamp:new Date().getTime(),likes:0,liked:!1}},...m.comments]})})},r=()=>{if(N||O)return;let p=document.querySelector("#last");if(!p)return;!Q(p)&&(V(!0),A("Instagram",{action:"getComments",postId:m.post.id,page:g+1}).then(y=>{y&&y.length>0?(I({...m,comments:[...m.comments,...y]}),V(!1)):b(!0)}),v(y=>y+1))};return a("div",{className:"comments-container",children:[a("div",{className:"comments-header",children:[e(Ie,{onClick:()=>{M&&(M!=null&&M.cb)?M.cb():k("feed")}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.COMMENTS")}),e("span",{})]}),a("div",{className:"comments-body",onScroll:r,children:[a("div",{className:"post-info",children:[e("div",{className:"profile-picture",children:e("img",{src:f.getAvatar(m.post.avatar),alt:"profile"})}),a("div",{className:"post-data",children:[a("div",{className:"caption",children:[a("span",{className:"username",children:[m.post.username,m.post.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),ie(m.post.caption)]}),e("div",{className:"actions",children:e("div",{className:"date",children:Ee(m.post.timestamp)})})]})]}),m.comments.map((p,u)=>{let y=u===m.comments.length-1;return e(Ke,{data:p,last:y},u)})]}),a("div",{className:"add-comment",children:[e("div",{className:"profile-picture",children:e("img",{src:f.getAvatar(l.avatar),alt:"profile"})}),a("div",{className:"input-container",children:[e(X,{type:"text",ref:w,placeholder:i("APPS.INSTAGRAM.ADD_COMMENT_AS").format({name:l.username}),onKeyPress:p=>{p.key==="Enter"&&F()},onChange:p=>C(p.target.value)}),e("div",{className:"send",onClick:F,children:i("APPS.INSTAGRAM.POST")})]})]})]})}const Ke=({data:n,last:P})=>{const{Func:E}=s.useContext($),[c,f]=s.useState(n.comment.liked),[l,h]=s.useState(n.comment.likes);return a("div",{className:"comment",id:P&&"last",children:[a("div",{className:"user",children:[e("div",{className:"profile-picture",onClick:()=>E.fetchAndSetProfile(n.user.username),children:e("img",{src:E.getAvatar(n.user.avatar),alt:"profile"})}),a("div",{className:"comment-data",children:[a("div",{className:"caption",children:[a("span",{className:"username",onClick:()=>E.fetchAndSetProfile(n.user.username),children:[n.user.username,n.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),n.comment.content]}),a("div",{className:"actions",children:[e("div",{className:"date",children:Ee(n.comment.timestamp)}),a("div",{className:"likes",children:[l," ",i("APPS.INSTAGRAM.LIKES").toLowerCase()]})]})]})]}),e(Ce,{liked:c,onClick:()=>{n.comment.id&&A("Instagram",{action:"toggleLike",data:{postId:n.comment.id,toggle:!c,isComment:!0}}).then(k=>{k&&(f(k.liked),h(k.likes))})}})]})},Ee=n=>{const P=new Date(n),c=new Date().getTime()-P.getTime(),f=Math.floor(c/(1e3*60*60*24)),l=Math.floor(c/(1e3*60*60)),h=Math.floor(c/(1e3*60));let k="";return f<1?l<1?k=`${h}m`:k=`${l}h`:f<30?k=`${f}d`:k=`${P.getDate()}/${P.getMonth()+1}/${P.getFullYear()}`,k};function Je(){var F,r,p;const{View:n}=s.useContext($),[P,E]=n,[c,f]=s.useState(0),[l,h]=s.useState([]),[k,M]=s.useState(""),[m,I]=s.useState([]),[t,C]=s.useState(""),[w,g]=s.useState(0),[v,N]=s.useState(!1),[b,O]=s.useState(!1);s.useEffect(()=>{A("Camera",{action:"getImages",page:0,filter:{showVideos:!0,showPhotos:!0}}).then(u=>{u&&I(u)})},[]);const V=u=>{if(b||v)return;let y=document.querySelector("#last");if(!y)return;!Q(y)&&(N(!0),A("Camera",{action:"getImages",page:w+1,filter:{showVideos:!0,showPhotos:!0}}).then(o=>{o&&o.length>0?(I([...m,...o]),N(!1)):O(!0)}),g(o=>o+1))};return s.useEffect(()=>{t&&t.includes("data:image")||Ve(t,u=>{if(u){const y=document.querySelector(".searchbox input");y&&(y.value=""),m.find(L=>L.src===t)||I(L=>[{src:t},...L])}})},[t]),a("div",{className:"newpost-container","data-camera":!1,children:[c===0&&a(B,{children:[a("div",{className:"newpost-header",children:[e("i",{className:"fal fa-times",onClick:()=>{E("feed")}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{l.length>0&&c==0&&f(1)},children:i("APPS.INSTAGRAM.NEXT")})]}),((p=(r=(F=ce)==null?void 0:F.value)==null?void 0:r.AllowExternal)==null?void 0:p.Instagram)&&e(he,{placeholder:i("COMPONENTS.GALLERY.EXTERNAL_URL"),onChange:u=>C(u.target.value)}),e("div",{className:"newpost-body",onScroll:V,children:e("div",{className:"images",children:m.map((u,y)=>{let L=y===m.length-1?"last":"";return a("div",{id:L,className:"image",onClick:()=>{l.includes(u.src)?h(l.filter(T=>T!==u.src)):l.length<5&&h([...l,u.src])},children:[q(u.src)?e(Qe,{src:u.src}):e("img",{src:u.src,alt:"image"}),e("div",{className:"select",children:e(Ue,{checked:l.includes(u.src)})})]},y)})})})]}),c===1&&a(B,{children:[a("div",{className:"newpost-header",children:[e("i",{className:"fal fa-chevron-left",onClick:()=>{f(0)}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{A("Instagram",{action:"newPost",data:{caption:k,images:l}}).then(u=>{u&&E("feed")})},children:i("APPS.INSTAGRAM.POST")})]}),e("div",{className:"newpost-body",children:a("div",{className:"caption",children:[e("div",{className:"image",children:q(l[0])?e("video",{src:l[0],muted:!0}):e("img",{src:l[0],alt:"image"})}),e(pe,{onChange:u=>{M(u.target.value)},placeholder:i("APPS.INSTAGRAM.CAPTION_PLACEHOLDER")})]})})]})]})}const Qe=({src:n})=>{const[P,E]=s.useState(null);return a(B,{children:[e("video",{src:n,crossOrigin:"anonymous",controls:!1,onMouseOver:f=>f.currentTarget.play(),onMouseOut:f=>f.currentTarget.pause(),onLoadedMetadata:f=>E(f.currentTarget.duration)}),P&&e("div",{className:"video-duration",children:(f=>{const l=Math.floor(f/60),h=De(f-l*60,0);return`${l}:${h<10?"0"+h:h}`})(P)})]})};function Ze(){const{View:n,Post:P,GoBack:E}=s.useContext($),[c,f]=n,[l]=E,[h]=P;return e(B,{children:h&&e("div",{className:"viewpost-container",children:a(B,{children:[a("div",{className:"viewpost-header",children:[e(Ie,{onClick:()=>{l&&(l.cb?l.cb():f(l.view))}}),e("div",{className:"name",children:h.username??"Unknown"}),e("span",{})]}),e("div",{className:"profile-body",children:e(we,{data:h})})]})})})}function et(){const{Func:n,Account:P,Dm:E,View:c,GoBack:f}=s.useContext($),l=ae(se.Settings),[h]=P,[k,M]=c,[m,I]=E,[t,C]=f,[w,g]=s.useState([]),v=s.useRef(null),[N,b]=s.useState({content:"",attachments:[]}),[O,V]=s.useState(0),[F,r]=s.useState(!1),[p,u]=s.useState(!1);s.useEffect(()=>{r(!1),u(!1),V(0),g([]),A("Instagram",{action:"getMessages",page:0,username:m.username}).then(o=>{o&&g(o.reverse())})},[]),z("instagram:newMessage",o=>{if(m.username!==o.sender)return;g([...w,o]);let T=document.querySelector(".dm-body-container");T.scrollTop=T.scrollHeight});const y=()=>{N.content.length===0&&N.attachments.length===0||A("Instagram",{action:"sendMessage",username:m.username,message:{content:N.content,attachments:N.attachments.length>0?N.attachments:null}}).then(o=>{if(!o)return;v.current.value="",g([...w,{sender:h.username,recipient:m.username,content:N.content,attachments:N.attachments,timestamp:new Date}]),b({content:"",attachments:[]});let T=document.querySelector(".dm-body-container");T.scrollTop=T.scrollHeight})},L=()=>{if(F||p)return;let o=document.querySelector("#last");if(!o)return;!Q(o)&&(u(!0),A("Instagram",{action:"getMessages",page:O+1,username:m.username}).then(S=>{S&&S.length>0?(g([...S.reverse(),...w]),u(!1)):r(!0)}),V(S=>S+1))};return a("div",{className:"dm-container",children:[a("div",{className:"dm-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{t&&t.cb?(t.cb(),C(null)):M("dmList")}}),a("div",{className:"profile",onClick:o=>{o.stopPropagation(),C({cb:()=>{I(m),M("dm")}}),n.fetchAndSetProfile(m.username)},children:[e("div",{className:"avatar",children:e("img",{src:n.getAvatar(m.avatar)})}),a("div",{className:"username",children:[m.name??m.username,m.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]})]}),e("div",{className:"dm-body-container",onScroll:L,children:e("div",{className:"dm-body",children:w.map((o,T)=>{var U;let S,d=T===0,G=o.sender===h.username?"self":"other",R=((U=w[T+1])==null?void 0:U.sender)===h.username?"self":"other";return w[T+1]?S=Math.abs(o.timestamp-w[T+1].timestamp)/36e5:R=void 0,a("div",{className:`message ${G}`,id:d?"last":"",children:[G=="other"?a("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${G!==R?"show":"hide"}`,onClick:x=>{x.stopPropagation(),C({cb:()=>{I(m),M("dm")}}),n.fetchAndSetProfile(m.username)},children:e("img",{src:n.getAvatar(m.avatar)})}),a("div",{className:"message-content",children:[o.content&&e("div",{className:"content",children:ie(o.content)}),o.attachments&&e("div",{className:"attatchments",children:o.attachments.map((x,_)=>q(x)?e("video",{src:x,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:W=>{H.FullscreenImage.set({display:!0,image:x})}},_):e(ve,{src:x,onClick:()=>{H.FullscreenImage.set({display:!0,image:x})}},_))})]})]}):a(B,{children:[o.content&&e("div",{className:"content",children:ie(o.content)}),o.attachments&&e("div",{className:"attatchments",children:o.attachments.map((x,_)=>q(x)?e("video",{src:x,controls:!1,loop:!0,muted:!0,autoPlay:!0,onClick:W=>{H.FullscreenImage.set({display:!0,image:x})}},_):e("img",{src:x,onClick:()=>{H.FullscreenImage.set({display:!0,image:x})}},_))})]}),w[T+1]&&S>6?e("div",{className:"date",children:Ne(o.timestamp,l.time.twelveHourClock)}):G!==R&&e("div",{className:"date",children:Ne(o.timestamp,l.time.twelveHourClock)})]},T)})})}),e("div",{className:"attachments",children:N.attachments.map((o,T)=>a("div",{className:"attachment",children:[q(o)?e("video",{src:o,muted:!0,controls:!1,loop:!0,autoPlay:!0}):e(ve,{src:o}),e(re,{onClick:()=>{b({...N,attachments:N.attachments.filter((S,d)=>d!==T)})}})]},T))}),a("div",{className:"dm-footer",children:[e(X,{type:"text",ref:v,onChange:o=>{b({...N,content:o.target.value})},onKeyDown:o=>{o.key==="Enter"&&y()},placeholder:i("APPS.INSTAGRAM.MESSAGE_PLACEHOLDER")}),N.content.length>0?e("span",{onClick:()=>y(),className:"send",children:i("APPS.INSTAGRAM.SEND")}):e(_e,{onClick:()=>{var o,T,S;N.attachments.length<3&&H.Gallery.set({includeVideos:!0,allowExternal:(S=(T=(o=ce)==null?void 0:o.value)==null?void 0:T.AllowExternal)==null?void 0:S.Instagram,onSelect:d=>b({...N,attachments:[...N.attachments,d.src]})})}})]})]})}function tt(){const{View:n,Func:P,Dm:E,Account:c,GoBack:f}=s.useContext($),[l,h]=n,[k]=c,[M,m]=E,[I,t]=f,[C,w]=s.useState(!1),[g,v]=s.useState(""),[N,b]=s.useState(""),[O,V]=s.useState([]);s.useState([]);const[F,r]=s.useState([]),[p,u]=s.useState(0),[y,L]=s.useState(!1),[o,T]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getRecentMessages",page:0}).then(d=>{d&&r(d)})},[]);const S=()=>{if(y||o)return;let d=document.querySelector("#last");if(!d)return;!Q(d)&&(T(!0),A("Instagram",{action:"getRecentMessages",page:p+1}).then(R=>{R&&R.length>0?(r([...F,...R]),T(!1)):L(!0)}),u(R=>R+1))};return s.useEffect(()=>{const d=setTimeout(()=>v(N),500);return()=>clearTimeout(d)},[N]),s.useEffect(()=>{g.length>0?C?A("Instagram",{action:"search",query:g}).then(d=>{d&&V(d)}):V(F.filter(d=>d.username.includes(g)||d.name.includes(g)&&d.username!==k.username)):V([])},[g]),s.useEffect(()=>{v(""),V([])},[C]),e("div",{className:"dm-list",children:C?a("div",{className:"slide up",children:[a("div",{className:"dm-list-header new",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{w(!1),V([])}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_MESSAGE")}),e("span",{})]}),a("div",{className:"dm-list-body ",children:[a("div",{className:"input",children:[e("span",{children:i("APPS.INSTAGRAM.TO")}),e(X,{type:"text",onChange:d=>b(d.target.value),placeholder:"Search"})]}),O.length>0&&e("div",{className:"items",children:O.map((d,G)=>a("div",{className:"item",onClick:()=>{w(!1),m(d),h("dm")},children:[e("div",{className:"avatar",onClick:R=>{R.stopPropagation(),t({cb:()=>{h("dmList"),t(null)}}),P.fetchAndSetProfile(d.username)},children:e("img",{src:P.getAvatar(d.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[d.username,d.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"last-message",children:d.name})]})]},G))})]})]}):a(B,{children:[a("div",{className:"dm-list-header",children:[a("div",{className:"top",children:[e("i",{className:"far fa-chevron-left",onClick:()=>h("feed")}),e("i",{className:"far fa-edit",onClick:()=>w(!0)})]}),e(he,{placeholder:i("SEARCH"),onChange:d=>b(d.target.value)})]}),e("div",{className:"dm-list-body",onScroll:S,children:e("div",{className:"items",children:g.length&&!C>0?O.map((d,G)=>{var R;return((R=d.content)==null?void 0:R.length)===0&&(d.content=i("APPS.INSTAGRAM.SENT_A_PHOTO")),a("div",{className:"item",onClick:()=>{w(!1),m(d),h("dm")},children:[e("div",{className:"avatar",onClick:U=>{U.stopPropagation(),t({cb:()=>{h("dmList"),t(null)}}),P.fetchAndSetProfile(d.username)},children:e("img",{src:P.getAvatar(d.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[d.name,d.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),a("div",{className:"last-message",children:[d.content.length>40?d.content.substring(0,40)+"...":d.content," • ",te(d.timestamp)]})]})]},G)}):F.map((d,G)=>{let R=G===F.length-1;return d.content.length===0&&(d.content=i("APPS.INSTAGRAM.SENT_A_PHOTO")),a("div",{className:"item",id:R?"last":"",onClick:()=>{w(!1),m(d),h("dm")},children:[e("div",{className:"avatar",onClick:U=>{U.stopPropagation(),t({cb:()=>{h("dmList"),t(null)}}),P.fetchAndSetProfile(d.username)},children:e("img",{src:P.getAvatar(d.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[d.name,d.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),d.content.length>40?d.content.substring(0,40)+"...":d.content," • ",te(d.timestamp)]})]},G)})})})]})})}function at(){var T,S,d,G;const{Account:n,View:P,Func:E,Stories:c,Story:f,Dm:l}=s.useContext($),[h]=n,[k,M]=P,[m,I]=c,[t,C]=f,[w,g]=l,[v,N]=s.useState(0),[b,O]=s.useState(""),[V,F]=s.useState(!1),[r,p]=s.useState({x:0,y:0});s.useEffect(()=>{if(t){p(t.origin);for(let R=0;R<t.media.length;R++)if(!t.media[R].seen)return N(R)}},[]);const u=R=>{if(V)return F(!1);const U=R.target.getBoundingClientRect(),x=R.clientX-U.left;let _=t.media[v];if(_.seen||A("Instagram",{action:"viewedStory",id:_.id}),x<U.width/2)if(v>0)N(v-1);else{let W=m.findIndex(ee=>ee.username===t.username),j=m[W-1];j&&E.fetchAndSetStory(j)}else if(v<t.media.length-1)N(v+1);else{let W=m.findIndex(ee=>ee.username===t.username),j=m[W+1];j?(L(t.username),E.fetchAndSetStory(j),N(0)):o()}},y=()=>{!b||b===""||A("Instagram",{action:"sendMessage",username:t.username,message:{content:b}}).then(R=>{R&&(g({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),M("dm"),o())})},L=R=>{t.media.length===v+1&&I(U=>U.map(x=>(x.username===R&&(x.seen=!0),x)))},o=R=>{R!==!1&&L(t.username),C(null)};return a(me.div,{className:"instagram-story",initial:{scale:0,transformOrigin:t!=null&&t.origin?`${((T=t==null?void 0:t.origin)==null?void 0:T.x)??0}px ${((S=t==null?void 0:t.origin)==null?void 0:S.y)??0}px`:"50% 50%"},animate:{scale:1,transformOrigin:t!=null&&t.origin?`${((d=t==null?void 0:t.origin)==null?void 0:d.x)??0}px ${((G=t==null?void 0:t.origin)==null?void 0:G.y)??0}px`:"50% 50%"},exit:{scale:0,transformOrigin:r?`${(r==null?void 0:r.x)??0}px ${(r==null?void 0:r.y)??0}px`:"50% 50%"},transition:{duration:.25,ease:"easeInOut"},children:[q(t==null?void 0:t.media[v].image)?e("video",{className:"background-image",onClick:u,autoPlay:!0,loop:!0,src:t==null?void 0:t.media[v].image}):e("div",{className:"background-image",onClick:u,style:{backgroundImage:`url(${t==null?void 0:t.media[v].image})`}}),e(de,{children:V&&e(st,{activeImage:v,close:()=>F(!1)})}),a("div",{className:"story-wrapper",children:[a("div",{className:"story-header",children:[e("div",{className:"story-steps",children:t==null?void 0:t.media.map((R,U)=>e("div",{className:v===U?"active":"",onClick:()=>N(U)},U))}),a("div",{className:"profile-details",children:[a("div",{className:"profile",onClick:()=>E.fetchAndSetProfile(t.username),children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${E.getAvatar(t==null?void 0:t.avatar)})`}}),a("div",{className:"name",children:[t==null?void 0:t.username,!1]}),e("div",{className:"time",children:te(t==null?void 0:t.media[v].timestamp)})]}),e("div",{className:"stats",children:e(re,{onClick:()=>{if(t!=null&&t.media[v].seen)return o();A("Instagram",{action:"viewedStory",id:t==null?void 0:t.media[v].id}).then(R=>o())}})})]})]}),(t==null?void 0:t.username)===h.username?a("div",{className:"story-footer","data-stats":!0,children:[a("div",{className:"seen-by",onClick:()=>F(!0),children:[(t==null?void 0:t.media[v].viewers)&&e("div",{className:"images",children:t==null?void 0:t.media[v].viewers.map((R,U)=>e("img",{src:E.getAvatar(R.avatar)},U))}),i("APPS.INSTAGRAM.SEEN_BY").format({count:xe(t==null?void 0:t.media[v].views)??0})]}),e(re,{onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.DELETE_STORY.TITLE"),description:i("APPS.INSTAGRAM.DELETE_STORY.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.DELETE_STORY.CANCEL")},{title:i("APPS.INSTAGRAM.DELETE_STORY.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"removeFromStory",id:t==null?void 0:t.media[v].id}).then(R=>{if(!R)return fe("error","Failed to remove image from story");fe("info","Removed image from story"),C(null),t.media.length===1&&I(U=>U.filter(x=>x.username!==t.username))})}}]})}})]}):a("div",{className:"story-footer",children:[e("div",{className:"input",children:e(X,{type:"text",placeholder:i("APPS.INSTAGRAM.SEND_A_MESSAGE"),onChange:R=>O(R.target.value),onKeyDown:R=>{R.key==="Enter"&&y()}})}),e(be,{onClick:()=>y()})]})]})]})}const st=n=>{var g;const{Func:P,Story:E}=s.useContext($),[c,f]=E,[l,h]=s.useState([]),[k,M]=s.useState(0),[m,I]=s.useState(!1),[t,C]=s.useState(!1);s.useEffect(()=>{(n==null?void 0:n.activeImage)!==void 0&&A("Instagram",{action:"getViewers",id:c==null?void 0:c.media[n.activeImage].id,page:0}).then(v=>{v&&(h(v),v.length<15&&I(!0))})},[]);const w=v=>{if(m||t)return;let N=document.querySelector("#last");if(!N)return;!Q(N)&&(C(!0),A("Instagram",{action:"getViewers",id:c==null?void 0:c.media[n.activeImage].id,page:k+1}).then(O=>{O&&O.length>0?(h(V=>[...V,...O]),C(!1),O.length<15&&I(!0)):I(!0)}),M(O=>O+1))};return a(me.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[a("div",{className:"story-modal-header",children:[a("div",{className:"views",children:[e(Pe,{})," ",e("div",{className:"views",children:((g=c==null?void 0:c.media[n==null?void 0:n.activeImage])==null?void 0:g.views)??0})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),a("div",{className:"story-modal-content",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",onScroll:w,children:l.map((v,N)=>{let b=N===l.length-1?"last":"";return e("div",{className:"item",id:b,children:a("div",{className:"user",onClick:()=>{P.fetchAndSetProfile(v.username),f(null)},children:[e("div",{className:"profile-picture",children:e("img",{src:P.getAvatar(v.avatar)})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[v.username,v.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:v.name})]})]})},N)})})]})]})};function nt(){var k;const{Func:n,View:P,Account:E}=s.useContext($),c=ae(se.Settings),[f,l]=P,[h]=E;return e("div",{className:"instagram-footer",children:a(B,{children:[e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("feed"),children:e("g",{children:f=="feed"?e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M22 23h-6.001a1 1 0 01-1-1v-5.455a2.997 2.997 0 10-5.993 0V22a1 1 0 01-1 1H2a1 1 0 01-1-1V11.543a1.002 1.002 0 01.31-.724l10-9.543a1.001 1.001 0 011.38 0l10 9.543a1.002 1.002 0 01.31.724V22a1 1 0 01-1 1z"}):e("path",{d:"M9.005 16.545a2.997 2.997 0 012.997-2.997h0A2.997 2.997 0 0115 16.545V22h7V11.543L12 2 2 11.543V22h7.005z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("search"),children:f=="search"?e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M13.173 13.164l1.491-3.829-3.83 1.49zM12.001.5a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012.001.5zm5.35 7.443l-2.478 6.369a1 1 0 01-.57.569l-6.36 2.47a1 1 0 01-1.294-1.294l2.48-6.369a1 1 0 01.57-.569l6.359-2.47a1 1 0 011.294 1.294z"}):a(B,{children:[e("polygon",{fill:"none",points:"13.941 13.953 7.581 16.424 10.06 10.056 16.42 7.585 13.941 13.953",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("polygon",{fillRule:"evenodd",points:"10.06 10.056 13.949 13.945 7.581 16.424 10.06 10.056"}),e("circle",{cx:"12.001",cy:"12.005",fill:"none",r:"10.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("newPost"),children:a(B,{children:[e("path",{d:"M2 12v3.45c0 2.849.698 4.005 1.606 4.944.94.909 2.098 1.608 4.946 1.608h6.896c2.848 0 4.006-.7 4.946-1.608C21.302 19.455 22 18.3 22 15.45V8.552c0-2.849-.698-4.006-1.606-4.945C19.454 2.7 18.296 2 15.448 2H8.552c-2.848 0-4.006.699-4.946 1.607C2.698 4.547 2 5.703 2 8.552z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"6.545",x2:"17.455",y1:"12.001",y2:"12.001"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"12.003",x2:"12.003",y1:"6.545",y2:"17.455"})]})}),f==="notifications"?e("svg",{fill:"#262626",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{color:((k=c==null?void 0:c.display)==null?void 0:k.theme)==="dark"?"#ffffff":"#262626",fill:c.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("notifications"),children:e("path",{color:c.display.theme=="dark"&&"#fafafa",d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})}),e("img",{src:n.getAvatar(h.avatar),className:"profile",alt:"profile",onClick:()=>n.fetchAndSetProfile(h.username)})]})})}function it(){const{Account:n,UserPanel:P,GoBack:E}=s.useContext($),[c,f]=P,[l,h]=s.useState([]),[k,M]=s.useState(0),[m,I]=s.useState(!1),[t,C]=s.useState(!1);let w={Following:"getFollowing",Followers:"getFollowers","Liked by":"getLikes"};s.useEffect(()=>{A("Instagram",{action:w[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:0}}).then(v=>{v&&h(v)})},[]);const g=()=>{if(m||t)return;!Q(document.querySelector("#last"))&&(C(!0),A("Instagram",{action:w[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:k+1}}).then(N=>{N&&N.length>0?(h([...l,...N]),C(!1)):I(!0)}),M(N=>N+1))};return e(B,{children:c.data&&l&&a("div",{className:"userpanel-container",children:[a("div",{className:"userpanel-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{var v;(v=c.data)==null||v.cb()}}),e("div",{className:"userpanel-title",children:c.data.title}),e("span",{})]}),e("div",{className:"userpanel-body",onScroll:g,children:e("div",{className:"items",children:l.map((v,N)=>{let b=N===l.length-1;return e(rt,{data:v,allData:c.data,last:b},N)})})})]})})}const rt=n=>{const{Func:P,Account:E,GoBack:c,UserPanel:f}=s.useContext($),[l]=E,[h,k]=c,[M,m]=f;let I=n.data,t=n.last;const[C,w]=s.useState(I.isFollowing===1);return a("div",{className:"item",id:t?"last":"",onClick:()=>{k({cb:()=>{m({display:!0,data:n.allData})}}),P.fetchAndSetProfile(I.username)},children:[a("div",{className:"user",children:[e("div",{className:"profile-picture",children:e("img",{src:P.getAvatar(I.avatar),alt:"profile"})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[I.username,I.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:I.name})]})]}),l.username!==I.username&&e("div",{className:"action",onClick:g=>{g.stopPropagation(),I.username!==l.username&&(C?H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:I.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:I.username,following:!C}}).then(()=>{w(v=>!v)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:I.username,following:!C}}).then(()=>{w(v=>!v)}))},children:C?e("div",{className:"button following",children:i("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",children:i("APPS.INSTAGRAM.FOLLOW")})})]})},$=s.createContext(null);function ht(){const{Func:n}=s.useContext(Fe),P=ae(se.Settings),[E,c]=n.TextColor,[f,l]=s.useState("feed"),[h,k]=s.useState(null),[M,m]=s.useState(!1),[I,t]=s.useState([]),[C,w]=s.useState(null),[g,v]=s.useState(null),[N,b]=s.useState(null),[O,V]=s.useState(null),[F,r]=s.useState(null),[p,u]=s.useState(null),[y,L]=s.useState({display:!1,data:null}),[o,T]=s.useState(!0);s.useEffect(()=>{A("isAdmin").then(_=>{if(J.APPS.INSTAGRAM.account.value){k({...J.APPS.INSTAGRAM.account.value,isAdmin:_}),m(!0),T(!1);return}else if(J.APPS.INSTAGRAM.account.value===!1)return T(!1);A("Instagram",{action:"isLoggedIn"}).then(W=>{W?(J.APPS.INSTAGRAM.account.set(W),k({...W,isAdmin:_}),m(!0),T(!1)):(J.APPS.INSTAGRAM.account.set(!1),T(!1))})})},[]),s.useEffect(()=>{setTimeout(()=>{f==="live"||f==="newPost"||f==="story"?(c("#fafafaed"),f=="live"&&H.IndicatorVisible.set(!1)):(c(P.display.theme==="dark"?"#fafafaed":"#000000"),H.IndicatorVisible.set(!0)),f==="dm"?ne.ReceiveAppNotifications.set(!1):ne.ReceiveAppNotifications.set(!0)},250)},[f]);const S=(_,W)=>{_&&A("Instagram",{action:"getPost",id:_}).then(j=>{if(j){if(W)return G(j);r(j),l("post")}})},d=_=>{_&&A("Instagram",{action:"getProfile",username:_}).then(W=>{W&&(v(W),l("profile"))})},G=_=>{_.id&&A("Instagram",{action:"getComments",postId:_.id,page:0}).then(W=>{W&&(V({post:_,comments:W}),l("comments"))})},R=(_,W,j)=>{!_&&!(_!=null&&_.username)||((W==null?void 0:W.length)==0&&(W=void 0),A("Instagram",{action:"getStory",username:_.username}).then(ee=>{ee&&w({username:_.username,avatar:_.avatar,verified:_.verified,media:ee,queue:W,origin:j})}))},U=_=>_||"./assets/img/icons/instagram/unknown-pfp.jpg",x={feed:e(Be,{}),search:e(Xe,{}),notifications:e(je,{}),profile:e(ze,{}),live:e($e,{}),logIn:e(Se,{}),comments:e(qe,{}),post:e(Ze,{}),newPost:e(Je,{}),userpanel:e(it,{}),dmList:e(tt,{}),dm:e(et,{})};return s.useEffect(()=>{y.display&&l("userpanel")},[y]),e("div",{className:"instagram-container",children:e($.Provider,{value:{View:[f,l],Account:[h,k],Profile:[g,v],Post:[F,r],Comments:[O,V],LoggedIn:[M,m],GoBack:[p,u],UserPanel:[y,L],Dm:[N,b],Stories:[I,t],Story:[C,w],Func:{fetchAndSetProfile:d,fetchAndSetStory:R,fetchAndSetComments:G,fetchAndSetPost:S,getAvatar:U}},children:o||P.airplaneMode?e("div",{className:"loading",children:e(We,{size:55,speed:.9,color:E})}):e("div",{className:"instagram-wrapper",children:M?a(B,{children:[e(de,{children:C&&e(at,{})}),x[f],f!=="live"&&f!=="logIn"&&f!=="newPost"&&f!=="comments"&&!C&&e(nt,{})]}):e(Se,{})})})})}export{$ as InstagramContext,ht as default};
