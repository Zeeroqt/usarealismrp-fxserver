import{r as u,j as t,a as i}from"./jsx-runtime-55b9ff2c.js";import{q as N,f as E,L as o,v as C,D as h,a4 as A,h as L,a8 as g,au as D,C as I,ab as w,r as P}from"./Phone-aba84f0c.js";import"./number-28525126.js";function _(){const[l,v]=u.useState(""),[r,m]=u.useState([]),[s,c]=u.useState(null);u.useEffect(()=>{if(N.APPS.NOTES.notes.value)return m(N.APPS.NOTES.notes.value);E("Notes",{action:"fetch"}).then(e=>{m(e),N.APPS.NOTES.notes.set(e)})},[]);const f=e=>{let n=Math.floor(Date.now()),a={title:o("APPS.NOTES.NEW_NOTE"),content:"",timestamp:n,id:null};E("Notes",{action:"create",data:a}).then(d=>{a.id=d,c(a),m([...r,a]),N.APPS.NOTES.notes.set({...r,tempData:a})})},T=e=>{let n=Math.floor(Date.now()),a=[...r],d=a.findIndex(O=>O.id===e),S=a[d];S={id:s.id,title:s.title,content:s.content,timestamp:n},a[d]=S,E("Notes",{action:"save",data:S}),c(null),m(a),N.APPS.NOTES.notes.set(a)},p=e=>{E("Notes",{action:"remove",id:e}).then(n=>{if(!n)return P("warning","Failed to remove note, server returned false");let a=r.filter(d=>d.id!==e);c(null),m(a),N.APPS.NOTES.notes.set(a),P("info","Removed note")})};return t("div",{className:"notes-container slide-right",children:s?i("div",{className:"notes-wrapper slide-left",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>T(s.id),children:[t("i",{className:"fal fa-chevron-left"}),o("APPS.NOTES.TITLE")]}),t(L,{className:"title",defaultValue:s.title,onChange:e=>{c({...s,title:e.target.value})}}),t("div",{})]}),t(g,{onChange:e=>{c({...s,content:e.target.value})},defaultValue:s.content}),i("div",{className:"notes-bottom",children:[t(D,{onClick:()=>I.PopUp.set({title:o("APPS.NOTES.DELETE_TITLE").format({title:s.title}),description:o("APPS.NOTES.DELETE_TEXT").format({title:s.title}),buttons:[{title:o("APPS.NOTES.BUTTON_CANCEL")},{title:o("APPS.NOTES.BUTTON_DELETE"),color:"red",cb:()=>{p(s.id)}}]})}),t("div",{className:"amount",children:o("APPS.NOTES.LAST_EDITED").format({date:h(s.timestamp)})}),t(w,{onClick:()=>T(s.id)})]})]}):i("div",{className:"notes-wrapper slide-right",children:[t("div",{className:"title",children:o("APPS.NOTES.TITLE")}),t(C,{placeholder:o("APPS.NOTES.SEARCH_PLACEHOLDER"),onChange:e=>v(e.target.value)}),t("div",{className:"notes-body",children:t("div",{className:"notes-list",children:r.filter(e=>{var n,a;return((n=e.title)==null?void 0:n.toLowerCase().includes(l==null?void 0:l.toLowerCase()))||((a=e.content)==null?void 0:a.toLowerCase().includes(l==null?void 0:l.toLowerCase()))}).sort((e,n)=>n.timestamp-e.timestamp).map((e,n)=>i("div",{className:"note-item",onClick:()=>{c(e)},children:[t("div",{className:"note-title",children:e.title}),i("div",{className:"note-details",children:[t("div",{className:"date",children:h(e.timestamp)}),t("div",{className:"content",children:e.content.length>30?e.content.slice(0,30)+"...":e.content})]})]},n))})}),i("div",{className:"notes-bottom",children:[t("div",{}),t("div",{className:"amount",children:o("APPS.NOTES.FOOTER").format({amount:r.length})}),t(A,{onClick:f})]})]})})}export{_ as default};
