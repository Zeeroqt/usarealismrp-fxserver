import{j as e,F as W,r as a,a as s}from"./jsx-runtime-7cf68bf7.js";import{b as te,a as ae,u as q,i as K,f as A,aT as Le,C as H,L as r,au as ie,al as Re,o as Me,c as ce,bD as Pe,w as Z,aV as Oe,$ as de,S as ne,bh as ye,A as me,x as X,m as ue,bA as pe,Q as re,j as Q,aB as se,aE as Ie,bE as Ge,d as he,a7 as ge,a5 as Ce,bF as Ve,aw as Se,E as Ne,aQ as be,bG as _e}from"./PhoneProvider-fb5cb781.js";import{S as Fe}from"./Phone-d1a23bb8.js";import{r as De}from"./number-28525126.js";import{C as Ue}from"./Check-37e2af20.js";import{formatNumber as xe}from"./Tiktok-0e4aa026.js";import{a as We}from"./DotSpinner-78700c87.js";import"./color-e1a4c391.js";import"./index.esm-3a7b91c6.js";import"./AppStore-52953299.js";import"./Pin-e697d693.js";import"./Switch-136965a2.js";import"./Slider-6915ca8b.js";function Ee(n){const S=te(ae.Settings);return e(W,{children:n.liked?e("svg",{onClick:n.onClick,color:"#ed4956",fill:"#ed4956",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{onClick:n.onClick,color:S.display.theme==="dark"?"#ffffff":"#262626",fill:S.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})})})}function we(n){const{Account:S,View:N,Func:c,UserPanel:f}=a.useContext(B),l=te(ae.Settings),[m]=S,[L,E]=N,[g,P]=f,[t,C]=a.useState(n.data),k=a.useRef(null);a.useRef(null);const[v,u]=a.useState(0),[T,_]=a.useState(!1),O={pos:{startLeft:0,startX:0},onMouseDown:p=>{O.pos={startLeft:k.current.scrollLeft,startX:p.clientX},k.current.style.userSelect="none",document.addEventListener("mouseup",O.onMouseUp),document.addEventListener("mousemove",O.onMove)},onMove:p=>{const R=(p.clientX-O.pos.startX)/Me(l.display.size);k.current.scrollLeft=O.pos.startLeft-R;const I=k.current.getBoundingClientRect();(I.left-5>p.clientX||p.clientX>I.right-5)&&O.onMouseUp()},onMouseUp:()=>{k.current.style.removeProperty("user-select"),document.removeEventListener("mouseup",O.onMouseUp),document.removeEventListener("mousemove",O.onMove);const p=JSON.parse(t.media),R=k.current.clientWidth;let I=v;const V=k.current.scrollLeft-O.pos.startLeft;V>R/2&&I<p.length-1?I++:V<-R/2&&I>0&&I--,b(I)}},b=p=>{k.current.scrollTo({left:p*k.current.offsetWidth,behavior:"smooth"}),u(p)};q("instagram:setLikes",p=>{p.postId!==t.id||p.isComment||C({...t,like_count:p.likes})});const F=p=>{if(p.detail===2){if(!t.id)return;t.liked||A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(R=>{C({...t,liked:R.liked,like_count:R.likes})}),_(!0),setTimeout(()=>{_(!1)},1e3)}};return s("div",{className:"post",id:n.last?"last":"","data-id":t.id,"data-active":n.active,children:[s("div",{className:"post-header",children:[e("img",{className:"profile-picture",onClick:()=>{c.fetchAndSetProfile(t.username)},src:c.getAvatar(t.avatar)}),s("div",{className:"name",onClick:()=>c.fetchAndSetProfile(t.username),children:[t.username,t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),s("div",{className:"post-body",children:[T&&e("div",{className:`popup-heart ${T?"show":"hide"}`,children:e("svg",{color:"#e3e3e3",fill:"#e3e3e3",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})})}),e("div",{className:"image-container",ref:k,onMouseDown:O.onMouseDown,children:JSON.parse(t.media).map((p,R)=>e("div",{className:"image",onClick:F,children:K(p)?e(Be,{attachment:p,active:n.active}):e("img",{src:p})},R))}),s("div",{className:"actions",children:[s("div",{className:"like-comment",children:[e(Ee,{liked:t.liked,onClick:()=>{t.id&&A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(p=>{C({...t,liked:p.liked,like_count:p.likes})})}}),e("svg",{onClick:()=>c.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp}),color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M20.656 17.008a9.993 9.993 0 10-3.59 3.615L22 22z",fill:"none",stroke:"currentColor",strokeWidth:"2px"})}),(t.username===m.username||m.isAdmin)&&e(Le,{onClick:()=>{H.PopUp.set({title:r("APPS.INSTAGRAM.DELETE_POST_POPUP.TITLE"),description:r("APPS.INSTAGRAM.DELETE_POST_POPUP.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.DELETE_POST_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.DELETE_POST_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"deletePost",id:t.id}).then(p=>{p&&E("feed")})}}]})}})]}),JSON.parse(t.media).length>1&&e("div",{className:"scroll-dots",children:JSON.parse(t.media).map((p,R)=>e("div",{className:`dot ${v==R?"active":""}`,onClick:()=>b(R)},R))})]}),s("div",{className:"liked-by",onClick:()=>{P({display:!0,data:{title:r("APPS.INSTAGRAM.LIKED_BY"),postId:t.id,cb:()=>{E("feed")}}})},children:[t.like_count," ",r("APPS.INSTAGRAM.LIKES")]}),s("div",{className:"caption",children:[e("span",{className:"user",onClick:p=>{p.stopPropagation(),c.fetchAndSetProfile(t.username)},children:t.username}),ie(t.caption)," "]}),e("div",{className:"comments",onClick:p=>{p.stopPropagation(),c.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp})},children:t.comment_count>0?r("APPS.INSTAGRAM.VIEW_ALL_COMMENTS").format({count:t.comment_count}):r("APPS.INSTAGRAM.FIRST_COMMENT")}),e("div",{className:"date",children:Re(t.timestamp)})]})]})}const Be=n=>{var l;const[S,N]=a.useState(n.active),c=te(ae.Settings),f=a.useRef(null);return a.useEffect(()=>{var m;N(n.active),!(!f.current||!((m=c==null?void 0:c.sound)!=null&&m.volume))&&n.active&&(f.current.volume=c.sound.volume,f.current.currentTime=0)},[n.active]),a.useEffect(()=>{var m;!f.current||!((m=c==null?void 0:c.sound)!=null&&m.volume)||n.active&&(f.current.volume=c.sound.volume)},[(l=c==null?void 0:c.sound)==null?void 0:l.volume]),e("video",{src:n.attachment,autoPlay:!0,loop:!0,muted:!n.active,ref:f,onLoadedMetadata:m=>{n.active&&(m.currentTarget.volume=c.sound.volume)}})};function $e(){const{Account:n,View:S,Func:N,Stories:c}=a.useContext(B),[f,l]=S,[m]=n,[L,E]=a.useState([]),[g,P]=a.useState([]),[t,C]=c,[k,v]=a.useState(0),[u,T]=a.useState(!1),[_,O]=a.useState(!1),[b,F]=a.useState(null);a.useEffect(()=>{A("Instagram",{action:"getPosts",filters:{following:!0},page:0}).then(i=>{i&&E(i)})},[]),a.useEffect(()=>{f==="feed"&&(A("Instagram",{action:"getLives"}).then(i=>{i&&P(i)}),A("Instagram",{action:"getStories"}).then(i=>{i&&C([...i.sort((d,w)=>{if(d.seen===w.seen)return 0;if(d.seen===1)return 1;if(w.seen===1)return-1})])}))},[f]);const p=new IntersectionObserver(R,{rootMargin:"20px",threshold:.5});function R(i){i.forEach(d=>{if(d.isIntersecting){let h=d.target.getAttribute("data-id");F(h)}})}const I=()=>{if(u||_)return;let i=document.querySelector("#last");if(!i)return;document.querySelectorAll(".post").forEach(h=>p.observe(h)),!Z(i)&&(O(!0),A("Instagram",{action:"getPosts",filters:{following:!0},page:k+1}).then(h=>{h&&h.length>0?(E([...L,...h]),O(!1)):T(!0)}),v(h=>h+1))};a.useEffect(()=>{const i=document.querySelector(".stories");i.addEventListener("wheel",d=>{d.preventDefault(),i.scrollLeft+=d.deltaY})},[]),q("instagram:updateLives",i=>{i&&P(i)});const V=()=>{H.PopUp.set({title:r("APPS.INSTAGRAM.GO_LIVE_POPUP.TITLE"),description:r("APPS.INSTAGRAM.GO_LIVE_POPUP.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.GO_LIVE_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.GO_LIVE_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"goLive",user:{username:m.username,avatar:N.getAvatar(m==null?void 0:m.avatar),verified:m.verified}}),l("live")}}]})};return s(W,{children:[s("div",{className:"instagram-header feed-header",children:[s("div",{className:"name",children:[m.username,m.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),s("svg",{onClick:()=>l("dmList"),color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[e("line",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2",x1:"22",x2:"9.218",y1:"3",y2:"10.083"}),e("polygon",{fill:"none",points:"11.698 20.334 22 3.001 2 3.001 9.218 10.084 11.698 20.334",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})]})]}),s("div",{className:"feed",onScroll:I,children:[e("div",{className:"stories-wrapper",children:s("div",{className:"stories",children:[s("div",{className:"story self",onClick:()=>{H.ContextMenu.set({buttons:[{title:r("APPS.INSTAGRAM.GO_LIVE"),cb:()=>{V()}},{title:r("APPS.INSTAGRAM.CREATE_STORY"),cb:()=>{var i,d,w;H.Gallery.set({includeVideos:!0,allowExternal:(w=(d=(i=ce)==null?void 0:i.value)==null?void 0:d.AllowExternal)==null?void 0:w.Instagram,onSelect:h=>{A("Instagram",{action:"addToStory",media:h.src}).then(o=>{o&&C([{username:m.username,avatar:m.avatar,verified:m.verified,seen:0,id:o},...t.filter(y=>y.username!==m.username)])})}})}}]})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${N.getAvatar(m==null?void 0:m.avatar)})`},children:e("div",{className:"plus",children:e("i",{className:"far fa-plus"})})}),e("div",{className:"name",children:r("APPS.INSTAGRAM.YOUR_STORY")})]}),Object.keys(g).map((i,d)=>{var w;return s("div",{className:"story",onClick:()=>{A("Instagram",{action:"viewLive",username:i}),l("live")},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${N.getAvatar((w=g[i])==null?void 0:w.avatar)})`},children:e("img",{className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"})}),e("div",{className:"name",children:i})]},d)}),t.map((i,d)=>s("div",{className:"story",onClick:w=>{let[h,o]=Pe(w);N.fetchAndSetStory(i,null,{x:h,y:o})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${N.getAvatar(i==null?void 0:i.avatar)})`},children:e("img",{className:"circle","data-seen":i.seen===1,src:"./assets/img/icons/instagram/StoryCircle.png"})}),e("div",{className:"name",children:i.username})]},d))]})}),L.length===0&&e("div",{className:"no-posts",children:r("APPS.INSTAGRAM.EMPTY_FEED")}),L.map((i,d)=>{let w=d===L.length-1;return e(we,{data:i,active:b===i.id,last:w},d)})]})]})}function He(){const{View:n,Account:S,Func:N}=a.useContext(B),[c,f]=n,[l]=S,m=te(ce),[L,E]=a.useState(""),[g,P]=a.useState(!1),[t,C]=a.useState(!1),k=a.useRef(null),[v,u]=a.useState({id:null,user:{username:"",avatar:"",verified:!1},viewers:0}),T=a.useRef(null),_=a.useRef(null),O=a.useRef(null),[b,F]=a.useState([]),[p,R]=a.useState([]),[I,V]=a.useState(null);a.useEffect(()=>{_.current.scrollTop=_.current.scrollHeight},[p]),a.useEffect(()=>{if(!I||O.current)return;let h=new Oe(I);O.current=h,h.resizeByAspect(3/4);const o=window.innerWidth;o>1280&&h.setQuality(1280/o)},[I]),a.useEffect(()=>()=>{O.current&&O.current.destroy()},[]),a.useEffect(()=>{const h=v;if(!(h!=null&&h.id)||!T.current||g)return;const o=m.ice?new de({config:{iceTransportPolicy:"relay",iceServers:m.ice}}):new de;o.on("open",()=>{const y=document.createElement("canvas");y.width=5,y.height=5;const M=y.captureStream(0),G=o.call(h.id,M);F([...b,G]),G.on("close",()=>{y.remove()}),G.on("error",()=>{y.remove()}),G.on("stream",$=>{const Y=T.current;Y.onloadeddata=()=>{Y.play()},Y.srcObject=$,A("Instagram",{action:"addCall",id:G.connectionId,username:l.username})})})},[T.current,v.user]),a.useEffect(()=>{if(P(l.username===(v==null?void 0:v.user.username)),(v==null?void 0:v.user.username)!==l.username||!I)return;const h=m.ice?new de({config:{iceTransportPolicy:"relay",iceServers:m.ice}}):new de;h.on("open",y=>{A("Instagram",{action:"setLive",username:l.username,verified:l.verified,id:y})});const o=I.captureStream(24);h.on("call",y=>{y.answer(o),y.on("close",()=>{F(b.filter(M=>M.connectionId!==y.connectionId))}),F([...b,y])})},[v,I]);const i=()=>{H.PopUp.set({title:r("APPS.INSTAGRAM.END_LIVE_POPUP.TITLE"),description:r("APPS.INSTAGRAM.END_LIVE_POPUP.DESCRIPTION").format({action:(g?r("APPS.INSTAGRAM.END_LIVE_POPUP.END"):r("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE")).toLowerCase()}),buttons:[{title:r("APPS.INSTAGRAM.END_LIVE_POPUP.CANCEL")},{title:g?r("APPS.INSTAGRAM.END_LIVE_POPUP.END"):r("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE"),color:"red",cb:()=>{ne.ShouldClose.set(!0),w(!0)}}]})},d=()=>{A("Instagram",{action:"sendLiveMessage",data:{user:{username:l.username,avatar:l.avatar,verified:l.verified},live:v.user.username,content:L}}),E("")},w=(h,o)=>{if(g)A("Instagram",{action:"endLive",username:l.username}).then(()=>{f("feed")});else if(A("Instagram",{action:"stopViewing",username:v.user.username}),h)ne.ShouldClose.set(!0),u({...v,ended:!0});else{if(o===!1)return;f("feed")}b.forEach(y=>{y.close()}),F([])};return q("instagram:addMessage",h=>{h.live===v.user.username&&R([...p,h])}),q("instagram:updateViewers",h=>{h.username===(v==null?void 0:v.user.username)&&u({...v,viewers:h.viewers})}),q("instagram:setLive",h=>{u(h),ne.ShouldClose.set(!1)}),q("instagram:liveEnded",h=>{h===(v==null?void 0:v.user.username)&&w(!0)}),q("instagram:stopLive",()=>{f("feed")}),q("instagram:endCall",h=>{b.forEach(o=>{o.connectionId===h&&o.close()}),F(b.filter(o=>o.connectionId!==h))}),s(W,{children:[e("div",{className:"instagram-stream",children:g?e("canvas",{ref:h=>V(h)}):e("video",{ref:T})}),v.ended&&s("div",{className:"instagram-stream-ended",children:[e(ye,{onClick:()=>f("feed")}),e("div",{className:"title",children:r("APPS.INSTAGRAM.LIVE_ENDED")})]}),e(me,{children:t&&e(je,{username:v.user.username,owner:g,endLive:w,close:()=>C(!1)})}),s("div",{className:"instagram-live",children:[s("div",{className:"live-header",children:[s("div",{className:"profile",onClick:()=>{g||(w(),N.fetchAndSetProfile(v.user.username))},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${v.user.avatar?v.user.avatar:"./assets/img/icons/instagram/unknown-pfp.jpg"})`}}),s("div",{className:"name",children:[v.user.username.length>12?v.user.username.substring(0,12)+"...":v.user.username,v.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),s("div",{className:"stats",children:[e("div",{className:"live",children:r("APPS.INSTAGRAM.LIVE")}),s("div",{className:"viewers",onClick:()=>C(!0),children:[e("i",{className:"fas fa-eye"}),v.viewers]}),e("i",{className:"far fa-times x",onClick:()=>{g?i():w(!1)}})]})]}),s("div",{className:"comment-section",children:[e("div",{className:"comment-feed",ref:_,children:p.map((h,o)=>{let y=h.user.avatar??"./assets/img/icons/instagram/unknown-pfp.jpg";return s("div",{className:"comment",children:[e("img",{src:y}),s("div",{className:"info",children:[s("div",{className:"name",children:[h.user.username,h.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"comment-text",children:h.content})]})]},o)})}),s("div",{className:"comment-input",children:[e(X,{type:"text",ref:k,placeholder:r("APPS.INSTAGRAM.COMMENT_PLACEHOLDER"),onChange:h=>E(h.target.value),onKeyDown:h=>{h.key==="Enter"&&L.replace(/ /g,"").length>0&&(d(),k.current.value="")}}),e("i",{className:"far fa-paper-plane",onClick:()=>{L.replace(/ /g,"").length>0&&(d(),k.current.value="")}}),g&&e("i",{className:"fas fa-repeat",onClick:()=>{A("Instagram",{action:"flipCamera"})}})]})]})]})]})}const je=n=>{const{Func:S}=a.useContext(B),[N,c]=a.useState([]);return a.useEffect(()=>{A("Instagram",{action:"getLiveViewers",username:n.username}).then(f=>{f&&c(f)})},[]),s(ue.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[s("div",{className:"story-modal-header",children:[s("div",{className:"views",children:[e(pe,{})," ",e("div",{className:"views",children:N.length})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),s("div",{className:"story-modal-content",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",children:N.map((f,l)=>{let m=l===N.length-1?"last":"";return e("div",{className:"item",id:m,children:s("div",{className:"user",onClick:()=>{n.owner||(n.endLive(!1,!1),S.fetchAndSetProfile(f.username))},children:[e("div",{className:"profile-picture",children:e("img",{src:S.getAvatar(f.avatar)})}),s("div",{className:"user-details",children:[s("div",{className:"username",children:[f.username,f.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:f.name})]})]})},l)})})]})]})};function Ae(){const{View:n,Account:S,LoggedIn:N}=a.useContext(B),c=te(ae.Settings),[f,l]=a.useState(""),[m,L]=a.useState(""),[E,g]=a.useState(""),[P,t]=a.useState(!1),[C,k]=a.useState(!1),[v,u]=a.useState(!1),[T,_]=n,[O,b]=S,[F,p]=N,[R,I]=a.useState("login"),V=()=>{t(!1),k(!1),A("Instagram",{action:"logIn",username:m,password:E}).then(d=>{d.success&&d.account?(k(!1),t(!1),A("isAdmin").then(w=>{Q.APPS.INSTAGRAM.account.set(d.account),b({...d.account,isAdmin:w}),_("feed"),p(!0)})):d.error=="no account"?t(!0):d.error=="wrong password"?k(!0):console.log("Unknown error, please contact support with: Instagram LogIn.jsx onLogIn:43 [ALREADY LOGGED IN]",d==null?void 0:d.error)})},i=()=>{let d=m.toLowerCase().replace(/\s/g,"");d.length<3||d.length>15||A("Instagram",{action:"createAccount",name:f,username:d,password:E}).then(w=>{w.success?(k(!1),t(!1),A("isAdmin").then(h=>{let o={name:f,username:d,posts:0,followers:0,following:0};Q.APPS.INSTAGRAM.account.set(o),b({...o,isAdmin:h}),_("feed"),p(!0)})):console.log("couldn't create account",w)})};return a.useEffect(()=>{k(!1),t(!1)},[R]),e("div",{className:"log-in",children:s(W,{children:[e("div",{className:"wrapper",children:R==="login"?s(W,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":c.display.theme}),s("div",{className:"form",children:[e(X,{placeholder:r("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:d=>L(d.target.value.replace(/\s/g,"")),maxLength:15}),P&&e("div",{className:"instagram-wrong",children:r("APPS.INSTAGRAM.NO_ACCOUNT")}),e(X,{placeholder:r("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:d=>g(d.target.value),maxLength:50}),C&&e("div",{className:"instagram-wrong",children:r("APPS.INSTAGRAM.WRONG_USERNAME_OR_PASSWORD")}),e("div",{className:"button",onClick:V,children:r("APPS.INSTAGRAM.LOG_IN")})]})]}):s(W,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":c.display.theme}),s("div",{className:"form",children:[e(X,{placeholder:r("APPS.INSTAGRAM.NAME_PLACEHOLDER"),type:"text",onChange:d=>l(d.target.value),maxLength:20}),e(X,{placeholder:r("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:d=>L(d.target.value.replace(/\s/g,"")),maxLength:15}),v&&e("div",{className:"instagram-wrong",children:r("APPS.INSTAGRAM.ACCOUNT_WITH_USERNAME")}),e(X,{placeholder:r("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:d=>g(d.target.value),maxLength:50}),e("div",{className:"button",onClick:i,children:r("APPS.INSTAGRAM.CREATE_ACCOUNT")})]})]})}),e("div",{className:"footer",children:R==="login"?s(W,{children:[r("APPS.INSTAGRAM.NOT_HAVE_ACCOUNT")," ",e("span",{onClick:()=>I("createAccount"),children:r("APPS.INSTAGRAM.CREATE_ACCOUNT")})]}):s(W,{children:[r("APPS.INSTAGRAM.HAVE_ACCOUNT")," ",e("span",{onClick:()=>I("login"),children:r("APPS.INSTAGRAM.LOG_IN")})]})})]})})}function Ye(){const[n,S]=a.useState([]),[N,c]=a.useState(0),[f,l]=a.useState(!1),[m,L]=a.useState(!1);a.useEffect(()=>{A("Instagram",{action:"getNotifications"}).then(g=>{g&&S(g)})},[]);const E=()=>{if(f||m)return;let g=document.querySelector("#last");if(!g)return;!Z(g)&&(L(!0),A("Instagram",{action:"getNotifications",page:N+1}).then(t=>{t&&t.length>0?(S([...n,...t]),L(!1)):l(!0)}),c(t=>t+1))};return s("div",{className:"notifications-container",children:[e("div",{className:"notifications-header",children:r("APPS.INSTAGRAM.ACTIVITY")}),e("div",{className:"notifications-body",onScroll:E,children:n.map((g,P)=>{let t=P===n.length-1?"last":"";return e(ze,{notification:g,last:t},P)})})]})}const ze=({notification:n,last:S})=>{const{Account:N,Func:c}=a.useContext(B),[f]=N,[l,m]=a.useState(n.isFollowing);switch(n.type){case"like_photo":return s("div",{className:"notification-item",id:S,onClick:()=>c.fetchAndSetPost(n.postId),children:[s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:E=>{E.stopPropagation(),c.fetchAndSetProfile(n.username)}}),s("div",{className:"content",children:[e("span",{children:n.username})," ",r("APPS.INSTAGRAM.LIKED_PHOTO"),e("span",{className:"date",children:se(n.timestamp)})]})]}),K(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"like_comment":return e("div",{className:"notification-item",id:S,onClick:()=>c.fetchAndSetPost(n.postId,!0),children:s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:E=>{E.stopPropagation(),c.fetchAndSetProfile(n.username)}}),s("div",{className:"content",children:[e("span",{children:n.username})," ",r("APPS.INSTAGRAM.LIKED_COMMENT").format({comment:n.comment}),e("span",{className:"date",children:se(n.timestamp)})]})]})});case"comment":return s("div",{className:"notification-item",id:S,onClick:()=>c.fetchAndSetPost(n.postId,!0),children:[s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:E=>{E.stopPropagation(),c.fetchAndSetProfile(n.username)}}),s("div",{className:"content",children:[e("span",{children:n.username})," ",r("APPS.INSTAGRAM.COMMENTED").format({comment:n.comment}),e("span",{className:"date",children:se(n.timestamp)})]})]}),K(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"follow":return s("div",{className:"notification-item",id:S,onClick:()=>c.fetchAndSetProfile(n.username),children:[s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(n.avatar),onClick:()=>c.fetchAndSetProfile(n.username)}),s("div",{className:"content",children:[e("span",{children:n.username})," ",r("APPS.INSTAGRAM.FOLLOWED"),e("span",{className:"date",children:se(n.timestamp)})]})]}),e("div",{className:`button ${l?"following":"follow"}`,onClick:E=>{E.stopPropagation(),f.username!==n.username&&(l?H.PopUp.set({title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:n.username}),buttons:[{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:n.username,following:!l}}).then(()=>{m(g=>!g)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:n.username,following:!l}}).then(()=>{m(g=>!g)}))},children:l?r("APPS.INSTAGRAM.FOLLOWING"):r("APPS.INSTAGRAM.FOLLOW")})]})}};function qe(){const{View:n,Profile:S,Account:N,Func:c,GoBack:f,Post:l,UserPanel:m,LoggedIn:L,Dm:E}=a.useContext(B),[g,P]=n,[t,C]=S,[k,v]=L,[u,T]=N,[_,O]=l,[b,F]=E,[p,R]=m,[I,V]=f,[i,d]=a.useState(!1),[w,h]=a.useState(!1),[o,y]=a.useState(null),[M,G]=a.useState(0),[$,Y]=a.useState(!1),[D,x]=a.useState(!1);a.useEffect(()=>{t.username&&(d(u.username===t.username),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:0}).then(U=>{U&&y(U)}))},[t]);const z=()=>{if($||D)return;let U=document.querySelector("#last");if(!U)return;!Z(U)&&(x(!0),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:M+1}).then(j=>{j&&j.length>0?(y([...o,...j]),x(!1)):Y(!0)}),G(j=>j+1))},le=()=>{t.name&&A("Instagram",{action:"updateProfile",data:{name:t.name,bio:t.bio,avatar:t.avatar}}).then(U=>{U&&h(!1)})};q("instagram:setFollowers",U=>{U.username===t.username&&C({...t,followers:U.followers})}),q("instagram:setFollowing",U=>{U.username===t.username&&C({...t,following:U.following})});const ve=a.useRef(!0);a.useEffect(()=>{if(ve.current){ve.current=!1;return}A("Instagram",{action:"toggleFollow",data:{username:t.username,following:t.isFollowing}})},[t.isFollowing]);const ke=()=>{A("AccountSwitcher",{action:"getAccounts",app:"Instagram"}).then(U=>{var ee;if(!U)return he("info","No accounts found");let J=u.isAdmin,j=(ee=U==null?void 0:U.filter(oe=>oe!==t.username))==null?void 0:ee.map(oe=>({title:oe,cb:()=>{A("AccountSwitcher",{action:"switch",app:"Instagram",account:oe}).then(lt=>{A("Instagram",{action:"isLoggedIn"}).then(fe=>{fe?(Q.APPS.INSTAGRAM.account.set(fe),T({...fe,isAdmin:J}),P("feed"),v(!0)):Q.APPS.INSTAGRAM.account.set(null)})})}}));H.ContextMenu.set({buttons:[{title:u.username},...j,{title:"Add Account",cb:()=>{v(!1)}}]})})};return e(W,{children:t&&s("div",{className:"profile",children:[e(me,{children:w&&s(ue.div,{className:"edit-profile",initial:{y:750,opacity:.75},animate:{y:0,opacity:1},exit:{y:750,opacity:.75},transition:{duration:.3,ease:"easeInOut"},children:[s("div",{className:"edit-profile-header",children:[e("div",{className:"cancel",onClick:()=>h(!1),children:r("CANCEL")}),e("div",{className:"title",children:r("APPS.INSTAGRAM.EDIT_PROFILE")}),e("div",{className:"save",onClick:()=>le(),children:r("APPS.INSTAGRAM.DONE")})]}),s("div",{className:"edit-profile-body",children:[s("div",{className:"profile-picture",onClick:()=>{var U,J,j;H.Gallery.set({allowExternal:(j=(J=(U=ce)==null?void 0:U.value)==null?void 0:J.AllowExternal)==null?void 0:j.Instagram,onSelect:ee=>{C({...t,avatar:ee.src}),T({...u,avatar:ee.src})}})},children:[e("img",{src:c.getAvatar(t.avatar),alt:"profile"}),e("span",{children:r("APPS.INSTAGRAM.CHANGE_PICTURE")})]}),s("div",{className:"profile-items",children:[s("div",{className:"item",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.NAME")}),e(X,{placeholder:r("APPS.INSTAGRAM.NAME_PLACEHOLDER"),onChange:U=>{C({...t,name:U.target.value})},maxLength:30,defaultValue:t.name})]}),s("div",{className:"item",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.BIO")}),e(Ie,{placeholder:r("APPS.INSTAGRAM.BIO"),onChange:U=>{C({...t,bio:U.target.value})},maxLength:100,defaultValue:t.bio??""})]})]}),e("div",{className:"sign-out",onClick:()=>{H.PopUp.set({title:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.TITLE"),description:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"signOut"}).then(U=>{v(null),T(null),Q.APPS.INSTAGRAM.account.set(null)})}}]})},children:"Sign Out"})]})]})}),i?e("div",{className:"instagram-header",children:s("div",{className:"name",style:{cursor:"pointer"},onClick:()=>ke(),children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})}),e(Ge,{})]})}):s("div",{className:"profile-header",children:[e("i",{className:"fas fa-chevron-left",onClick:()=>{I!=null&&I.cb?I.cb():P("feed")}}),s("div",{className:"name",children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("span",{})]}),s("div",{className:"profile-body",children:[s("div",{className:"profile-wrapper",children:[s("div",{className:"top",children:[s("div",{className:"profile-picture",style:{backgroundImage:`url(${c.getAvatar(t.avatar)})`},children:[t.isLive&&e("img",{onClick:()=>{A("Instagram",{action:"viewLive",username:t.username}),P("live")},className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"}),t.hasStory&&!t.isLive?e("img",{className:"circle","data-seen":t.seenStory===1,src:"./assets/img/icons/instagram/StoryCircle.png",onClick:U=>{let[J,j]=Pe(U);c.fetchAndSetStory({username:t.username,avatar:t.avatar,verified:t.verified},null,{x:J,y:j})}}):null]}),s("div",{className:"stats",children:[s("div",{children:[e("div",{className:"value",children:t.posts}),e("div",{className:"label",children:t.posts===1?r("APPS.INSTAGRAM.POST"):r("APPS.INSTAGRAM.POSTS")})]}),s("div",{onClick:()=>{R({display:!0,data:{title:r("APPS.INSTAGRAM.FOLLOWERS"),username:t.username,cb:()=>{C(t),P("profile"),R({display:!1})}}})},children:[e("div",{className:"value",children:t.followers}),e("div",{className:"label",children:t.followers===1?r("APPS.INSTAGRAM.FOLLOWER"):r("APPS.INSTAGRAM.FOLLOWERS")})]}),s("div",{onClick:()=>{R({display:!0,data:{title:r("APPS.INSTAGRAM.FOLLOWING"),username:t.username,cb:()=>{C(t),P("profile"),R({display:!1})}}})},children:[e("div",{className:"value",children:t.following}),e("div",{className:"label",children:r("APPS.INSTAGRAM.FOLLOWING")})]})]})]}),e("div",{className:"name",children:t.name}),e("div",{className:"description",children:ie(t.bio)??""}),e("div",{className:"buttons",children:i?i&&e("div",{className:"button edit",onClick:()=>{h(!0)},children:r("APPS.INSTAGRAM.EDIT_PROFILE")}):s(W,{children:[t.isFollowing?e("div",{className:"button following",onClick:()=>{H.PopUp.set({title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:t.username}),buttons:[{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{C({...t,isFollowing:!1})}}]})},children:r("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",onClick:()=>{C({...t,isFollowing:!0})},children:r("APPS.INSTAGRAM.FOLLOW")}),e("div",{className:"button following",onClick:()=>{F({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),P("dm")},children:r("APPS.INSTAGRAM.MESSAGE")})]})})]}),e("div",{className:"posts",onScroll:z,children:o&&o.map((U,J)=>{let j=J===o.length-1?"last":"",ee=JSON.parse(U.media)[0];return e("div",{id:j,onClick:()=>{V({cb:()=>{C(t),P("profile"),O(null),V(null)}}),O(U),P("post")},children:K(ee)?e("video",{src:ee,muted:!0,autoPlay:!0,loop:!0}):e("img",{src:ee})},J)})})]})]})})}function Xe(){const{Func:n,View:S,GoBack:N,Post:c}=a.useContext(B),[f,l]=S,[m,L]=N,[E,g]=c,[P,t]=a.useState(""),[C,k]=a.useState(""),[v,u]=a.useState([]);a.useState([]);const[T,_]=a.useState([]),[O,b]=a.useState(0),[F,p]=a.useState(!1),[R,I]=a.useState(!1);return a.useEffect(()=>{A("Instagram",{action:"getPosts",page:0}).then(i=>{i&&_(i)})},[]),a.useEffect(()=>{const i=setTimeout(()=>t(C),500);return()=>clearTimeout(i)},[C]),a.useEffect(()=>{P.length>0&&A("Instagram",{action:"search",query:P}).then(i=>{i&&u(i)})},[P]),s("div",{className:"search-container",children:[e("div",{className:"search-header",children:e(ge,{placeholder:"Search",onChange:i=>k(i.target.value)})}),e("div",{className:"search-body",onScroll:()=>{if(F||R||P.length>0)return;let i=document.querySelector("#last");if(!i)return;!Z(i)&&(I(!0),A("Instagram",{action:"getPosts",page:O+1}).then(w=>{w&&w.length>0?(_([...T,...w]),I(!1)):p(!0)}),b(w=>w+1))},children:P.length>0?e("div",{className:"search-results",children:v.map(i=>s("div",{className:"item",onClick:()=>{n.fetchAndSetProfile(i.username)},children:[e("div",{className:"profile-picture",children:e("img",{src:n.getAvatar(i.avatar),alt:"profile"})}),s("div",{className:"user",children:[s("div",{className:"username",children:[i.username,i.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:i.name})]})]}))}):e("div",{className:"feed-grid",children:T.map((i,d)=>{let h=Math.floor(d/3)%2==0,o=!1;o=d%3==(h?1:0),T[d+1]||(o=!1);let y=JSON.parse(i.media)[0],M=d==T.length-1?"last":"";return e("div",{id:M,className:`grid-post${o?" big":""}`,onClick:()=>{L({cb:()=>{l("search"),L(null)}}),g(i),l("post")},children:K(y)?e("video",{src:y,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:y,alt:"post"})},d)})})})]})}function Ke(){const{View:n,GoBack:S,Comments:N,Account:c,Func:f}=a.useContext(B),[l]=c,[m,L]=n,[E]=S,[g,P]=N,[t,C]=a.useState(""),k=a.useRef(null),[v,u]=a.useState(0),[T,_]=a.useState(!1),[O,b]=a.useState(!1),F=()=>{t.length!==0&&A("Instagram",{action:"postComment",data:{postId:g.post.id,comment:t}}).then(()=>{C(""),k.current.value="",P({...g,post:g.post,comments:[{user:{username:l.username,avatar:l.avatar,verified:l.verified},comment:{content:t,timestamp:new Date().getTime(),likes:0,liked:!1}},...g.comments]})})},p=()=>{if(T||O)return;let R=document.querySelector("#last");if(!R)return;!Z(R)&&(b(!0),A("Instagram",{action:"getComments",postId:g.post.id,page:v+1}).then(V=>{V&&V.length>0?(P({...g,comments:[...g.comments,...V]}),b(!1)):_(!0)}),u(V=>V+1))};return s("div",{className:"comments-container",children:[s("div",{className:"comments-header",children:[e(Ce,{onClick:()=>{E&&(E!=null&&E.cb)?E.cb():L("feed")}}),e("div",{className:"title",children:r("APPS.INSTAGRAM.COMMENTS")}),e("span",{})]}),s("div",{className:"comments-body",onScroll:p,children:[s("div",{className:"post-info",children:[e("div",{className:"profile-picture",children:e("img",{src:f.getAvatar(g.post.avatar),alt:"profile"})}),s("div",{className:"post-data",children:[s("div",{className:"caption",children:[s("span",{className:"username",children:[g.post.username,g.post.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),ie(g.post.caption)]}),e("div",{className:"actions",children:e("div",{className:"date",children:Te(g.post.timestamp)})})]})]}),g.comments.map((R,I)=>{let V=I===g.comments.length-1;return e(Je,{data:R,last:V},I)})]}),s("div",{className:"add-comment",children:[e("div",{className:"profile-picture",children:e("img",{src:f.getAvatar(l.avatar),alt:"profile"})}),s("div",{className:"input-container",children:[e(X,{type:"text",ref:k,placeholder:r("APPS.INSTAGRAM.ADD_COMMENT_AS").format({name:l.username}),onKeyPress:R=>{R.key==="Enter"&&F()},onChange:R=>C(R.target.value)}),e("div",{className:"send",onClick:F,children:r("APPS.INSTAGRAM.POST")})]})]})]})}const Je=({data:n,last:S})=>{const{Func:N}=a.useContext(B),[c,f]=a.useState(n.comment.liked),[l,m]=a.useState(n.comment.likes);return s("div",{className:"comment",id:S&&"last",children:[s("div",{className:"user",children:[e("div",{className:"profile-picture",onClick:()=>N.fetchAndSetProfile(n.user.username),children:e("img",{src:N.getAvatar(n.user.avatar),alt:"profile"})}),s("div",{className:"comment-data",children:[s("div",{className:"caption",children:[s("span",{className:"username",onClick:()=>N.fetchAndSetProfile(n.user.username),children:[n.user.username,n.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),n.comment.content]}),s("div",{className:"actions",children:[e("div",{className:"date",children:Te(n.comment.timestamp)}),s("div",{className:"likes",children:[l," ",r("APPS.INSTAGRAM.LIKES").toLowerCase()]})]})]})]}),e(Ee,{liked:c,onClick:()=>{n.comment.id&&A("Instagram",{action:"toggleLike",data:{postId:n.comment.id,toggle:!c,isComment:!0}}).then(L=>{L&&(f(L.liked),m(L.likes))})}})]})},Te=n=>{const S=new Date(n),c=new Date().getTime()-S.getTime(),f=Math.floor(c/(1e3*60*60*24)),l=Math.floor(c/(1e3*60*60)),m=Math.floor(c/(1e3*60));let L="";return f<1?l<1?L=`${m}m`:L=`${l}h`:f<30?L=`${f}d`:L=`${S.getDate()}/${S.getMonth()+1}/${S.getFullYear()}`,L};function Qe(){var F,p,R;const{View:n}=a.useContext(B),[S,N]=n,[c,f]=a.useState(0),[l,m]=a.useState([]),[L,E]=a.useState(""),[g,P]=a.useState([]),[t,C]=a.useState(""),[k,v]=a.useState(0),[u,T]=a.useState(!1),[_,O]=a.useState(!1);a.useEffect(()=>{A("Camera",{action:"getImages",page:0,filter:{showVideos:!0,showPhotos:!0}}).then(I=>{I&&P(I)})},[]);const b=I=>{if(_||u)return;let V=document.querySelector("#last");if(!V)return;!Z(V)&&(T(!0),A("Camera",{action:"getImages",page:k+1,filter:{showVideos:!0,showPhotos:!0}}).then(d=>{d&&d.length>0?(P([...g,...d]),T(!1)):O(!0)}),v(d=>d+1))};return a.useEffect(()=>{t&&t.includes("data:image")||Ve(t,I=>{if(I){const V=document.querySelector(".searchbox input");V&&(V.value=""),g.find(i=>i.src===t)||P(i=>[{src:t},...i])}})},[t]),s("div",{className:"newpost-container","data-camera":!1,children:[c===0&&s(W,{children:[s("div",{className:"newpost-header",children:[e("i",{className:"fal fa-times",onClick:()=>{N("feed")}}),e("div",{className:"title",children:r("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{l.length>0&&c==0&&f(1)},children:r("APPS.INSTAGRAM.NEXT")})]}),((R=(p=(F=ce)==null?void 0:F.value)==null?void 0:p.AllowExternal)==null?void 0:R.Instagram)&&e(ge,{placeholder:r("COMPONENTS.GALLERY.EXTERNAL_URL"),onChange:I=>C(I.target.value)}),e("div",{className:"newpost-body",onScroll:b,children:e("div",{className:"images",children:g.map((I,V)=>{let i=V===g.length-1?"last":"";return s("div",{id:i,className:"image",onClick:()=>{l.includes(I.src)?m(l.filter(w=>w!==I.src)):l.length<5&&m([...l,I.src])},children:[K(I.src)?e(Ze,{src:I.src}):e("img",{src:I.src,alt:"image"}),e("div",{className:"select",children:e(Ue,{checked:l.includes(I.src)})})]},V)})})})]}),c===1&&s(W,{children:[s("div",{className:"newpost-header",children:[e("i",{className:"fal fa-chevron-left",onClick:()=>{f(0)}}),e("div",{className:"title",children:r("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{A("Instagram",{action:"newPost",data:{caption:L,images:l}}).then(I=>{I&&N("feed")})},children:r("APPS.INSTAGRAM.POST")})]}),e("div",{className:"newpost-body",children:s("div",{className:"caption",children:[e("div",{className:"image",children:K(l[0])?e("video",{src:l[0],muted:!0}):e("img",{src:l[0],alt:"image"})}),e(Ie,{onChange:I=>{E(I.target.value)},placeholder:r("APPS.INSTAGRAM.CAPTION_PLACEHOLDER")})]})})]})]})}const Ze=({src:n})=>{const[S,N]=a.useState(null);return s(W,{children:[e("video",{src:n,crossOrigin:"anonymous",controls:!1,onMouseOver:f=>f.currentTarget.play(),onMouseOut:f=>f.currentTarget.pause(),onLoadedMetadata:f=>N(f.currentTarget.duration)}),S&&e("div",{className:"video-duration",children:(f=>{const l=Math.floor(f/60),m=De(f-l*60,0);return`${l}:${m<10?"0"+m:m}`})(S)})]})};function et(){const{View:n,Post:S,GoBack:N}=a.useContext(B),[c,f]=n,[l]=N,[m]=S;return e(W,{children:m&&e("div",{className:"viewpost-container",children:s(W,{children:[s("div",{className:"viewpost-header",children:[e(Ce,{onClick:()=>{l&&(l.cb?l.cb():f(l.view))}}),e("div",{className:"name",children:m.username??"Unknown"}),e("span",{})]}),e("div",{className:"profile-body",children:e(we,{data:m})})]})})})}function tt(){const{Func:n,Account:S,Dm:N,View:c,GoBack:f}=a.useContext(B);te(ae.Settings);const[l]=S,[m,L]=c,[E,g]=N,[P,t]=f,[C,k]=a.useState([]),v=a.useRef(null),[u,T]=a.useState({content:"",attachments:[]}),[_,O]=a.useState(0),[b,F]=a.useState(!1),[p,R]=a.useState(!1);a.useEffect(()=>{F(!1),R(!1),O(0),k([]),A("Instagram",{action:"getMessages",page:0,username:E.username}).then(i=>{i&&k(i.reverse())})},[]),q("instagram:newMessage",i=>{if(E.username!==i.sender)return;k([...C,i]);let d=document.querySelector(".dm-body-container");d.scrollTop=d.scrollHeight});const I=()=>{u.content.length===0&&u.attachments.length===0||A("Instagram",{action:"sendMessage",username:E.username,message:{content:u.content,attachments:u.attachments.length>0?u.attachments:null}}).then(i=>{if(!i)return;v.current.value="",k([...C,{sender:l.username,recipient:E.username,content:u.content,attachments:u.attachments,timestamp:Date.now()}]),T({content:"",attachments:[]});let d=document.querySelector(".dm-body-container");d.scrollTop=d.scrollHeight})},V=()=>{if(b||p)return;let i=document.querySelector("#last");if(!i)return;!Z(i)&&(R(!0),A("Instagram",{action:"getMessages",page:_+1,username:E.username}).then(w=>{w&&w.length>0?(k([...w.reverse(),...C]),R(!1)):F(!0)}),O(w=>w+1))};return s("div",{className:"dm-container",children:[s("div",{className:"dm-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{P&&P.cb?(P.cb(),t(null)):L("dmList")}}),s("div",{className:"profile",onClick:i=>{i.stopPropagation(),t({cb:()=>{g(E),L("dm")}}),n.fetchAndSetProfile(E.username)},children:[e("div",{className:"avatar",children:e("img",{src:n.getAvatar(E.avatar)})}),s("div",{className:"username",children:[E.name??E.username,E.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]})]}),e("div",{className:"dm-body-container",onScroll:V,children:e("div",{className:"dm-body",children:C.map((i,d)=>{var M;let w,h=d===0,o=i.sender===l.username?"self":"other",y=((M=C[d+1])==null?void 0:M.sender)===l.username?"self":"other";return C[d+1]?w=Math.abs(i.timestamp-C[d+1].timestamp)/36e5:y=void 0,s("div",{className:`message ${o}`,id:h?"last":"",children:[o=="other"?s("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${o!==y?"show":"hide"}`,onClick:G=>{G.stopPropagation(),t({cb:()=>{g(E),L("dm")}}),n.fetchAndSetProfile(E.username)},children:e("img",{src:n.getAvatar(E.avatar)})}),s("div",{className:"message-content",children:[i.content&&e("div",{className:"content",children:ie(i.content)}),i.attachments&&e("div",{className:"attatchments",children:i.attachments.map((G,$)=>K(G)?e("video",{src:G,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:Y=>{H.FullscreenImage.set({display:!0,image:G})}},$):e(Se,{src:G,onClick:()=>{H.FullscreenImage.set({display:!0,image:G})}},$))})]})]}):s(W,{children:[i.content&&e("div",{className:"content",children:ie(i.content)}),i.attachments&&e("div",{className:"attatchments",children:i.attachments.map((G,$)=>K(G)?e("video",{src:G,controls:!1,loop:!0,muted:!0,autoPlay:!0,onClick:Y=>{H.FullscreenImage.set({display:!0,image:G})}},$):e("img",{src:G,onClick:()=>{H.FullscreenImage.set({display:!0,image:G})}},$))})]}),C[d+1]&&w>6?e("div",{className:"date",children:Ne(i.timestamp)}):o!==y&&e("div",{className:"date",children:Ne(i.timestamp)})]},d)})})}),e("div",{className:"attachments",children:u.attachments.map((i,d)=>s("div",{className:"attachment",children:[K(i)?e("video",{src:i,muted:!0,controls:!1,loop:!0,autoPlay:!0}):e(Se,{src:i}),e(re,{onClick:()=>{T({...u,attachments:u.attachments.filter((w,h)=>h!==d)})}})]},d))}),s("div",{className:"dm-footer",children:[e(X,{type:"text",ref:v,onChange:i=>{T({...u,content:i.target.value})},onKeyDown:i=>{i.key==="Enter"&&I()},placeholder:r("APPS.INSTAGRAM.MESSAGE_PLACEHOLDER")}),u.content.length>0?e("span",{onClick:()=>I(),className:"send",children:r("APPS.INSTAGRAM.SEND")}):e(be,{onClick:()=>{var i,d,w;u.attachments.length<3&&H.Gallery.set({includeVideos:!0,allowExternal:(w=(d=(i=ce)==null?void 0:i.value)==null?void 0:d.AllowExternal)==null?void 0:w.Instagram,onSelect:h=>T({...u,attachments:[...u.attachments,h.src]})})}})]})]})}function at(){const{View:n,Func:S,Dm:N,Account:c,GoBack:f}=a.useContext(B),[l,m]=n,[L]=c,[E,g]=N,[P,t]=f,[C,k]=a.useState(!1),[v,u]=a.useState(""),[T,_]=a.useState(""),[O,b]=a.useState([]);a.useState([]);const[F,p]=a.useState([]),[R,I]=a.useState(0),[V,i]=a.useState(!1),[d,w]=a.useState(!1);a.useEffect(()=>{A("Instagram",{action:"getRecentMessages",page:0}).then(o=>{o&&p(o)})},[]);const h=()=>{if(V||d)return;let o=document.querySelector("#last");if(!o)return;!Z(o)&&(w(!0),A("Instagram",{action:"getRecentMessages",page:R+1}).then(M=>{M&&M.length>0?(p([...F,...M]),w(!1)):i(!0)}),I(M=>M+1))};return a.useEffect(()=>{const o=setTimeout(()=>u(T),500);return()=>clearTimeout(o)},[T]),a.useEffect(()=>{v.length>0?C?A("Instagram",{action:"search",query:v}).then(o=>{o&&b(o)}):b(F.filter(o=>{var y;return o.username.includes(v)||((y=o==null?void 0:o.name)==null?void 0:y.includes(v))&&o.username!==L.username})):b([])},[v]),a.useEffect(()=>{u(""),b([])},[C]),e("div",{className:"dm-list",children:C?s("div",{className:"slide up",children:[s("div",{className:"dm-list-header new",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{k(!1),b([])}}),e("div",{className:"title",children:r("APPS.INSTAGRAM.NEW_MESSAGE")}),e("span",{})]}),s("div",{className:"dm-list-body ",children:[s("div",{className:"input",children:[e("span",{children:r("APPS.INSTAGRAM.TO")}),e(X,{type:"text",onChange:o=>_(o.target.value),placeholder:"Search"})]}),O.length>0&&e("div",{className:"items",children:O.map((o,y)=>s("div",{className:"item",onClick:()=>{k(!1),g(o),m("dm")},children:[e("div",{className:"avatar",onClick:M=>{M.stopPropagation(),t({cb:()=>{m("dmList"),t(null)}}),S.fetchAndSetProfile(o.username)},children:e("img",{src:S.getAvatar(o.avatar)})}),s("div",{className:"info",children:[s("div",{className:"username",children:[o.username,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"last-message",children:o.name})]})]},y))})]})]}):s(W,{children:[s("div",{className:"dm-list-header",children:[s("div",{className:"top",children:[e("i",{className:"far fa-chevron-left",onClick:()=>m("feed")}),e("i",{className:"far fa-edit",onClick:()=>k(!0)})]}),e(ge,{placeholder:r("SEARCH"),onChange:o=>_(o.target.value)})]}),e("div",{className:"dm-list-body",onScroll:h,children:e("div",{className:"items",children:v.length>0&&!C?O.map((o,y)=>{var M;return((M=o.content)==null?void 0:M.length)===0&&(o.content=r("APPS.INSTAGRAM.SENT_A_PHOTO")),s("div",{className:"item",onClick:()=>{k(!1),g(o),m("dm")},children:[e("div",{className:"avatar",onClick:G=>{G.stopPropagation(),t({cb:()=>{m("dmList"),t(null)}}),S.fetchAndSetProfile(o.username)},children:e("img",{src:S.getAvatar(o.avatar)})}),s("div",{className:"info",children:[s("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),s("div",{className:"last-message",children:[o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",se(o.timestamp)]})]})]},y)}):F.map((o,y)=>{let M=y===F.length-1;return o.content.length===0&&(o.content=r("APPS.INSTAGRAM.SENT_A_PHOTO")),s("div",{className:"item",id:M?"last":"",onClick:()=>{k(!1),g(o),m("dm")},children:[e("div",{className:"avatar",onClick:G=>{G.stopPropagation(),t({cb:()=>{m("dmList"),t(null)}}),S.fetchAndSetProfile(o.username)},children:e("img",{src:S.getAvatar(o.avatar)})}),s("div",{className:"info",children:[s("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",se(o.timestamp)]})]},y)})})})]})})}function st(){var w,h,o,y;const{Account:n,View:S,Func:N,Stories:c,Story:f,Dm:l}=a.useContext(B),[m]=n,[L,E]=S,[g,P]=c,[t,C]=f,[k,v]=l,[u,T]=a.useState(0),[_,O]=a.useState(""),[b,F]=a.useState(!1),[p,R]=a.useState({x:0,y:0});a.useEffect(()=>{if(t){R(t.origin);for(let M=0;M<t.media.length;M++)if(!t.media[M].seen)return T(M)}},[]);const I=M=>{if(b)return F(!1);const G=M.target.getBoundingClientRect(),$=M.clientX-G.left;let Y=t.media[u];if(Y.seen||A("Instagram",{action:"viewedStory",id:Y.id}),$<G.width/2)if(u>0)T(u-1);else{let D=g.findIndex(z=>z.username===t.username),x=g[D-1];x&&N.fetchAndSetStory(x)}else if(u<t.media.length-1)T(u+1);else{let D=g.findIndex(z=>z.username===t.username),x=g[D+1];x?(i(t.username),N.fetchAndSetStory(x),T(0)):d()}},V=()=>{!_||_===""||A("Instagram",{action:"sendMessage",username:t.username,message:{content:_}}).then(M=>{M&&(v({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),E("dm"),d())})},i=M=>{t.media.length===u+1&&P(G=>G.map($=>($.username===M&&($.seen=!0),$)))},d=M=>{M!==!1&&i(t.username),C(null)};return s(ue.div,{className:"instagram-story",initial:{scale:0,transformOrigin:t!=null&&t.origin?`${((w=t==null?void 0:t.origin)==null?void 0:w.x)??0}px ${((h=t==null?void 0:t.origin)==null?void 0:h.y)??0}px`:"50% 50%"},animate:{scale:1,transformOrigin:t!=null&&t.origin?`${((o=t==null?void 0:t.origin)==null?void 0:o.x)??0}px ${((y=t==null?void 0:t.origin)==null?void 0:y.y)??0}px`:"50% 50%"},exit:{scale:0,transformOrigin:p?`${(p==null?void 0:p.x)??0}px ${(p==null?void 0:p.y)??0}px`:"50% 50%"},transition:{duration:.25,ease:"easeInOut"},children:[K(t==null?void 0:t.media[u].image)?e("video",{className:"background-image",onClick:I,autoPlay:!0,loop:!0,src:t==null?void 0:t.media[u].image}):e("div",{className:"background-image",onClick:I,style:{backgroundImage:`url(${t==null?void 0:t.media[u].image})`}}),e(me,{children:b&&e(nt,{activeImage:u,close:()=>F(!1)})}),s("div",{className:"story-wrapper",children:[s("div",{className:"story-header",children:[e("div",{className:"story-steps",children:t==null?void 0:t.media.map((M,G)=>e("div",{className:u===G?"active":"",onClick:()=>T(G)},G))}),s("div",{className:"profile-details",children:[s("div",{className:"profile",onClick:()=>N.fetchAndSetProfile(t.username),children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${N.getAvatar(t==null?void 0:t.avatar)})`}}),s("div",{className:"name",children:[t==null?void 0:t.username,!1]}),e("div",{className:"time",children:se(t==null?void 0:t.media[u].timestamp)})]}),e("div",{className:"stats",children:e(re,{onClick:()=>{if(t!=null&&t.media[u].seen)return d();A("Instagram",{action:"viewedStory",id:t==null?void 0:t.media[u].id}).then(M=>d())}})})]})]}),(t==null?void 0:t.username)===m.username?s("div",{className:"story-footer","data-stats":!0,children:[s("div",{className:"seen-by",onClick:()=>F(!0),children:[(t==null?void 0:t.media[u].viewers)&&e("div",{className:"images",children:t==null?void 0:t.media[u].viewers.map((M,G)=>e("img",{src:N.getAvatar(M.avatar)},G))}),r("APPS.INSTAGRAM.SEEN_BY").format({count:xe(t==null?void 0:t.media[u].views)??0})]}),e(re,{onClick:()=>{H.PopUp.set({title:r("APPS.INSTAGRAM.DELETE_STORY.TITLE"),description:r("APPS.INSTAGRAM.DELETE_STORY.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.DELETE_STORY.CANCEL")},{title:r("APPS.INSTAGRAM.DELETE_STORY.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"removeFromStory",id:t==null?void 0:t.media[u].id}).then(M=>{if(!M)return he("error","Failed to remove image from story");he("info","Removed image from story"),C(null),t.media.length===1&&P(G=>G.filter($=>$.username!==t.username))})}}]})}})]}):s("div",{className:"story-footer",children:[e("div",{className:"input",children:e(X,{type:"text",placeholder:r("APPS.INSTAGRAM.SEND_A_MESSAGE"),onChange:M=>O(M.target.value),onKeyDown:M=>{M.key==="Enter"&&V()}})}),e(_e,{onClick:()=>V()})]})]})]})}const nt=n=>{var v;const{Func:S,Story:N}=a.useContext(B),[c,f]=N,[l,m]=a.useState([]),[L,E]=a.useState(0),[g,P]=a.useState(!1),[t,C]=a.useState(!1);a.useEffect(()=>{(n==null?void 0:n.activeImage)!==void 0&&A("Instagram",{action:"getViewers",id:c==null?void 0:c.media[n.activeImage].id,page:0}).then(u=>{u&&(m(u),u.length<15&&P(!0))})},[]);const k=u=>{if(g||t)return;let T=document.querySelector("#last");if(!T)return;!Z(T)&&(C(!0),A("Instagram",{action:"getViewers",id:c==null?void 0:c.media[n.activeImage].id,page:L+1}).then(O=>{O&&O.length>0?(m(b=>[...b,...O]),C(!1),O.length<15&&P(!0)):P(!0)}),E(O=>O+1))};return s(ue.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[s("div",{className:"story-modal-header",children:[s("div",{className:"views",children:[e(pe,{})," ",e("div",{className:"views",children:((v=c==null?void 0:c.media[n==null?void 0:n.activeImage])==null?void 0:v.views)??0})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),s("div",{className:"story-modal-content",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",onScroll:k,children:l.map((u,T)=>{let _=T===l.length-1?"last":"";return e("div",{className:"item",id:_,children:s("div",{className:"user",onClick:()=>{S.fetchAndSetProfile(u.username),f(null)},children:[e("div",{className:"profile-picture",children:e("img",{src:S.getAvatar(u.avatar)})}),s("div",{className:"user-details",children:[s("div",{className:"username",children:[u.username,u.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:u.name})]})]})},T)})})]})]})};function it(){var L;const{Func:n,View:S,Account:N}=a.useContext(B),c=te(ae.Settings),[f,l]=S,[m]=N;return e("div",{className:"instagram-footer",children:s(W,{children:[e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("feed"),children:e("g",{children:f=="feed"?e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M22 23h-6.001a1 1 0 01-1-1v-5.455a2.997 2.997 0 10-5.993 0V22a1 1 0 01-1 1H2a1 1 0 01-1-1V11.543a1.002 1.002 0 01.31-.724l10-9.543a1.001 1.001 0 011.38 0l10 9.543a1.002 1.002 0 01.31.724V22a1 1 0 01-1 1z"}):e("path",{d:"M9.005 16.545a2.997 2.997 0 012.997-2.997h0A2.997 2.997 0 0115 16.545V22h7V11.543L12 2 2 11.543V22h7.005z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("search"),children:f=="search"?e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M13.173 13.164l1.491-3.829-3.83 1.49zM12.001.5a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012.001.5zm5.35 7.443l-2.478 6.369a1 1 0 01-.57.569l-6.36 2.47a1 1 0 01-1.294-1.294l2.48-6.369a1 1 0 01.57-.569l6.359-2.47a1 1 0 011.294 1.294z"}):s(W,{children:[e("polygon",{fill:"none",points:"13.941 13.953 7.581 16.424 10.06 10.056 16.42 7.585 13.941 13.953",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("polygon",{fillRule:"evenodd",points:"10.06 10.056 13.949 13.945 7.581 16.424 10.06 10.056"}),e("circle",{cx:"12.001",cy:"12.005",fill:"none",r:"10.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("newPost"),children:s(W,{children:[e("path",{d:"M2 12v3.45c0 2.849.698 4.005 1.606 4.944.94.909 2.098 1.608 4.946 1.608h6.896c2.848 0 4.006-.7 4.946-1.608C21.302 19.455 22 18.3 22 15.45V8.552c0-2.849-.698-4.006-1.606-4.945C19.454 2.7 18.296 2 15.448 2H8.552c-2.848 0-4.006.699-4.946 1.607C2.698 4.547 2 5.703 2 8.552z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"6.545",x2:"17.455",y1:"12.001",y2:"12.001"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"12.003",x2:"12.003",y1:"6.545",y2:"17.455"})]})}),f==="notifications"?e("svg",{fill:"#262626",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{color:((L=c==null?void 0:c.display)==null?void 0:L.theme)==="dark"?"#ffffff":"#262626",fill:c.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("notifications"),children:e("path",{color:c.display.theme=="dark"&&"#fafafa",d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})}),e("img",{src:n.getAvatar(m.avatar),className:"profile",alt:"profile",onClick:()=>n.fetchAndSetProfile(m.username)})]})})}function rt(){const{Account:n,UserPanel:S,GoBack:N}=a.useContext(B),[c,f]=S,[l,m]=a.useState([]),[L,E]=a.useState(0),[g,P]=a.useState(!1),[t,C]=a.useState(!1);let k={[r("APPS.INSTAGRAM.FOLLOWING")]:"getFollowing",[r("APPS.INSTAGRAM.FOLLOWERS")]:"getFollowers",[r("APPS.TWITTER.LIKED_BY")]:"getLikes"};a.useEffect(()=>{A("Instagram",{action:k[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:0}}).then(u=>{u&&m(u)})},[]);const v=()=>{if(g||t)return;!Z(document.querySelector("#last"))&&(C(!0),A("Instagram",{action:k[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:L+1}}).then(T=>{T&&T.length>0?(m([...l,...T]),C(!1)):P(!0)}),E(T=>T+1))};return e(W,{children:c.data&&l&&s("div",{className:"userpanel-container",children:[s("div",{className:"userpanel-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{var u;(u=c.data)==null||u.cb()}}),e("div",{className:"userpanel-title",children:c.data.title}),e("span",{})]}),e("div",{className:"userpanel-body",onScroll:v,children:e("div",{className:"items",children:l.map((u,T)=>{let _=T===l.length-1;return e(ct,{data:u,allData:c.data,last:_},T)})})})]})})}const ct=n=>{const{Func:S,Account:N,GoBack:c,UserPanel:f}=a.useContext(B),[l]=N,[m,L]=c,[E,g]=f;let P=n.data,t=n.last;const[C,k]=a.useState(P.isFollowing===1);return s("div",{className:"item",id:t?"last":"",onClick:()=>{L({cb:()=>{g({display:!0,data:n.allData})}}),S.fetchAndSetProfile(P.username)},children:[s("div",{className:"user",children:[e("div",{className:"profile-picture",children:e("img",{src:S.getAvatar(P.avatar),alt:"profile"})}),s("div",{className:"user-details",children:[s("div",{className:"username",children:[P.username,P.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:P.name})]})]}),l.username!==P.username&&e("div",{className:"action",onClick:v=>{v.stopPropagation(),P.username!==l.username&&(C?H.PopUp.set({title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:P.username}),buttons:[{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:P.username,following:!C}}).then(()=>{k(u=>!u)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:P.username,following:!C}}).then(()=>{k(u=>!u)}))},children:C?e("div",{className:"button following",children:r("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",children:r("APPS.INSTAGRAM.FOLLOW")})})]})},B=a.createContext(null);function It(){const{Func:n}=a.useContext(Fe),S=te(ae.Settings),N=te(ae.App),[c,f]=n.TextColor,[l,m]=a.useState("feed"),[L,E]=a.useState(null),[g,P]=a.useState(!1),[t,C]=a.useState([]),[k,v]=a.useState(null),[u,T]=a.useState(null),[_,O]=a.useState(null),[b,F]=a.useState(null),[p,R]=a.useState(null),[I,V]=a.useState(null),[i,d]=a.useState({display:!1,data:null}),[w,h]=a.useState(!0);a.useEffect(()=>{var D;N&&(N==null?void 0:N.view)==="profile"&&y((D=N==null?void 0:N.data)==null?void 0:D.username)},[N]),a.useEffect(()=>{A("isAdmin").then(D=>{if(Q.APPS.INSTAGRAM.account.value){E({...Q.APPS.INSTAGRAM.account.value,isAdmin:D}),P(!0),h(!1);return}else if(Q.APPS.INSTAGRAM.account.value===!1)return h(!1);A("Instagram",{action:"isLoggedIn"}).then(x=>{x?(Q.APPS.INSTAGRAM.account.set(x),E({...x,isAdmin:D}),P(!0),h(!1)):(Q.APPS.INSTAGRAM.account.set(null),h(!1))})})},[]),a.useEffect(()=>(setTimeout(()=>{l==="live"||l==="newPost"||l==="story"?(f("#fafafaed"),l=="live"&&H.IndicatorVisible.set(!1)):(f(S.display.theme==="dark"?"#fafafaed":"#000000"),H.IndicatorVisible.set(!0)),l==="dm"?ne.ReceiveAppNotifications.set(!1):ne.ReceiveAppNotifications.set(!0)},250),()=>{ne.ReceiveAppNotifications.set(!0)}),[l]);const o=(D,x)=>{D&&A("Instagram",{action:"getPost",id:D}).then(z=>{if(z){if(x)return M(z);R(z),m("post")}})},y=D=>{D&&A("Instagram",{action:"getProfile",username:D}).then(x=>{x&&(T(x),m("profile"))})},M=D=>{D.id&&A("Instagram",{action:"getComments",postId:D.id,page:0}).then(x=>{x&&(F({post:D,comments:x}),m("comments"))})},G=(D,x,z)=>{!D&&!(D!=null&&D.username)||((x==null?void 0:x.length)==0&&(x=void 0),A("Instagram",{action:"getStory",username:D.username}).then(le=>{le&&v({username:D.username,avatar:D.avatar,verified:D.verified,media:le,queue:x,origin:z})}))},$=D=>D||"./assets/img/icons/instagram/unknown-pfp.jpg",Y={feed:e($e,{}),search:e(Xe,{}),notifications:e(Ye,{}),profile:e(qe,{}),live:e(He,{}),logIn:e(Ae,{}),comments:e(Ke,{}),post:e(et,{}),newPost:e(Qe,{}),userpanel:e(rt,{}),dmList:e(at,{}),dm:e(tt,{})};return a.useEffect(()=>{i.display&&m("userpanel")},[i]),e("div",{className:"instagram-container",children:e(B.Provider,{value:{View:[l,m],Account:[L,E],Profile:[u,T],Post:[p,R],Comments:[b,F],LoggedIn:[g,P],GoBack:[I,V],UserPanel:[i,d],Dm:[_,O],Stories:[t,C],Story:[k,v],Func:{fetchAndSetProfile:y,fetchAndSetStory:G,fetchAndSetComments:M,fetchAndSetPost:o,getAvatar:$}},children:w||S.airplaneMode?e("div",{className:"loading",children:e(We,{size:55,speed:.9,color:c})}):e("div",{className:"instagram-wrapper",children:g?s(W,{children:[e(me,{children:k&&e(st,{})}),Y[l],l!=="live"&&l!=="logIn"&&l!=="newPost"&&l!=="comments"&&!k&&e(it,{})]}):e(Ae,{})})})})}export{B as InstagramContext,It as default};
