import{j as e,F as W,r as s,a}from"./jsx-runtime-f40812bf.js";import{b as te,c as ae,u as X,O as K,f as A,aw as Le,C as B,L as r,X as re,F as Re,ay as Me,h as ce,bv as pe,W as Z,aA as Oe,$ as de,S as ie,b5 as ye,M as ue,k as q,a2 as fe,bs as Ie,Q as ne,v as Q,a7 as se,ab as Ce,bw as Ge,d as me,x as ge,I as ve,bx as Ve,by as be,a8 as _e,Z as Se,_ as Ae,at as Fe,bz as De,E as Ue,aF as xe}from"./Phone-bbdfbfe1.js";import{r as We}from"./number-28525126.js";import{C as Be}from"./Check-ebaab325.js";import{formatNumber as $e}from"./Tiktok-bddf9de8.js";import"./Switch-51deb5c4.js";import"./Slider-8373e24b.js";function Ee(i){const N=te(ae.Settings);return e(W,{children:i.liked?e("svg",{onClick:i.onClick,color:"#ed4956",fill:"#ed4956",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{onClick:i.onClick,color:N.display.theme==="dark"?"#ffffff":"#262626",fill:N.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})})})}function we(i){const{Account:N,View:S,Func:c,UserPanel:h}=s.useContext($),l=te(ae.Settings),[m]=N,[L,w]=S,[g,P]=h,[t,p]=s.useState(i.data),E=s.useRef(null);s.useRef(null);const[v,u]=s.useState(0),[T,b]=s.useState(!1),M={pos:{startLeft:0,startX:0},onMouseDown:C=>{M.pos={startLeft:E.current.scrollLeft,startX:C.clientX},E.current.style.userSelect="none",document.addEventListener("mouseup",M.onMouseUp),document.addEventListener("mousemove",M.onMove)},onMove:C=>{const k=(C.clientX-M.pos.startX)/Me(l.display.size);E.current.scrollLeft=M.pos.startLeft-k;const y=E.current.getBoundingClientRect();(y.left-5>C.clientX||C.clientX>y.right-5)&&M.onMouseUp()},onMouseUp:()=>{E.current.style.removeProperty("user-select"),document.removeEventListener("mouseup",M.onMouseUp),document.removeEventListener("mousemove",M.onMove);const C=JSON.parse(t.media),k=E.current.clientWidth;let y=v;const F=E.current.scrollLeft-M.pos.startLeft;F>k/2&&y<C.length-1?y++:F<-k/2&&y>0&&y--,V(y)}},V=C=>{E.current.scrollTo({left:C*E.current.offsetWidth,behavior:"smooth"}),u(C)};X("instagram:setLikes",C=>{C.postId!==t.id||C.isComment||p({...t,like_count:C.likes})});const _=C=>{if(C.detail===2){if(!t.id)return;t.liked||A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(k=>{p({...t,liked:k.liked,like_count:k.likes})}),b(!0),setTimeout(()=>{b(!1)},1e3)}};return a("div",{className:"post",id:i.last?"last":"","data-id":t.id,"data-active":i.active,children:[a("div",{className:"post-header",children:[e("img",{className:"profile-picture",onClick:()=>{c.fetchAndSetProfile(t.username)},src:c.getAvatar(t.avatar)}),a("div",{className:"post-info",children:[a("div",{className:"name",onClick:()=>c.fetchAndSetProfile(t.username),children:[t.username,t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),t.location&&e("div",{className:"location",children:t.location})]})]}),a("div",{className:"post-body",children:[T&&e("div",{className:`popup-heart ${T?"show":"hide"}`,children:e("svg",{color:"#e3e3e3",fill:"#e3e3e3",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})})}),e("div",{className:"image-container",ref:E,onMouseDown:M.onMouseDown,children:JSON.parse(t.media).map((C,k)=>e("div",{className:"image",onClick:_,children:K(C)?e(He,{attachment:C,active:i.active}):e("img",{src:C})},k))}),a("div",{className:"actions",children:[a("div",{className:"like-comment",children:[e(Ee,{liked:t.liked,onClick:()=>{t.id&&A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(C=>{p({...t,liked:C.liked,like_count:C.likes})})}}),e("svg",{onClick:()=>c.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp}),color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M20.656 17.008a9.993 9.993 0 10-3.59 3.615L22 22z",fill:"none",stroke:"currentColor",strokeWidth:"2px"})}),(t.username===m.username||m.isAdmin)&&e(Le,{onClick:()=>{B.PopUp.set({title:r("APPS.INSTAGRAM.DELETE_POST_POPUP.TITLE"),description:r("APPS.INSTAGRAM.DELETE_POST_POPUP.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.DELETE_POST_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.DELETE_POST_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"deletePost",id:t.id}).then(C=>{C&&w("feed")})}}]})}})]}),JSON.parse(t.media).length>1&&e("div",{className:"scroll-dots",children:JSON.parse(t.media).map((C,k)=>e("div",{className:`dot ${v==k?"active":""}`,onClick:()=>V(k)},k))})]}),a("div",{className:"liked-by",onClick:()=>{P({display:!0,data:{title:r("APPS.INSTAGRAM.LIKED_BY"),postId:t.id,cb:()=>{w("feed")}}})},children:[t.like_count," ",r("APPS.INSTAGRAM.LIKES")]}),a("div",{className:"caption",children:[e("span",{className:"user",onClick:C=>{C.stopPropagation(),c.fetchAndSetProfile(t.username)},children:t.username}),re(t.caption)," "]}),e("div",{className:"comments",onClick:C=>{C.stopPropagation(),c.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp})},children:t.comment_count>0?r("APPS.INSTAGRAM.VIEW_ALL_COMMENTS").format({count:t.comment_count}):r("APPS.INSTAGRAM.FIRST_COMMENT")}),e("div",{className:"date",children:Re(t.timestamp)})]})]})}const He=i=>{var l;const[N,S]=s.useState(i.active),c=te(ae.Settings),h=s.useRef(null);return s.useEffect(()=>{var m;S(i.active),!(!h.current||!((m=c==null?void 0:c.sound)!=null&&m.volume))&&i.active&&(h.current.volume=c.sound.volume,h.current.currentTime=0)},[i.active]),s.useEffect(()=>{var m;!h.current||!((m=c==null?void 0:c.sound)!=null&&m.volume)||i.active&&(h.current.volume=c.sound.volume)},[(l=c==null?void 0:c.sound)==null?void 0:l.volume]),e("video",{src:i.attachment,autoPlay:!0,loop:!0,muted:!i.active,ref:h,onLoadedMetadata:m=>{i.active&&(m.currentTarget.volume=c.sound.volume)}})};function Ye(){const{Account:i,View:N,Func:S,Stories:c}=s.useContext($),[h,l]=N,[m]=i,[L,w]=s.useState([]),[g,P]=s.useState([]),[t,p]=c,[E,v]=s.useState(0),[u,T]=s.useState(!1),[b,M]=s.useState(!1),[V,_]=s.useState(null);s.useEffect(()=>{A("Instagram",{action:"getPosts",filters:{following:!0},page:0}).then(n=>{n&&w(n)})},[]),s.useEffect(()=>{h==="feed"&&(A("Instagram",{action:"getLives"}).then(n=>{n&&P(n)}),A("Instagram",{action:"getStories"}).then(n=>{n&&p([...n.sort((d,I)=>{if(d.seen===I.seen)return 0;if(d.seen===1)return 1;if(I.seen===1)return-1})])}))},[h]);const C=new IntersectionObserver(k,{rootMargin:"20px",threshold:.5});function k(n){n.forEach(d=>{if(d.isIntersecting){let f=d.target.getAttribute("data-id");_(f)}})}const y=()=>{if(u||b)return;let n=document.querySelector("#last");if(!n)return;document.querySelectorAll(".post").forEach(f=>C.observe(f)),!Z(n)&&(M(!0),A("Instagram",{action:"getPosts",filters:{following:!0},page:E+1}).then(f=>{f&&f.length>0?(w([...L,...f]),M(!1)):T(!0)}),v(f=>f+1))};s.useEffect(()=>{const n=document.querySelector(".stories");n.addEventListener("wheel",d=>{d.preventDefault(),n.scrollLeft+=d.deltaY})},[]),X("instagram:updateLives",n=>{n&&P(n)});const F=()=>{B.PopUp.set({title:r("APPS.INSTAGRAM.GO_LIVE_POPUP.TITLE"),description:r("APPS.INSTAGRAM.GO_LIVE_POPUP.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.GO_LIVE_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.GO_LIVE_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"goLive",user:{username:m.username,avatar:S.getAvatar(m==null?void 0:m.avatar),verified:m.verified}}),l("live")}}]})};return a(W,{children:[a("div",{className:"instagram-header feed-header",children:[a("div",{className:"name",children:[m.username,m.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),a("svg",{onClick:()=>l("dmList"),color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[e("line",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2",x1:"22",x2:"9.218",y1:"3",y2:"10.083"}),e("polygon",{fill:"none",points:"11.698 20.334 22 3.001 2 3.001 9.218 10.084 11.698 20.334",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})]})]}),a("div",{className:"feed",onScroll:y,children:[e("div",{className:"stories-wrapper",children:a("div",{className:"stories",children:[a("div",{className:"story self",onClick:()=>{B.ContextMenu.set({buttons:[{title:r("APPS.INSTAGRAM.GO_LIVE"),cb:()=>{F()}},{title:r("APPS.INSTAGRAM.CREATE_STORY"),cb:()=>{var n,d,I;B.Gallery.set({includeVideos:!0,allowExternal:(I=(d=(n=ce)==null?void 0:n.value)==null?void 0:d.AllowExternal)==null?void 0:I.Instagram,onSelect:f=>{A("Instagram",{action:"addToStory",media:f.src}).then(o=>{o&&p([{username:m.username,avatar:m.avatar,verified:m.verified,seen:0,id:o},...t.filter(O=>O.username!==m.username)])})}})}}]})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${S.getAvatar(m==null?void 0:m.avatar)})`},children:e("div",{className:"plus",children:e("i",{className:"far fa-plus"})})}),e("div",{className:"name",children:r("APPS.INSTAGRAM.YOUR_STORY")})]}),Object.keys(g).map((n,d)=>{var I;return a("div",{className:"story",onClick:()=>{A("Instagram",{action:"viewLive",username:n}),l("live")},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${S.getAvatar((I=g[n])==null?void 0:I.avatar)})`},children:e("img",{className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"})}),e("div",{className:"name",children:n})]},d)}),t.map((n,d)=>a("div",{className:"story",onClick:I=>{let[f,o]=pe(I);S.fetchAndSetStory(n,null,{x:f,y:o})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${S.getAvatar(n==null?void 0:n.avatar)})`},children:e("img",{className:"circle","data-seen":n.seen===1,src:"./assets/img/icons/instagram/StoryCircle.png"})}),e("div",{className:"name",children:n.username})]},d))]})}),L.length===0&&e("div",{className:"no-posts",children:r("APPS.INSTAGRAM.EMPTY_FEED")}),L.map((n,d)=>{let I=d===L.length-1;return e(we,{data:n,active:V===n.id,last:I},d)})]})]})}function je(){const{View:i,Account:N,Func:S}=s.useContext($),[c,h]=i,[l]=N,m=te(ce),[L,w]=s.useState(""),[g,P]=s.useState(!1),[t,p]=s.useState(!1),E=s.useRef(null),[v,u]=s.useState({id:null,user:{username:"",avatar:"",verified:!1},viewers:0}),T=s.useRef(null),b=s.useRef(null),M=s.useRef(null),[V,_]=s.useState([]),[C,k]=s.useState([]),[y,F]=s.useState(null);s.useEffect(()=>{b.current.scrollTop=b.current.scrollHeight},[C]),s.useEffect(()=>{if(!y||M.current)return;let f=new Oe(y);M.current=f,f.resizeByAspect(3/4);const o=window.innerWidth;o>1280&&f.setQuality(1280/o)},[y]),s.useEffect(()=>()=>{M.current&&M.current.destroy()},[]),s.useEffect(()=>{const f=v;if(!(f!=null&&f.id)||!T.current||g)return;const o=m.ice?new de({config:{iceTransportPolicy:"relay",iceServers:m.ice}}):new de;o.on("open",()=>{const O=document.createElement("canvas");O.width=5,O.height=5;const R=O.captureStream(0),G=o.call(f.id,R);_([...V,G]),G.on("close",()=>{O.remove()}),G.on("error",()=>{O.remove()}),G.on("stream",H=>{const j=T.current;j.onloadeddata=()=>{j.play()},j.srcObject=H,A("Instagram",{action:"addCall",id:G.connectionId,username:l.username})})})},[T.current,v.user]),s.useEffect(()=>{if(P(l.username===(v==null?void 0:v.user.username)),(v==null?void 0:v.user.username)!==l.username||!y)return;const f=m.ice?new de({config:{iceTransportPolicy:"relay",iceServers:m.ice}}):new de;f.on("open",O=>{A("Instagram",{action:"setLive",username:l.username,verified:l.verified,id:O})});const o=y.captureStream(24);f.on("call",O=>{O.answer(o),O.on("close",()=>{_(V.filter(R=>R.connectionId!==O.connectionId))}),_([...V,O])})},[v,y]);const n=()=>{B.PopUp.set({title:r("APPS.INSTAGRAM.END_LIVE_POPUP.TITLE"),description:r("APPS.INSTAGRAM.END_LIVE_POPUP.DESCRIPTION").format({action:(g?r("APPS.INSTAGRAM.END_LIVE_POPUP.END"):r("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE")).toLowerCase()}),buttons:[{title:r("APPS.INSTAGRAM.END_LIVE_POPUP.CANCEL")},{title:g?r("APPS.INSTAGRAM.END_LIVE_POPUP.END"):r("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE"),color:"red",cb:()=>{ie.ShouldClose.set(!0),I(!0)}}]})},d=()=>{A("Instagram",{action:"sendLiveMessage",data:{user:{username:l.username,avatar:l.avatar,verified:l.verified},live:v.user.username,content:L}}),w("")},I=(f,o)=>{if(g)A("Instagram",{action:"endLive",username:l.username}).then(()=>{h("feed")});else if(A("Instagram",{action:"stopViewing",username:v.user.username}),f)ie.ShouldClose.set(!0),u({...v,ended:!0});else{if(o===!1)return;h("feed")}V.forEach(O=>{O.close()}),_([])};return X("instagram:addMessage",f=>{f.live===v.user.username&&k([...C,f])}),X("instagram:updateViewers",f=>{f.username===(v==null?void 0:v.user.username)&&u({...v,viewers:f.viewers})}),X("instagram:setLive",f=>{u(f),ie.ShouldClose.set(!1)}),X("instagram:liveEnded",f=>{f===(v==null?void 0:v.user.username)&&I(!0)}),X("instagram:stopLive",()=>{h("feed")}),X("instagram:endCall",f=>{V.forEach(o=>{o.connectionId===f&&o.close()}),_(V.filter(o=>o.connectionId!==f))}),a(W,{children:[e("div",{className:"instagram-stream",children:g?e("canvas",{ref:f=>F(f)}):e("video",{ref:T})}),v.ended&&a("div",{className:"instagram-stream-ended",children:[e(ye,{onClick:()=>h("feed")}),e("div",{className:"title",children:r("APPS.INSTAGRAM.LIVE_ENDED")})]}),e(ue,{children:t&&e(ze,{username:v.user.username,owner:g,endLive:I,close:()=>p(!1)})}),a("div",{className:"instagram-live",children:[a("div",{className:"live-header",children:[a("div",{className:"profile",onClick:()=>{g||(I(),S.fetchAndSetProfile(v.user.username))},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${v.user.avatar?v.user.avatar:"./assets/img/icons/instagram/unknown-pfp.jpg"})`}}),a("div",{className:"name",children:[v.user.username.length>12?v.user.username.substring(0,12)+"...":v.user.username,v.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),a("div",{className:"stats",children:[e("div",{className:"live",children:r("APPS.INSTAGRAM.LIVE")}),a("div",{className:"viewers",onClick:()=>p(!0),children:[e("i",{className:"fas fa-eye"}),v.viewers]}),e("i",{className:"far fa-times x",onClick:()=>{g?n():I(!1)}})]})]}),a("div",{className:"comment-section",children:[e("div",{className:"comment-feed",ref:b,children:C.map((f,o)=>{let O=f.user.avatar??"./assets/img/icons/instagram/unknown-pfp.jpg";return a("div",{className:"comment",children:[e("img",{src:O}),a("div",{className:"info",children:[a("div",{className:"name",children:[f.user.username,f.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"comment-text",children:f.content})]})]},o)})}),a("div",{className:"comment-input",children:[e(q,{type:"text",ref:E,placeholder:r("APPS.INSTAGRAM.COMMENT_PLACEHOLDER"),onChange:f=>w(f.target.value),onKeyDown:f=>{f.key==="Enter"&&L.replace(/ /g,"").length>0&&(d(),E.current.value="")}}),e("i",{className:"far fa-paper-plane",onClick:()=>{L.replace(/ /g,"").length>0&&(d(),E.current.value="")}}),g&&e("i",{className:"fas fa-repeat",onClick:()=>{A("Instagram",{action:"flipCamera"})}})]})]})]})]})}const ze=i=>{const{Func:N}=s.useContext($),[S,c]=s.useState([]);return s.useEffect(()=>{A("Instagram",{action:"getLiveViewers",username:i.username}).then(h=>{h&&c(h)})},[]),a(fe.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[a("div",{className:"story-modal-header",children:[a("div",{className:"views",children:[e(Ie,{})," ",e("div",{className:"views",children:S.length})]}),e(ne,{className:"close",onClick:i==null?void 0:i.close})]}),a("div",{className:"story-modal-content",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",children:S.map((h,l)=>{let m=l===S.length-1?"last":"";return e("div",{className:"item",id:m,children:a("div",{className:"user",onClick:()=>{i.owner||(i.endLive(!1,!1),N.fetchAndSetProfile(h.username))},children:[e("div",{className:"profile-picture",children:e("img",{src:N.getAvatar(h.avatar)})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[h.username,h.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:h.name})]})]})},l)})})]})]})};function Pe(){const{View:i,Account:N,LoggedIn:S}=s.useContext($),c=te(ae.Settings),[h,l]=s.useState(""),[m,L]=s.useState(""),[w,g]=s.useState(""),[P,t]=s.useState(!1),[p,E]=s.useState(!1),[v,u]=s.useState(!1),[T,b]=i,[M,V]=N,[_,C]=S,[k,y]=s.useState("login"),F=()=>{t(!1),E(!1),A("Instagram",{action:"logIn",username:m,password:w}).then(d=>{d.success&&d.account?(E(!1),t(!1),A("isAdmin").then(I=>{Q.APPS.INSTAGRAM.account.set(d.account),V({...d.account,isAdmin:I}),b("feed"),C(!0)})):d.error=="no account"?t(!0):d.error=="wrong password"?E(!0):console.log(d.error)})},n=()=>{let d=m.toLowerCase().replace(/\s/g,"");d.length<3||d.length>15||A("Instagram",{action:"createAccount",name:h,username:d,password:w}).then(I=>{I.success?(E(!1),t(!1),A("isAdmin").then(f=>{let o={name:h,username:d,posts:0,followers:0,following:0};Q.APPS.INSTAGRAM.account.set(o),V({...o,isAdmin:f}),b("feed"),C(!0)})):console.log("couldn't create account",I)})};return s.useEffect(()=>{E(!1),t(!1)},[k]),e("div",{className:"log-in",children:a(W,{children:[e("div",{className:"wrapper",children:k==="login"?a(W,{children:[e("img",{src:"./assets/img/icons/instagram/logo.png","data-theme":c.display.theme}),a("div",{className:"form",children:[e(q,{placeholder:r("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:d=>L(d.target.value.replace(/\s/g,"")),maxLength:15}),P&&e("div",{className:"instagram-wrong",children:r("APPS.INSTAGRAM.NO_ACCOUNT")}),e(q,{placeholder:r("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:d=>g(d.target.value),maxLength:50}),p&&e("div",{className:"instagram-wrong",children:r("APPS.INSTAGRAM.WRONG_USERNAME_OR_PASSWORD")}),e("div",{className:"button",onClick:F,children:r("APPS.INSTAGRAM.LOG_IN")})]})]}):a(W,{children:[e("img",{src:"./assets/img/icons/instagram/logo.png","data-theme":c.display.theme}),a("div",{className:"form",children:[e(q,{placeholder:r("APPS.INSTAGRAM.NAME_PLACEHOLDER"),type:"text",onChange:d=>l(d.target.value),maxLength:20}),e(q,{placeholder:r("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:d=>L(d.target.value.replace(/\s/g,"")),maxLength:15}),v&&e("div",{className:"instagram-wrong",children:r("APPS.INSTAGRAM.ACCOUNT_WITH_USERNAME")}),e(q,{placeholder:r("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:d=>g(d.target.value),maxLength:50}),e("div",{className:"button",onClick:n,children:r("APPS.INSTAGRAM.CREATE_ACCOUNT")})]})]})}),e("div",{className:"footer",children:k==="login"?a(W,{children:[r("APPS.INSTAGRAM.NOT_HAVE_ACCOUNT")," ",e("span",{onClick:()=>y("createAccount"),children:r("APPS.INSTAGRAM.CREATE_ACCOUNT")})]}):a(W,{children:[r("APPS.INSTAGRAM.HAVE_ACCOUNT")," ",e("span",{onClick:()=>y("login"),children:r("APPS.INSTAGRAM.LOG_IN")})]})})]})})}function Xe(){const[i,N]=s.useState([]),[S,c]=s.useState(0),[h,l]=s.useState(!1),[m,L]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getNotifications"}).then(g=>{g&&N(g)})},[]);const w=()=>{if(h||m)return;let g=document.querySelector("#last");if(!g)return;!Z(g)&&(L(!0),A("Instagram",{action:"getNotifications",page:S+1}).then(t=>{t&&t.length>0?(N([...i,...t]),L(!1)):l(!0)}),c(t=>t+1))};return a("div",{className:"notifications-container",children:[e("div",{className:"notifications-header",children:r("APPS.INSTAGRAM.ACTIVITY")}),e("div",{className:"notifications-body",onScroll:w,children:i.map((g,P)=>{let t=P===i.length-1?"last":"";return e(qe,{notification:g,last:t},P)})})]})}const qe=({notification:i,last:N})=>{const{Account:S,Func:c}=s.useContext($),[h]=S,[l,m]=s.useState(i.isFollowing);switch(i.type){case"like_photo":return a("div",{className:"notification-item",id:N,onClick:()=>c.fetchAndSetPost(i.postId),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(i.avatar),onClick:w=>{w.stopPropagation(),c.fetchAndSetProfile(i.username)}}),a("div",{className:"content",children:[e("span",{children:i.username})," ",r("APPS.INSTAGRAM.LIKED_PHOTO"),e("span",{className:"date",children:se(i.timestamp)})]})]}),K(i.photo)?e("video",{className:"post-preview",src:i.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:i.photo})]});case"like_comment":return e("div",{className:"notification-item",id:N,onClick:()=>c.fetchAndSetPost(i.postId,!0),children:a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(i.avatar),onClick:w=>{w.stopPropagation(),c.fetchAndSetProfile(i.username)}}),a("div",{className:"content",children:[e("span",{children:i.username})," ",r("APPS.INSTAGRAM.LIKED_COMMENT").format({comment:i.comment}),e("span",{className:"date",children:se(i.timestamp)})]})]})});case"comment":return a("div",{className:"notification-item",id:N,onClick:()=>c.fetchAndSetPost(i.postId,!0),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(i.avatar),onClick:w=>{w.stopPropagation(),c.fetchAndSetProfile(i.username)}}),a("div",{className:"content",children:[e("span",{children:i.username})," ",r("APPS.INSTAGRAM.COMMENTED").format({comment:i.comment}),e("span",{className:"date",children:se(i.timestamp)})]})]}),K(i.photo)?e("video",{className:"post-preview",src:i.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:i.photo})]});case"follow":return a("div",{className:"notification-item",id:N,onClick:()=>c.fetchAndSetProfile(i.username),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:c.getAvatar(i.avatar),onClick:()=>c.fetchAndSetProfile(i.username)}),a("div",{className:"content",children:[e("span",{children:i.username})," ",r("APPS.INSTAGRAM.FOLLOWED"),e("span",{className:"date",children:se(i.timestamp)})]})]}),e("div",{className:`button ${l?"following":"follow"}`,onClick:w=>{w.stopPropagation(),h.username!==i.username&&(l?B.PopUp.set({title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:i.username}),buttons:[{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:i.username,following:!l}}).then(()=>{m(g=>!g)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:i.username,following:!l}}).then(()=>{m(g=>!g)}))},children:l?r("APPS.INSTAGRAM.FOLLOWING"):r("APPS.INSTAGRAM.FOLLOW")})]})}};function Ke(){const{View:i,Profile:N,Account:S,Func:c,GoBack:h,Post:l,UserPanel:m,LoggedIn:L,Dm:w}=s.useContext($),[g,P]=i,[t,p]=N,[E,v]=L,[u,T]=S,[b,M]=l,[V,_]=w,[C,k]=m,[y,F]=h,[n,d]=s.useState(!1),[I,f]=s.useState(!1),[o,O]=s.useState(null),[R,G]=s.useState(0),[H,j]=s.useState(!1),[D,x]=s.useState(!1);s.useEffect(()=>{t.username&&(d(u.username===t.username),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:0}).then(U=>{U&&O(U)}))},[t]);const z=()=>{if(H||D)return;let U=document.querySelector("#last");if(!U)return;!Z(U)&&(x(!0),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:R+1}).then(Y=>{Y&&Y.length>0?(O([...o,...Y]),x(!1)):j(!0)}),G(Y=>Y+1))},le=()=>{t.name&&A("Instagram",{action:"updateProfile",data:{name:t.name,bio:t.bio,avatar:t.avatar}}).then(U=>{U&&f(!1)})};X("instagram:setFollowers",U=>{U.username===t.username&&p({...t,followers:U.followers})}),X("instagram:setFollowing",U=>{U.username===t.username&&p({...t,following:U.following})});const Ne=s.useRef(!0);s.useEffect(()=>{if(Ne.current){Ne.current=!1;return}A("Instagram",{action:"toggleFollow",data:{username:t.username,following:t.isFollowing}})},[t.isFollowing]);const ke=()=>{A("AccountSwitcher",{action:"getAccounts",app:"Instagram"}).then(U=>{var ee;if(!U)return me("info","No accounts found");let J=u.isAdmin,Y=(ee=U==null?void 0:U.filter(oe=>oe!==t.username))==null?void 0:ee.map(oe=>({title:oe,cb:()=>{A("AccountSwitcher",{action:"switch",app:"Instagram",account:oe}).then(dt=>{A("Instagram",{action:"isLoggedIn"}).then(he=>{he?(Q.APPS.INSTAGRAM.account.set(he),T({...he,isAdmin:J}),P("feed"),v(!0)):Q.APPS.INSTAGRAM.account.set(null)})})}}));B.ContextMenu.set({buttons:[{title:u.username},...Y,{title:r("APPS.INSTAGRAM.ADD_ACCOUNT"),cb:()=>{v(!1)}}]})})};return e(W,{children:t&&a("div",{className:"profile",children:[e(ue,{children:I&&a(fe.div,{className:"edit-profile",initial:{y:750,opacity:.75},animate:{y:0,opacity:1},exit:{y:750,opacity:.75},transition:{duration:.3,ease:"easeInOut"},children:[a("div",{className:"edit-profile-header",children:[e("div",{className:"cancel",onClick:()=>f(!1),children:r("CANCEL")}),e("div",{className:"title",children:r("APPS.INSTAGRAM.EDIT_PROFILE")}),e("div",{className:"save",onClick:()=>le(),children:r("APPS.INSTAGRAM.DONE")})]}),a("div",{className:"edit-profile-body",children:[a("div",{className:"profile-picture",onClick:()=>{var U,J,Y;B.Gallery.set({allowExternal:(Y=(J=(U=ce)==null?void 0:U.value)==null?void 0:J.AllowExternal)==null?void 0:Y.Instagram,onSelect:ee=>{p({...t,avatar:ee.src}),T({...u,avatar:ee.src})}})},children:[e("img",{src:c.getAvatar(t.avatar),alt:"profile"}),e("span",{children:r("APPS.INSTAGRAM.CHANGE_PICTURE")})]}),a("div",{className:"profile-items",children:[a("div",{className:"item",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.NAME")}),e(q,{placeholder:r("APPS.INSTAGRAM.NAME_PLACEHOLDER"),onChange:U=>{p({...t,name:U.target.value})},maxLength:30,defaultValue:t.name})]}),a("div",{className:"item",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.BIO")}),e(Ce,{placeholder:r("APPS.INSTAGRAM.BIO"),onChange:U=>{p({...t,bio:U.target.value})},maxLength:100,defaultValue:t.bio??""})]})]}),e("div",{className:"sign-out",onClick:()=>{B.PopUp.set({title:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.TITLE"),description:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.SIGN_OUT_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"signOut"}).then(U=>{v(null),T(null),Q.APPS.INSTAGRAM.account.set(null)})}}]})},children:r("APPS.INSTAGRAM.SIGN_OUT")})]})]})}),n?e("div",{className:"instagram-header",children:a("div",{className:"name",style:{cursor:"pointer"},onClick:()=>ke(),children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})}),e(Ge,{})]})}):a("div",{className:"profile-header",children:[e("i",{className:"fas fa-chevron-left",onClick:()=>{y!=null&&y.cb?y.cb():P("feed")}}),a("div",{className:"name",children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("span",{})]}),a("div",{className:"profile-body",children:[a("div",{className:"profile-wrapper",children:[a("div",{className:"top",children:[a("div",{className:"profile-picture",style:{backgroundImage:`url(${c.getAvatar(t.avatar)})`},children:[t.isLive&&e("img",{onClick:()=>{A("Instagram",{action:"viewLive",username:t.username}),P("live")},className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"}),t.hasStory&&!t.isLive?e("img",{className:"circle","data-seen":t.seenStory===1,src:"./assets/img/icons/instagram/StoryCircle.png",onClick:U=>{let[J,Y]=pe(U);c.fetchAndSetStory({username:t.username,avatar:t.avatar,verified:t.verified},null,{x:J,y:Y})}}):null]}),a("div",{className:"stats",children:[a("div",{children:[e("div",{className:"value",children:t.posts}),e("div",{className:"label",children:t.posts===1?r("APPS.INSTAGRAM.POST"):r("APPS.INSTAGRAM.POSTS")})]}),a("div",{onClick:()=>{k({display:!0,data:{title:r("APPS.INSTAGRAM.FOLLOWERS"),username:t.username,cb:()=>{p(t),P("profile"),k({display:!1})}}})},children:[e("div",{className:"value",children:t.followers}),e("div",{className:"label",children:t.followers===1?r("APPS.INSTAGRAM.FOLLOWER"):r("APPS.INSTAGRAM.FOLLOWERS")})]}),a("div",{onClick:()=>{k({display:!0,data:{title:r("APPS.INSTAGRAM.FOLLOWING"),username:t.username,cb:()=>{p(t),P("profile"),k({display:!1})}}})},children:[e("div",{className:"value",children:t.following}),e("div",{className:"label",children:r("APPS.INSTAGRAM.FOLLOWING")})]})]})]}),e("div",{className:"name",children:t.name}),e("div",{className:"description",children:re(t.bio)??""}),e("div",{className:"buttons",children:n?n&&e("div",{className:"button edit",onClick:()=>{f(!0)},children:r("APPS.INSTAGRAM.EDIT_PROFILE")}):a(W,{children:[t.isFollowing?e("div",{className:"button following",onClick:()=>{B.PopUp.set({title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:t.username}),buttons:[{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{p({...t,isFollowing:!1})}}]})},children:r("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",onClick:()=>{p({...t,isFollowing:!0})},children:r("APPS.INSTAGRAM.FOLLOW")}),e("div",{className:"button following",onClick:()=>{_({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),P("dm")},children:r("APPS.INSTAGRAM.MESSAGE")})]})})]}),e("div",{className:"posts",onScroll:z,children:o&&o.map((U,J)=>{let Y=J===o.length-1?"last":"",ee=JSON.parse(U.media)[0];return e("div",{id:Y,onClick:()=>{F({cb:()=>{p(t),P("profile"),M(null),F(null)}}),M(U),P("post")},children:K(ee)?e("video",{src:ee,muted:!0,autoPlay:!0,loop:!0}):e("img",{src:ee})},J)})})]})]})})}function Je(){const{Func:i,View:N,GoBack:S,Post:c}=s.useContext($),[h,l]=N,[m,L]=S,[w,g]=c,[P,t]=s.useState(""),[p,E]=s.useState(""),[v,u]=s.useState([]);s.useState([]);const[T,b]=s.useState([]),[M,V]=s.useState(0),[_,C]=s.useState(!1),[k,y]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getPosts",page:0}).then(n=>{n&&b(n)})},[]),s.useEffect(()=>{const n=setTimeout(()=>t(p),500);return()=>clearTimeout(n)},[p]),s.useEffect(()=>{P.length>0&&A("Instagram",{action:"search",query:P}).then(n=>{n&&u(n)})},[P]);const F=()=>{if(_||k||P.length>0)return;let n=document.querySelector("#last");if(!n)return;!Z(n)&&(y(!0),A("Instagram",{action:"getPosts",page:M+1}).then(I=>{I&&I.length>0?(b([...T,...I]),y(!1)):C(!0)}),V(I=>I+1))};return a("div",{className:"search-container",children:[e("div",{className:"search-header",children:e(ge,{placeholder:r("SEARCH"),onChange:n=>E(n.target.value)})}),e("div",{className:"search-body",onScroll:F,children:P.length>0?e("div",{className:"search-results",children:v.map(n=>a("div",{className:"item",onClick:()=>{i.fetchAndSetProfile(n.username)},children:[e("div",{className:"profile-picture",children:e("img",{src:i.getAvatar(n.avatar),alt:"profile"})}),a("div",{className:"user",children:[a("div",{className:"username",children:[n.username,n.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:n.name})]})]}))}):e("div",{className:"feed-grid",children:T.map((n,d)=>{let f=Math.floor(d/3)%2==0,o=!1;o=d%3==(f?1:0),T[d+1]||(o=!1);let O=JSON.parse(n.media)[0],R=d==T.length-1?"last":"";return e("div",{id:R,className:`grid-post${o?" big":""}`,onClick:()=>{L({cb:()=>{l("search"),L(null)}}),g(n),l("post")},children:K(O)?e("video",{src:O,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:O,alt:"post"})},d)})})})]})}function Qe(){const{View:i,GoBack:N,Comments:S,Account:c,Func:h}=s.useContext($),[l]=c,[m,L]=i,[w]=N,[g,P]=S,[t,p]=s.useState(""),E=s.useRef(null),[v,u]=s.useState(0),[T,b]=s.useState(!1),[M,V]=s.useState(!1),_=()=>{t.length!==0&&A("Instagram",{action:"postComment",data:{postId:g.post.id,comment:t}}).then(k=>{if(!k)return me("error","Failed to post comment, no ");p(""),E.current.value="",P({...g,post:g.post,comments:[{user:{username:l.username,avatar:l.avatar,verified:l.verified},comment:{id:k,content:t,timestamp:new Date().getTime(),likes:0,liked:!1}},...g.comments]})})},C=()=>{if(T||M)return;let k=document.querySelector("#last");if(!k)return;!Z(k)&&(V(!0),A("Instagram",{action:"getComments",postId:g.post.id,page:v+1}).then(F=>{F&&F.length>0?(P({...g,comments:[...g.comments,...F]}),V(!1)):b(!0)}),u(F=>F+1))};return a("div",{className:"comments-container",children:[a("div",{className:"comments-header",children:[e(ve,{onClick:()=>{w&&(w!=null&&w.cb)?w.cb():L("feed")}}),e("div",{className:"title",children:r("APPS.INSTAGRAM.COMMENTS")}),e("span",{})]}),a("div",{className:"comments-body",onScroll:C,children:[a("div",{className:"post-info",children:[e("div",{className:"profile-picture",children:e("img",{src:h.getAvatar(g.post.avatar),alt:"profile"})}),a("div",{className:"post-data",children:[a("div",{className:"caption",children:[a("span",{className:"username",children:[g.post.username,g.post.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),re(g.post.caption)]}),e("div",{className:"actions",children:e("div",{className:"date",children:Te(g.post.timestamp)})})]})]}),g.comments.map((k,y)=>{let F=y===g.comments.length-1;return e(Ze,{data:k,last:F},y)})]}),a("div",{className:"add-comment",children:[e("div",{className:"profile-picture",children:e("img",{src:h.getAvatar(l.avatar),alt:"profile"})}),a("div",{className:"input-container",children:[e(q,{type:"text",ref:E,placeholder:r("APPS.INSTAGRAM.ADD_COMMENT_AS").format({name:l.username}),onKeyPress:k=>{k.key==="Enter"&&_()},onChange:k=>p(k.target.value)}),e("div",{className:"send",onClick:_,children:r("APPS.INSTAGRAM.POST")})]})]})]})}const Ze=({data:i,last:N})=>{const{Func:S}=s.useContext($),[c,h]=s.useState(i.comment.liked),[l,m]=s.useState(i.comment.likes);return a("div",{className:"comment",id:N&&"last",children:[a("div",{className:"user",children:[e("div",{className:"profile-picture",onClick:()=>S.fetchAndSetProfile(i.user.username),children:e("img",{src:S.getAvatar(i.user.avatar),alt:"profile"})}),a("div",{className:"comment-data",children:[a("div",{className:"caption",children:[a("span",{className:"username",onClick:()=>S.fetchAndSetProfile(i.user.username),children:[i.user.username,i.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),i.comment.content]}),a("div",{className:"actions",children:[e("div",{className:"date",children:Te(i.comment.timestamp)}),a("div",{className:"likes",children:[l," ",r("APPS.INSTAGRAM.LIKES").toLowerCase()]})]})]})]}),e(Ee,{liked:c,onClick:()=>{i.comment.id&&A("Instagram",{action:"toggleLike",data:{postId:i.comment.id,toggle:!c,isComment:!0}}).then(L=>{L&&(h(L.liked),m(L.likes))})}})]})},Te=i=>{const N=new Date(i),c=new Date().getTime()-N.getTime(),h=Math.floor(c/(1e3*60*60*24)),l=Math.floor(c/(1e3*60*60)),m=Math.floor(c/(1e3*60));let L="";return h<1?l<1?L=`${m}m`:L=`${l}h`:h<30?L=`${h}d`:L=`${N.getDate()}/${N.getMonth()+1}/${N.getFullYear()}`,L};function et(){var k,y,F;const{View:i}=s.useContext($),[N,S]=i,[c,h]=s.useState(0),[l,m]=s.useState([]),[L,w]=s.useState(""),[g,P]=s.useState(null),[t,p]=s.useState([]),[E,v]=s.useState(""),[u,T]=s.useState(0),[b,M]=s.useState(!1),[V,_]=s.useState(!1);s.useEffect(()=>{A("Camera",{action:"getImages",page:0,filter:{showVideos:!0,showPhotos:!0}}).then(n=>{n&&p(n)})},[]);const C=n=>{if(V||b)return;let d=document.querySelector("#last");if(!d)return;!Z(d)&&(M(!0),A("Camera",{action:"getImages",page:u+1,filter:{showVideos:!0,showPhotos:!0}}).then(f=>{f&&f.length>0?(p([...t,...f]),M(!1)):_(!0)}),T(f=>f+1))};return s.useEffect(()=>{E&&E.includes("data:image")||Ve(E,n=>{if(n){const d=document.querySelector(".searchbox input");d&&(d.value=""),t.find(I=>I.src===E)||p(I=>[{src:E},...I])}})},[E]),a("div",{className:"newpost-container","data-camera":!1,children:[c===0&&a(W,{children:[a("div",{className:"newpost-header",children:[e(ne,{onClick:()=>S("feed")}),e("div",{className:"title",children:r("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{l.length>0&&c==0&&h(1)},children:r("APPS.INSTAGRAM.NEXT")})]}),((F=(y=(k=ce)==null?void 0:k.value)==null?void 0:y.AllowExternal)==null?void 0:F.Instagram)&&e(ge,{placeholder:r("COMPONENTS.GALLERY.EXTERNAL_URL"),onChange:n=>v(n.target.value)}),e("div",{className:"newpost-body",onScroll:C,children:e("div",{className:"images",children:t.map((n,d)=>{let I=d===t.length-1?"last":"";return a("div",{id:I,className:"image",onClick:()=>{l.includes(n.src)?m(l.filter(o=>o!==n.src)):l.length<5&&m([...l,n.src])},children:[K(n.src)?e(tt,{src:n.src}):e("img",{src:n.src,alt:"image"}),e("div",{className:"select",children:e(Be,{checked:l.includes(n.src)})})]},d)})})})]}),c===1&&a(W,{children:[a("div",{className:"newpost-header",children:[e(ve,{onClick:()=>h(0)}),e("div",{className:"title",children:r("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{A("Instagram",{action:"newPost",data:{caption:L,location:g,images:l}}).then(n=>{n&&S("feed")})},children:r("APPS.INSTAGRAM.POST")})]}),e("div",{className:"newpost-body",children:a("div",{className:"newpost-content",children:[a("div",{className:"caption",children:[e("div",{className:"image",children:K(l[0])?e("video",{src:l[0],muted:!0}):e("img",{src:l[0],alt:"image"})}),e("div",{className:"text-area",children:e(Ce,{onChange:n=>w(n.target.value),placeholder:r("APPS.INSTAGRAM.CAPTION_PLACEHOLDER")})})]}),e("div",{className:"item",onClick:()=>{B.PopUp.set({title:"Choose Location",description:"Choose a location for your post",input:{type:"text",maxCharacters:30,onChange:n=>P(n)},buttons:[{title:"Cancel"},{title:"Proceed"}]})},children:g?a(W,{children:[a("div",{className:"label",children:[e(be,{}),g]}),e(ne,{onClick:n=>{n.stopPropagation(),P(null)}})]}):a(W,{children:[e("div",{className:"label",children:"Location"}),e(_e,{})]})})]})})]})]})}const tt=({src:i})=>{const[N,S]=s.useState(null);return a(W,{children:[e("video",{src:i,crossOrigin:"anonymous",controls:!1,onMouseOver:h=>h.currentTarget.play(),onMouseOut:h=>h.currentTarget.pause(),onLoadedMetadata:h=>S(h.currentTarget.duration)}),N&&e("div",{className:"video-duration",children:(h=>{const l=Math.floor(h/60),m=We(h-l*60,0);return`${l}:${m<10?"0"+m:m}`})(N)})]})};function at(){const{View:i,Post:N,GoBack:S}=s.useContext($),[c,h]=i,[l]=S,[m]=N;return e(W,{children:m&&e("div",{className:"viewpost-container",children:a(W,{children:[a("div",{className:"viewpost-header",children:[e(ve,{onClick:()=>{l&&(l.cb?l.cb():h(l.view))}}),e("div",{className:"name",children:m.username??"Unknown"}),e("span",{})]}),e("div",{className:"profile-body",children:e(we,{data:m})})]})})})}function st(){const{Func:i,Account:N,Dm:S,View:c,GoBack:h}=s.useContext($);te(ae.Settings);const[l]=N,[m,L]=c,[w,g]=S,[P,t]=h,[p,E]=s.useState([]),v=s.useRef(null),[u,T]=s.useState({content:"",attachments:[]}),[b,M]=s.useState(0),[V,_]=s.useState(!1),[C,k]=s.useState(!1);s.useEffect(()=>{_(!1),k(!1),M(0),E([]),A("Instagram",{action:"getMessages",page:0,username:w.username}).then(n=>{n&&E(n.reverse())})},[]),X("instagram:newMessage",n=>{if(w.username!==n.sender)return;E([...p,n]);let d=document.querySelector(".dm-body-container");d.scrollTop=d.scrollHeight});const y=()=>{u.content.length===0&&u.attachments.length===0||A("Instagram",{action:"sendMessage",username:w.username,message:{content:u.content,attachments:u.attachments.length>0?u.attachments:null}}).then(n=>{if(!n)return;v.current.value="",E([...p,{sender:l.username,recipient:w.username,content:u.content,attachments:u.attachments,timestamp:Date.now()}]),T({content:"",attachments:[]});let d=document.querySelector(".dm-body-container");d.scrollTop=d.scrollHeight})},F=()=>{if(V||C)return;let n=document.querySelector("#last");if(!n)return;!Z(n)&&(k(!0),A("Instagram",{action:"getMessages",page:b+1,username:w.username}).then(I=>{I&&I.length>0?(E([...I.reverse(),...p]),k(!1)):_(!0)}),M(I=>I+1))};return a("div",{className:"dm-container",children:[a("div",{className:"dm-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{P&&P.cb?(P.cb(),t(null)):L("dmList")}}),a("div",{className:"profile",onClick:n=>{n.stopPropagation(),t({cb:()=>{g(w),L("dm")}}),i.fetchAndSetProfile(w.username)},children:[e("div",{className:"avatar",children:e("img",{src:i.getAvatar(w.avatar)})}),a("div",{className:"username",children:[w.name??w.username,w.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]})]}),e("div",{className:"dm-body-container",onScroll:F,children:e("div",{className:"dm-body",children:p.map((n,d)=>{var R;let I,f=d===0,o=n.sender===l.username?"self":"other",O=((R=p[d+1])==null?void 0:R.sender)===l.username?"self":"other";return p[d+1]?I=Math.abs(n.timestamp-p[d+1].timestamp)/36e5:O=void 0,a("div",{className:`message ${o}`,id:f?"last":"",children:[o=="other"?a("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${o!==O?"show":"hide"}`,onClick:G=>{G.stopPropagation(),t({cb:()=>{g(w),L("dm")}}),i.fetchAndSetProfile(w.username)},children:e("img",{src:i.getAvatar(w.avatar)})}),a("div",{className:"message-content",children:[n.content&&e("div",{className:"content",children:re(n.content)}),n.attachments&&e("div",{className:"attatchments",children:n.attachments.map((G,H)=>K(G)?e("video",{src:G,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:j=>{B.FullscreenImage.set({display:!0,image:G})}},H):e(Se,{src:G,onClick:()=>{B.FullscreenImage.set({display:!0,image:G})}},H))})]})]}):a(W,{children:[n.content&&e("div",{className:"content",children:re(n.content)}),n.attachments&&e("div",{className:"attatchments",children:n.attachments.map((G,H)=>K(G)?e("video",{src:G,controls:!1,loop:!0,muted:!0,autoPlay:!0,onClick:j=>{B.FullscreenImage.set({display:!0,image:G})}},H):e("img",{src:G,onClick:()=>{B.FullscreenImage.set({display:!0,image:G})}},H))})]}),p[d+1]&&I>6?e("div",{className:"date",children:Ae(n.timestamp)}):o!==O&&e("div",{className:"date",children:Ae(n.timestamp)})]},d)})})}),e("div",{className:"attachments",children:u.attachments.map((n,d)=>a("div",{className:"attachment",children:[K(n)?e("video",{src:n,muted:!0,controls:!1,loop:!0,autoPlay:!0}):e(Se,{src:n}),e(ne,{onClick:()=>{T({...u,attachments:u.attachments.filter((I,f)=>f!==d)})}})]},d))}),a("div",{className:"dm-footer",children:[e(q,{type:"text",ref:v,onChange:n=>{T({...u,content:n.target.value})},onKeyDown:n=>{n.key==="Enter"&&y()},placeholder:r("APPS.INSTAGRAM.MESSAGE_PLACEHOLDER")}),u.content.length>0?e("span",{onClick:()=>y(),className:"send",children:r("APPS.INSTAGRAM.SEND")}):e(Fe,{onClick:()=>{var n,d,I;u.attachments.length<3&&B.Gallery.set({includeVideos:!0,allowExternal:(I=(d=(n=ce)==null?void 0:n.value)==null?void 0:d.AllowExternal)==null?void 0:I.Instagram,onSelect:f=>T({...u,attachments:[...u.attachments,f.src]})})}})]})]})}function nt(){const{View:i,Func:N,Dm:S,Account:c,GoBack:h}=s.useContext($),[l,m]=i,[L]=c,[w,g]=S,[P,t]=h,[p,E]=s.useState(!1),[v,u]=s.useState(""),[T,b]=s.useState(""),[M,V]=s.useState([]);s.useState([]);const[_,C]=s.useState([]),[k,y]=s.useState(0),[F,n]=s.useState(!1),[d,I]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getRecentMessages",page:0}).then(o=>{o&&C(o)})},[]);const f=()=>{if(F||d)return;let o=document.querySelector("#last");if(!o)return;!Z(o)&&(I(!0),A("Instagram",{action:"getRecentMessages",page:k+1}).then(R=>{R&&R.length>0?(C([..._,...R]),I(!1)):n(!0)}),y(R=>R+1))};return s.useEffect(()=>{const o=setTimeout(()=>u(T),500);return()=>clearTimeout(o)},[T]),s.useEffect(()=>{v.length>0?p?A("Instagram",{action:"search",query:v}).then(o=>{o&&V(o)}):V(_.filter(o=>{var O;return o.username.includes(v)||((O=o==null?void 0:o.name)==null?void 0:O.includes(v))&&o.username!==L.username})):V([])},[v]),s.useEffect(()=>{u(""),V([])},[p]),e("div",{className:"dm-list",children:p?a("div",{className:"slide up",children:[a("div",{className:"dm-list-header new",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{E(!1),V([])}}),e("div",{className:"title",children:r("APPS.INSTAGRAM.NEW_MESSAGE")}),e("span",{})]}),a("div",{className:"dm-list-body ",children:[a("div",{className:"input",children:[e("span",{children:r("APPS.INSTAGRAM.TO")}),e(q,{type:"text",onChange:o=>b(o.target.value),placeholder:r("SEARCH")})]}),M.length>0&&e("div",{className:"items",children:M.map((o,O)=>a("div",{className:"item",onClick:()=>{E(!1),g(o),m("dm")},children:[e("div",{className:"avatar",onClick:R=>{R.stopPropagation(),t({cb:()=>{m("dmList"),t(null)}}),N.fetchAndSetProfile(o.username)},children:e("img",{src:N.getAvatar(o.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[o.username,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"last-message",children:o.name})]})]},O))})]})]}):a(W,{children:[a("div",{className:"dm-list-header",children:[a("div",{className:"top",children:[e("i",{className:"far fa-chevron-left",onClick:()=>m("feed")}),e("i",{className:"far fa-edit",onClick:()=>E(!0)})]}),e(ge,{placeholder:r("SEARCH"),onChange:o=>b(o.target.value)})]}),e("div",{className:"dm-list-body",onScroll:f,children:e("div",{className:"items",children:v.length>0&&!p?M.map((o,O)=>{var R;return((R=o.content)==null?void 0:R.length)===0&&(o.content=r("APPS.INSTAGRAM.SENT_A_PHOTO")),a("div",{className:"item",onClick:()=>{E(!1),g(o),m("dm")},children:[e("div",{className:"avatar",onClick:G=>{G.stopPropagation(),t({cb:()=>{m("dmList"),t(null)}}),N.fetchAndSetProfile(o.username)},children:e("img",{src:N.getAvatar(o.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),a("div",{className:"last-message",children:[o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",se(o.timestamp)]})]})]},O)}):_.map((o,O)=>{let R=O===_.length-1;return o.content.length===0&&(o.content=r("APPS.INSTAGRAM.SENT_A_PHOTO")),a("div",{className:"item",id:R?"last":"",onClick:()=>{E(!1),g(o),m("dm")},children:[e("div",{className:"avatar",onClick:G=>{G.stopPropagation(),t({cb:()=>{m("dmList"),t(null)}}),N.fetchAndSetProfile(o.username)},children:e("img",{src:N.getAvatar(o.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",se(o.timestamp)]})]},O)})})})]})})}function it(){var I,f,o,O;const{Account:i,View:N,Func:S,Stories:c,Story:h,Dm:l}=s.useContext($),[m]=i,[L,w]=N,[g,P]=c,[t,p]=h,[E,v]=l,[u,T]=s.useState(0),[b,M]=s.useState(""),[V,_]=s.useState(!1),[C,k]=s.useState({x:0,y:0});s.useEffect(()=>{if(t){k(t.origin);for(let R=0;R<t.media.length;R++)if(!t.media[R].seen)return T(R)}},[]);const y=R=>{if(V)return _(!1);const G=R.target.getBoundingClientRect(),H=R.clientX-G.left;let j=t.media[u];if(j.seen||A("Instagram",{action:"viewedStory",id:j.id}),H<G.width/2)if(u>0)T(u-1);else{let D=g.findIndex(z=>z.username===t.username),x=g[D-1];x&&S.fetchAndSetStory(x)}else if(u<t.media.length-1)T(u+1);else{let D=g.findIndex(z=>z.username===t.username),x=g[D+1];x?(n(t.username),S.fetchAndSetStory(x),T(0)):d()}},F=()=>{!b||b===""||A("Instagram",{action:"sendMessage",username:t.username,message:{content:b}}).then(R=>{R&&(v({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),w("dm"),d())})},n=R=>{t.media.length===u+1&&P(G=>G.map(H=>(H.username===R&&(H.seen=!0),H)))},d=R=>{R!==!1&&n(t.username),p(null)};return a(fe.div,{className:"instagram-story",initial:{scale:0,transformOrigin:t!=null&&t.origin?`${((I=t==null?void 0:t.origin)==null?void 0:I.x)??0}px ${((f=t==null?void 0:t.origin)==null?void 0:f.y)??0}px`:"50% 50%"},animate:{scale:1,transformOrigin:t!=null&&t.origin?`${((o=t==null?void 0:t.origin)==null?void 0:o.x)??0}px ${((O=t==null?void 0:t.origin)==null?void 0:O.y)??0}px`:"50% 50%"},exit:{scale:0,transformOrigin:C?`${(C==null?void 0:C.x)??0}px ${(C==null?void 0:C.y)??0}px`:"50% 50%"},transition:{duration:.25,ease:"easeInOut"},children:[K(t==null?void 0:t.media[u].image)?e("video",{className:"background-image",onClick:y,autoPlay:!0,loop:!0,src:t==null?void 0:t.media[u].image}):e("div",{className:"background-image",onClick:y,style:{backgroundImage:`url(${t==null?void 0:t.media[u].image})`}}),e(ue,{children:V&&e(rt,{activeImage:u,close:()=>_(!1)})}),a("div",{className:"story-wrapper",children:[a("div",{className:"story-header",children:[e("div",{className:"story-steps",children:t==null?void 0:t.media.map((R,G)=>e("div",{className:u===G?"active":"",onClick:()=>T(G)},G))}),a("div",{className:"profile-details",children:[a("div",{className:"profile",onClick:()=>S.fetchAndSetProfile(t.username),children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${S.getAvatar(t==null?void 0:t.avatar)})`}}),a("div",{className:"name",children:[t==null?void 0:t.username,!1]}),e("div",{className:"time",children:se(t==null?void 0:t.media[u].timestamp)})]}),e("div",{className:"stats",children:e(ne,{onClick:()=>{if(t!=null&&t.media[u].seen)return d();A("Instagram",{action:"viewedStory",id:t==null?void 0:t.media[u].id}).then(R=>d())}})})]})]}),(t==null?void 0:t.username)===m.username?a("div",{className:"story-footer","data-stats":!0,children:[a("div",{className:"seen-by",onClick:()=>_(!0),children:[(t==null?void 0:t.media[u].viewers)&&e("div",{className:"images",children:t==null?void 0:t.media[u].viewers.map((R,G)=>e("img",{src:S.getAvatar(R.avatar)},G))}),r("APPS.INSTAGRAM.SEEN_BY").format({count:$e(t==null?void 0:t.media[u].views)??0})]}),e(ne,{onClick:()=>{B.PopUp.set({title:r("APPS.INSTAGRAM.DELETE_STORY.TITLE"),description:r("APPS.INSTAGRAM.DELETE_STORY.DESCRIPTION"),buttons:[{title:r("APPS.INSTAGRAM.DELETE_STORY.CANCEL")},{title:r("APPS.INSTAGRAM.DELETE_STORY.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"removeFromStory",id:t==null?void 0:t.media[u].id}).then(R=>{if(!R)return me("error","Failed to remove image from story");me("info","Removed image from story"),p(null),t.media.length===1&&P(G=>G.filter(H=>H.username!==t.username))})}}]})}})]}):a("div",{className:"story-footer",children:[e("div",{className:"input",children:e(q,{type:"text",placeholder:r("APPS.INSTAGRAM.SEND_A_MESSAGE"),onChange:R=>M(R.target.value),onKeyDown:R=>{R.key==="Enter"&&F()}})}),e(De,{onClick:()=>F()})]})]})]})}const rt=i=>{var v;const{Func:N,Story:S}=s.useContext($),[c,h]=S,[l,m]=s.useState([]),[L,w]=s.useState(0),[g,P]=s.useState(!1),[t,p]=s.useState(!1);s.useEffect(()=>{(i==null?void 0:i.activeImage)!==void 0&&A("Instagram",{action:"getViewers",id:c==null?void 0:c.media[i.activeImage].id,page:0}).then(u=>{u&&(m(u),u.length<15&&P(!0))})},[]);const E=u=>{if(g||t)return;let T=document.querySelector("#last");if(!T)return;!Z(T)&&(p(!0),A("Instagram",{action:"getViewers",id:c==null?void 0:c.media[i.activeImage].id,page:L+1}).then(M=>{M&&M.length>0?(m(V=>[...V,...M]),p(!1),M.length<15&&P(!0)):P(!0)}),w(M=>M+1))};return a(fe.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[a("div",{className:"story-modal-header",children:[a("div",{className:"views",children:[e(Ie,{})," ",e("div",{className:"views",children:((v=c==null?void 0:c.media[i==null?void 0:i.activeImage])==null?void 0:v.views)??0})]}),e(ne,{className:"close",onClick:i==null?void 0:i.close})]}),a("div",{className:"story-modal-content",children:[e("div",{className:"title",children:r("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",onScroll:E,children:l.map((u,T)=>{let b=T===l.length-1?"last":"";return e("div",{className:"item",id:b,children:a("div",{className:"user",onClick:()=>{N.fetchAndSetProfile(u.username),h(null)},children:[e("div",{className:"profile-picture",children:e("img",{src:N.getAvatar(u.avatar)})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[u.username,u.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:u.name})]})]})},T)})})]})]})};function ct(){var L;const{Func:i,View:N,Account:S}=s.useContext($),c=te(ae.Settings),[h,l]=N,[m]=S;return e("div",{className:"instagram-footer",children:a(W,{children:[e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("feed"),children:e("g",{children:h=="feed"?e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M22 23h-6.001a1 1 0 01-1-1v-5.455a2.997 2.997 0 10-5.993 0V22a1 1 0 01-1 1H2a1 1 0 01-1-1V11.543a1.002 1.002 0 01.31-.724l10-9.543a1.001 1.001 0 011.38 0l10 9.543a1.002 1.002 0 01.31.724V22a1 1 0 01-1 1z"}):e("path",{d:"M9.005 16.545a2.997 2.997 0 012.997-2.997h0A2.997 2.997 0 0115 16.545V22h7V11.543L12 2 2 11.543V22h7.005z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("search"),children:h=="search"?e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M13.173 13.164l1.491-3.829-3.83 1.49zM12.001.5a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012.001.5zm5.35 7.443l-2.478 6.369a1 1 0 01-.57.569l-6.36 2.47a1 1 0 01-1.294-1.294l2.48-6.369a1 1 0 01.57-.569l6.359-2.47a1 1 0 011.294 1.294z"}):a(W,{children:[e("polygon",{fill:"none",points:"13.941 13.953 7.581 16.424 10.06 10.056 16.42 7.585 13.941 13.953",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("polygon",{fillRule:"evenodd",points:"10.06 10.056 13.949 13.945 7.581 16.424 10.06 10.056"}),e("circle",{cx:"12.001",cy:"12.005",fill:"none",r:"10.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("newPost"),children:a(W,{children:[e("path",{d:"M2 12v3.45c0 2.849.698 4.005 1.606 4.944.94.909 2.098 1.608 4.946 1.608h6.896c2.848 0 4.006-.7 4.946-1.608C21.302 19.455 22 18.3 22 15.45V8.552c0-2.849-.698-4.006-1.606-4.945C19.454 2.7 18.296 2 15.448 2H8.552c-2.848 0-4.006.699-4.946 1.607C2.698 4.547 2 5.703 2 8.552z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"6.545",x2:"17.455",y1:"12.001",y2:"12.001"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"12.003",x2:"12.003",y1:"6.545",y2:"17.455"})]})}),h==="notifications"?e("svg",{fill:"#262626",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{fill:c.display.theme=="dark"&&"#fafafa",d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{color:((L=c==null?void 0:c.display)==null?void 0:L.theme)==="dark"?"#ffffff":"#262626",fill:c.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>l("notifications"),children:e("path",{color:c.display.theme=="dark"&&"#fafafa",d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})}),e("img",{src:i.getAvatar(m.avatar),className:"profile",alt:"profile",onClick:()=>i.fetchAndSetProfile(m.username)})]})})}function lt(){const{Account:i,UserPanel:N,GoBack:S}=s.useContext($),[c,h]=N,[l,m]=s.useState([]),[L,w]=s.useState(0),[g,P]=s.useState(!1),[t,p]=s.useState(!1);let E={[r("APPS.INSTAGRAM.FOLLOWING")]:"getFollowing",[r("APPS.INSTAGRAM.FOLLOWERS")]:"getFollowers",[r("APPS.TWITTER.LIKED_BY")]:"getLikes"};s.useEffect(()=>{A("Instagram",{action:E[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:0}}).then(u=>{u&&m(u)})},[]);const v=()=>{if(g||t)return;!Z(document.querySelector("#last"))&&(p(!0),A("Instagram",{action:E[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:L+1}}).then(T=>{T&&T.length>0?(m([...l,...T]),p(!1)):P(!0)}),w(T=>T+1))};return e(W,{children:c.data&&l&&a("div",{className:"userpanel-container",children:[a("div",{className:"userpanel-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{var u;(u=c.data)==null||u.cb()}}),e("div",{className:"userpanel-title",children:c.data.title}),e("span",{})]}),e("div",{className:"userpanel-body",onScroll:v,children:e("div",{className:"items",children:l.map((u,T)=>{let b=T===l.length-1;return e(ot,{data:u,allData:c.data,last:b},T)})})})]})})}const ot=i=>{const{Func:N,Account:S,GoBack:c,UserPanel:h}=s.useContext($),[l]=S,[m,L]=c,[w,g]=h;let P=i.data,t=i.last;const[p,E]=s.useState(P.isFollowing===1);return a("div",{className:"item",id:t?"last":"",onClick:()=>{L({cb:()=>{g({display:!0,data:i.allData})}}),N.fetchAndSetProfile(P.username)},children:[a("div",{className:"user",children:[e("div",{className:"profile-picture",children:e("img",{src:N.getAvatar(P.avatar),alt:"profile"})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[P.username,P.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:P.name})]})]}),l.username!==P.username&&e("div",{className:"action",onClick:v=>{v.stopPropagation(),P.username!==l.username&&(p?B.PopUp.set({title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:P.username}),buttons:[{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:r("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:P.username,following:!p}}).then(()=>{E(u=>!u)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:P.username,following:!p}}).then(()=>{E(u=>!u)}))},children:p?e("div",{className:"button following",children:r("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",children:r("APPS.INSTAGRAM.FOLLOW")})})]})},$=s.createContext(null);function St(){const{Func:i}=s.useContext(Ue),N=te(ae.Settings),S=te(ae.App),[c,h]=i.TextColor,[l,m]=s.useState("feed"),[L,w]=s.useState(null),[g,P]=s.useState(!1),[t,p]=s.useState([]),[E,v]=s.useState(null),[u,T]=s.useState(null),[b,M]=s.useState(null),[V,_]=s.useState(null),[C,k]=s.useState(null),[y,F]=s.useState(null),[n,d]=s.useState({display:!1,data:null}),[I,f]=s.useState(!0);s.useEffect(()=>{var D;S&&(S==null?void 0:S.view)==="profile"&&O((D=S==null?void 0:S.data)==null?void 0:D.username)},[S]),s.useEffect(()=>{A("isAdmin").then(D=>{if(Q.APPS.INSTAGRAM.account.value){w({...Q.APPS.INSTAGRAM.account.value,isAdmin:D}),P(!0),f(!1);return}else if(Q.APPS.INSTAGRAM.account.value===!1)return f(!1);A("Instagram",{action:"isLoggedIn"}).then(x=>{x?(Q.APPS.INSTAGRAM.account.set(x),w({...x,isAdmin:D}),P(!0),f(!1)):(f(!1),Q.APPS.INSTAGRAM.account.set(null),console.log("setting loadign to false?"))})})},[]),s.useEffect(()=>(setTimeout(()=>{l==="live"||l==="newPost"||l==="story"?(h("#fafafaed"),l=="live"&&B.IndicatorVisible.set(!1)):(h(N.display.theme==="dark"?"#fafafaed":"#000000"),B.IndicatorVisible.set(!0)),l==="dm"?ie.ReceiveAppNotifications.set(!1):ie.ReceiveAppNotifications.set(!0)},250),()=>{ie.ReceiveAppNotifications.set(!0)}),[l]);const o=(D,x)=>{D&&A("Instagram",{action:"getPost",id:D}).then(z=>{if(z){if(x)return R(z);k(z),m("post")}})},O=D=>{D&&A("Instagram",{action:"getProfile",username:D}).then(x=>{x&&(T(x),m("profile"))})},R=D=>{D.id&&A("Instagram",{action:"getComments",postId:D.id,page:0}).then(x=>{x&&(_({post:D,comments:x}),m("comments"))})},G=(D,x,z)=>{!D&&!(D!=null&&D.username)||((x==null?void 0:x.length)==0&&(x=void 0),A("Instagram",{action:"getStory",username:D.username}).then(le=>{le&&v({username:D.username,avatar:D.avatar,verified:D.verified,media:le,queue:x,origin:z})}))},H=D=>D||"./assets/img/icons/instagram/unknown-pfp.jpg",j={feed:e(Ye,{}),search:e(Je,{}),notifications:e(Xe,{}),profile:e(Ke,{}),live:e(je,{}),logIn:e(Pe,{}),comments:e(Qe,{}),post:e(at,{}),newPost:e(et,{}),userpanel:e(lt,{}),dmList:e(nt,{}),dm:e(st,{})};return s.useEffect(()=>{n.display&&m("userpanel")},[n]),e("div",{className:"instagram-container",children:e($.Provider,{value:{View:[l,m],Account:[L,w],Profile:[u,T],Post:[C,k],Comments:[V,_],LoggedIn:[g,P],GoBack:[y,F],UserPanel:[n,d],Dm:[b,M],Stories:[t,p],Story:[E,v],Func:{fetchAndSetProfile:O,fetchAndSetStory:G,fetchAndSetComments:R,fetchAndSetPost:o,getAvatar:H}},children:I||N.airplaneMode?e("div",{className:"loading",children:e(xe,{size:40,lineWeight:5,speed:2,color:c})}):e("div",{className:"instagram-wrapper",children:g?a(W,{children:[e(ue,{children:E&&e(it,{})}),j[l],l!=="live"&&l!=="logIn"&&l!=="newPost"&&l!=="comments"&&!E&&e(ct,{})]}):e(Pe,{})})})})}export{$ as InstagramContext,St as default};
