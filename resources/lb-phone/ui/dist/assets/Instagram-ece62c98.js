import{j as e,F as W,r as s,a}from"./jsx-runtime-7cf68bf7.js";import{b as te,c as se,u as X,O as q,f as A,aw as Le,C as H,L as i,X as ie,E as Re,ay as Me,h as ce,bv as Pe,W as Z,aA as Oe,$ as de,S as ne,b4 as ye,K as me,j as K,a2 as ue,bs as pe,Q as re,t as Q,a7 as ae,aa as Ie,bw as Ge,d as he,w as ge,M as Ce,bx as Ve,Z as Ne,_ as Se,at as _e,by as be,D as Fe}from"./Phone-e1d97322.js";import{r as De}from"./number-28525126.js";import{C as Ue}from"./Check-37e2af20.js";import{formatNumber as xe}from"./Tiktok-d12963e0.js";import{a as We}from"./DotSpinner-72042ec1.js";import"./Switch-2d40ebe4.js";import"./Slider-f6390f5d.js";function Ee(n){const P=te(se.Settings);return e(W,{children:n.liked?e("svg",{onClick:n.onClick,color:"#ed4956",fill:"#ed4956",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{onClick:n.onClick,color:P.display.theme==="dark"?"#ffffff":"#262626",fill:P.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})})})}function we(n){const{Account:P,View:I,Func:l,UserPanel:v}=s.useContext(B),r=te(se.Settings),[f]=P,[L,w]=I,[g,p]=v,[t,E]=s.useState(n.data),k=s.useRef(null);s.useRef(null);const[N,m]=s.useState(0),[T,b]=s.useState(!1),M={pos:{startLeft:0,startX:0},onMouseDown:c=>{M.pos={startLeft:k.current.scrollLeft,startX:c.clientX},k.current.style.userSelect="none",document.addEventListener("mouseup",M.onMouseUp),document.addEventListener("mousemove",M.onMove)},onMove:c=>{const S=(c.clientX-M.pos.startX)/Me(r.display.size);k.current.scrollLeft=M.pos.startLeft-S;const u=k.current.getBoundingClientRect();(u.left-5>c.clientX||c.clientX>u.right-5)&&M.onMouseUp()},onMouseUp:()=>{k.current.style.removeProperty("user-select"),document.removeEventListener("mouseup",M.onMouseUp),document.removeEventListener("mousemove",M.onMove);const c=JSON.parse(t.media),S=k.current.clientWidth;let u=N;const G=k.current.scrollLeft-M.pos.startLeft;G>S/2&&u<c.length-1?u++:G<-S/2&&u>0&&u--,_(u)}},_=c=>{k.current.scrollTo({left:c*k.current.offsetWidth,behavior:"smooth"}),m(c)};X("instagram:setLikes",c=>{c.postId!==t.id||c.isComment||E({...t,like_count:c.likes})});const F=c=>{if(c.detail===2){if(!t.id)return;t.liked||A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(S=>{E({...t,liked:S.liked,like_count:S.likes})}),b(!0),setTimeout(()=>{b(!1)},1e3)}};return a("div",{className:"post",id:n.last?"last":"",children:[a("div",{className:"post-header",children:[e("img",{className:"profile-picture",onClick:()=>{l.fetchAndSetProfile(t.username)},src:l.getAvatar(t.avatar)}),a("div",{className:"name",onClick:()=>l.fetchAndSetProfile(t.username),children:[t.username,t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),a("div",{className:"post-body",children:[T&&e("div",{className:`popup-heart ${T?"show":"hide"}`,children:e("svg",{color:"#e3e3e3",fill:"#e3e3e3",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})})}),e("div",{className:"image-container",ref:k,onMouseDown:M.onMouseDown,children:JSON.parse(t.media).map((c,S)=>e("div",{className:"image",onClick:F,children:q(c)?e("video",{src:c,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:c})},S))}),a("div",{className:"actions",children:[a("div",{className:"like-comment",children:[e(Ee,{liked:t.liked,onClick:()=>{t.id&&A("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(c=>{E({...t,liked:c.liked,like_count:c.likes})})}}),e("svg",{onClick:()=>l.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp}),color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M20.656 17.008a9.993 9.993 0 10-3.59 3.615L22 22z",fill:"none",stroke:"currentColor",strokeWidth:"2px"})}),(t.username===f.username||f.isAdmin)&&e(Le,{onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.TITLE"),description:i("APPS.INSTAGRAM.DELETE_POST_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"deletePost",id:t.id}).then(c=>{c&&w("feed")})}}]})}})]}),JSON.parse(t.media).length>1&&e("div",{className:"scroll-dots",children:JSON.parse(t.media).map((c,S)=>e("div",{className:`dot ${N==S?"active":""}`,onClick:()=>_(S)},S))})]}),a("div",{className:"liked-by",onClick:()=>{p({display:!0,data:{title:i("APPS.INSTAGRAM.LIKED_BY"),postId:t.id,cb:()=>{w("feed")}}})},children:[t.like_count," ",i("APPS.INSTAGRAM.LIKES")]}),a("div",{className:"caption",children:[e("span",{className:"user",onClick:c=>{c.stopPropagation(),l.fetchAndSetProfile(t.username)},children:t.username}),ie(t.caption)," "]}),e("div",{className:"comments",onClick:c=>{c.stopPropagation(),l.fetchAndSetComments({id:t.id,username:t.username,avatar:t.avatar,verified:t.verified,caption:t.caption,timestamp:t.timestamp})},children:t.comment_count>0?i("APPS.INSTAGRAM.VIEW_ALL_COMMENTS").format({count:t.comment_count}):i("APPS.INSTAGRAM.FIRST_COMMENT")}),e("div",{className:"date",children:Re(t.timestamp)})]})]})}function Be(){const{Account:n,View:P,Func:I,Stories:l}=s.useContext(B),[v,r]=P,[f]=n,[L,w]=s.useState([]),[g,p]=s.useState([]),[t,E]=l,[k,N]=s.useState(0),[m,T]=s.useState(!1),[b,M]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getPosts",filters:{following:!0},page:0}).then(c=>{c&&w(c)})},[]),s.useEffect(()=>{v==="feed"&&(A("Instagram",{action:"getLives"}).then(c=>{c&&p(c)}),A("Instagram",{action:"getStories"}).then(c=>{c&&E([...c.sort((S,u)=>{if(S.seen===u.seen)return 0;if(S.seen===1)return 1;if(u.seen===1)return-1})])}))},[v]);const _=()=>{if(m||b)return;let c=document.querySelector("#last");if(!c)return;!Z(c)&&(M(!0),A("Instagram",{action:"getPosts",filters:{following:!0},page:k+1}).then(u=>{u&&u.length>0?(w([...L,...u]),M(!1)):T(!0)}),N(u=>u+1))};s.useEffect(()=>{const c=document.querySelector(".stories");c.addEventListener("wheel",S=>{S.preventDefault(),c.scrollLeft+=S.deltaY})},[]),X("instagram:updateLives",c=>{c&&p(c)});const F=()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.TITLE"),description:i("APPS.INSTAGRAM.GO_LIVE_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"goLive",user:{username:f.username,avatar:I.getAvatar(f==null?void 0:f.avatar),verified:f.verified}}),r("live")}}]})};return a(W,{children:[a("div",{className:"instagram-header feed-header",children:[a("div",{className:"name",children:[f.username,f.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),a("svg",{onClick:()=>r("dmList"),color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[e("line",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2",x1:"22",x2:"9.218",y1:"3",y2:"10.083"}),e("polygon",{fill:"none",points:"11.698 20.334 22 3.001 2 3.001 9.218 10.084 11.698 20.334",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})]})]}),a("div",{className:"feed",onScroll:_,children:[e("div",{className:"stories-wrapper",children:a("div",{className:"stories",children:[a("div",{className:"story self",onClick:()=>{H.ContextMenu.set({buttons:[{title:i("APPS.INSTAGRAM.GO_LIVE"),cb:()=>{F()}},{title:i("APPS.INSTAGRAM.CREATE_STORY"),cb:()=>{var c,S,u;H.Gallery.set({includeVideos:!0,allowExternal:(u=(S=(c=ce)==null?void 0:c.value)==null?void 0:S.AllowExternal)==null?void 0:u.Instagram,onSelect:G=>{A("Instagram",{action:"addToStory",media:G.src}).then(d=>{d&&E([{username:f.username,avatar:f.avatar,verified:f.verified,seen:0,id:d},...t.filter(h=>h.username!==f.username)])})}})}}]})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${I.getAvatar(f==null?void 0:f.avatar)})`},children:e("div",{className:"plus",children:e("i",{className:"far fa-plus"})})}),e("div",{className:"name",children:i("APPS.INSTAGRAM.YOUR_STORY")})]}),Object.keys(g).map((c,S)=>{var u;return a("div",{className:"story",onClick:()=>{A("Instagram",{action:"viewLive",username:c}),r("live")},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${I.getAvatar((u=g[c])==null?void 0:u.avatar)})`},children:e("img",{className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"})}),e("div",{className:"name",children:c})]},S)}),t.map((c,S)=>a("div",{className:"story",onClick:u=>{let[G,d]=Pe(u);I.fetchAndSetStory(c,null,{x:G,y:d})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${I.getAvatar(c==null?void 0:c.avatar)})`},children:e("img",{className:"circle","data-seen":c.seen===1,src:"./assets/img/icons/instagram/StoryCircle.png"})}),e("div",{className:"name",children:c.username})]},S))]})}),L.length===0&&e("div",{className:"no-posts",children:i("APPS.INSTAGRAM.EMPTY_FEED")}),L.map((c,S)=>{let u=S===L.length-1;return e(we,{data:c,last:u},S)})]})]})}function $e(){const{View:n,Account:P,Func:I}=s.useContext(B),[l,v]=n,[r]=P,f=te(ce),[L,w]=s.useState(""),[g,p]=s.useState(!1),[t,E]=s.useState(!1),k=s.useRef(null),[N,m]=s.useState({id:null,user:{username:"",avatar:"",verified:!1},viewers:0}),T=s.useRef(null),b=s.useRef(null),M=s.useRef(null),[_,F]=s.useState([]),[c,S]=s.useState([]),[u,G]=s.useState(null);s.useEffect(()=>{b.current.scrollTop=b.current.scrollHeight},[c]),s.useEffect(()=>{if(!u||M.current)return;let C=new Oe(u);M.current=C,C.resizeByAspect(3/4);const o=window.innerWidth;o>1280&&C.setQuality(1280/o)},[u]),s.useEffect(()=>()=>{M.current&&M.current.destroy()},[]),s.useEffect(()=>{const C=N;if(!(C!=null&&C.id)||!T.current||g)return;const o=f.ice?new de({config:{iceTransportPolicy:"relay",iceServers:f.ice}}):new de;o.on("open",()=>{const O=document.createElement("canvas");O.width=5,O.height=5;const R=O.captureStream(0),V=o.call(C.id,R);F([..._,V]),V.on("close",()=>{O.remove()}),V.on("error",()=>{O.remove()}),V.on("stream",$=>{const Y=T.current;Y.onloadeddata=()=>{Y.play()},Y.srcObject=$,A("Instagram",{action:"addCall",id:V.connectionId,username:r.username})})})},[T.current,N.user]),s.useEffect(()=>{if(p(r.username===(N==null?void 0:N.user.username)),(N==null?void 0:N.user.username)!==r.username||!u)return;const C=f.ice?new de({config:{iceTransportPolicy:"relay",iceServers:f.ice}}):new de;C.on("open",O=>{A("Instagram",{action:"setLive",username:r.username,verified:r.verified,id:O})});const o=u.captureStream(24);C.on("call",O=>{O.answer(o),O.on("close",()=>{F(_.filter(R=>R.connectionId!==O.connectionId))}),F([..._,O])})},[N,u]);const d=()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.END_LIVE_POPUP.TITLE"),description:i("APPS.INSTAGRAM.END_LIVE_POPUP.DESCRIPTION").format({action:(g?i("APPS.INSTAGRAM.END_LIVE_POPUP.END"):i("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE")).toLowerCase()}),buttons:[{title:i("APPS.INSTAGRAM.END_LIVE_POPUP.CANCEL")},{title:g?i("APPS.INSTAGRAM.END_LIVE_POPUP.END"):i("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE"),color:"red",cb:()=>{ne.ShouldClose.set(!0),y(!0)}}]})},h=()=>{A("Instagram",{action:"sendLiveMessage",data:{user:{username:r.username,avatar:r.avatar,verified:r.verified},live:N.user.username,content:L}}),w("")},y=(C,o)=>{if(g)A("Instagram",{action:"endLive",username:r.username}).then(()=>{v("feed")});else if(A("Instagram",{action:"stopViewing",username:N.user.username}),C)ne.ShouldClose.set(!0),m({...N,ended:!0});else{if(o===!1)return;v("feed")}_.forEach(O=>{O.close()}),F([])};return X("instagram:addMessage",C=>{C.live===N.user.username&&S([...c,C])}),X("instagram:updateViewers",C=>{C.username===(N==null?void 0:N.user.username)&&m({...N,viewers:C.viewers})}),X("instagram:setLive",C=>{m(C),ne.ShouldClose.set(!1)}),X("instagram:liveEnded",C=>{C===(N==null?void 0:N.user.username)&&y(!0)}),X("instagram:stopLive",()=>{v("feed")}),X("instagram:endCall",C=>{_.forEach(o=>{o.connectionId===C&&o.close()}),F(_.filter(o=>o.connectionId!==C))}),a(W,{children:[e("div",{className:"instagram-stream",children:g?e("canvas",{ref:C=>G(C)}):e("video",{ref:T})}),N.ended&&a("div",{className:"instagram-stream-ended",children:[e(ye,{onClick:()=>v("feed")}),e("div",{className:"title",children:i("APPS.INSTAGRAM.LIVE_ENDED")})]}),e(me,{children:t&&e(He,{username:N.user.username,owner:g,endLive:y,close:()=>E(!1)})}),a("div",{className:"instagram-live",children:[a("div",{className:"live-header",children:[a("div",{className:"profile",onClick:()=>{g||(y(),I.fetchAndSetProfile(N.user.username))},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${N.user.avatar?N.user.avatar:"./assets/img/icons/instagram/unknown-pfp.jpg"})`}}),a("div",{className:"name",children:[N.user.username.length>12?N.user.username.substring(0,12)+"...":N.user.username,N.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),a("div",{className:"stats",children:[e("div",{className:"live",children:i("APPS.INSTAGRAM.LIVE")}),a("div",{className:"viewers",onClick:()=>E(!0),children:[e("i",{className:"fas fa-eye"}),N.viewers]}),e("i",{className:"far fa-times x",onClick:()=>{g?d():y(!1)}})]})]}),a("div",{className:"comment-section",children:[e("div",{className:"comment-feed",ref:b,children:c.map((C,o)=>{let O=C.user.avatar??"./assets/img/icons/instagram/unknown-pfp.jpg";return a("div",{className:"comment",children:[e("img",{src:O}),a("div",{className:"info",children:[a("div",{className:"name",children:[C.user.username,C.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"comment-text",children:C.content})]})]},o)})}),a("div",{className:"comment-input",children:[e(K,{type:"text",ref:k,placeholder:i("APPS.INSTAGRAM.COMMENT_PLACEHOLDER"),onChange:C=>w(C.target.value),onKeyDown:C=>{C.key==="Enter"&&L.replace(/ /g,"").length>0&&(h(),k.current.value="")}}),e("i",{className:"far fa-paper-plane",onClick:()=>{L.replace(/ /g,"").length>0&&(h(),k.current.value="")}}),g&&e("i",{className:"fas fa-repeat",onClick:()=>{A("Instagram",{action:"flipCamera"})}})]})]})]})]})}const He=n=>{const{Func:P}=s.useContext(B),[I,l]=s.useState([]);return s.useEffect(()=>{A("Instagram",{action:"getLiveViewers",username:n.username}).then(v=>{v&&l(v)})},[]),a(ue.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[a("div",{className:"story-modal-header",children:[a("div",{className:"views",children:[e(pe,{})," ",e("div",{className:"views",children:I.length})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),a("div",{className:"story-modal-content",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",children:I.map((v,r)=>{let f=r===I.length-1?"last":"";return e("div",{className:"item",id:f,children:a("div",{className:"user",onClick:()=>{n.owner||(n.endLive(!1,!1),P.fetchAndSetProfile(v.username))},children:[e("div",{className:"profile-picture",children:e("img",{src:P.getAvatar(v.avatar)})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[v.username,v.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:v.name})]})]})},r)})})]})]})};function Ae(){const{View:n,Account:P,LoggedIn:I}=s.useContext(B),l=te(se.Settings),[v,r]=s.useState(""),[f,L]=s.useState(""),[w,g]=s.useState(""),[p,t]=s.useState(!1),[E,k]=s.useState(!1),[N,m]=s.useState(!1),[T,b]=n,[M,_]=P,[F,c]=I,[S,u]=s.useState("login"),G=()=>{t(!1),k(!1),A("Instagram",{action:"logIn",username:f,password:w}).then(h=>{h.success&&h.account?(k(!1),t(!1),A("isAdmin").then(y=>{Q.APPS.INSTAGRAM.account.set(h.account),_({...h.account,isAdmin:y}),b("feed"),c(!0)})):h.error=="no account"?t(!0):h.error=="wrong password"?k(!0):console.log("Unknown error, please contact support with: Instagram LogIn.jsx onLogIn:43 [ALREADY LOGGED IN]",h==null?void 0:h.error)})},d=()=>{let h=f.toLowerCase().replace(/\s/g,"");h.length<3||h.length>15||A("Instagram",{action:"createAccount",name:v,username:h,password:w}).then(y=>{y.success?(k(!1),t(!1),A("isAdmin").then(C=>{let o={name:v,username:h,posts:0,followers:0,following:0};Q.APPS.INSTAGRAM.account.set(o),_({...o,isAdmin:C}),b("feed"),c(!0)})):console.log("couldn't create account",y)})};return s.useEffect(()=>{k(!1),t(!1)},[S]),e("div",{className:"log-in",children:a(W,{children:[e("div",{className:"wrapper",children:S==="login"?a(W,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":l.display.theme}),a("div",{className:"form",children:[e(K,{placeholder:i("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:h=>L(h.target.value.replace(/\s/g,"")),maxLength:15}),p&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.NO_ACCOUNT")}),e(K,{placeholder:i("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:h=>g(h.target.value),maxLength:50}),E&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.WRONG_USERNAME_OR_PASSWORD")}),e("div",{className:"button",onClick:G,children:i("APPS.INSTAGRAM.LOG_IN")})]})]}):a(W,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":l.display.theme}),a("div",{className:"form",children:[e(K,{placeholder:i("APPS.INSTAGRAM.NAME_PLACEHOLDER"),type:"text",onChange:h=>r(h.target.value),maxLength:20}),e(K,{placeholder:i("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:h=>L(h.target.value.replace(/\s/g,"")),maxLength:15}),N&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.ACCOUNT_WITH_USERNAME")}),e(K,{placeholder:i("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:h=>g(h.target.value),maxLength:50}),e("div",{className:"button",onClick:d,children:i("APPS.INSTAGRAM.CREATE_ACCOUNT")})]})]})}),e("div",{className:"footer",children:S==="login"?a(W,{children:[i("APPS.INSTAGRAM.NOT_HAVE_ACCOUNT")," ",e("span",{onClick:()=>u("createAccount"),children:i("APPS.INSTAGRAM.CREATE_ACCOUNT")})]}):a(W,{children:[i("APPS.INSTAGRAM.HAVE_ACCOUNT")," ",e("span",{onClick:()=>u("login"),children:i("APPS.INSTAGRAM.LOG_IN")})]})})]})})}function je(){const[n,P]=s.useState([]),[I,l]=s.useState(0),[v,r]=s.useState(!1),[f,L]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getNotifications"}).then(g=>{g&&P(g)})},[]);const w=()=>{if(v||f)return;let g=document.querySelector("#last");if(!g)return;!Z(g)&&(L(!0),A("Instagram",{action:"getNotifications",page:I+1}).then(t=>{t&&t.length>0?(P([...n,...t]),L(!1)):r(!0)}),l(t=>t+1))};return a("div",{className:"notifications-container",children:[e("div",{className:"notifications-header",children:i("APPS.INSTAGRAM.ACTIVITY")}),e("div",{className:"notifications-body",onScroll:w,children:n.map((g,p)=>{let t=p===n.length-1?"last":"";return e(Ye,{notification:g,last:t},p)})})]})}const Ye=({notification:n,last:P})=>{const{Account:I,Func:l}=s.useContext(B),[v]=I,[r,f]=s.useState(n.isFollowing);switch(n.type){case"like_photo":return a("div",{className:"notification-item",id:P,onClick:()=>l.fetchAndSetPost(n.postId),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:w=>{w.stopPropagation(),l.fetchAndSetProfile(n.username)}}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.LIKED_PHOTO"),e("span",{className:"date",children:ae(n.timestamp)})]})]}),q(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"like_comment":return e("div",{className:"notification-item",id:P,onClick:()=>l.fetchAndSetPost(n.postId,!0),children:a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:w=>{w.stopPropagation(),l.fetchAndSetProfile(n.username)}}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.LIKED_COMMENT").format({comment:n.comment}),e("span",{className:"date",children:ae(n.timestamp)})]})]})});case"comment":return a("div",{className:"notification-item",id:P,onClick:()=>l.fetchAndSetPost(n.postId,!0),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:w=>{w.stopPropagation(),l.fetchAndSetProfile(n.username)}}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.COMMENTED").format({comment:n.comment}),e("span",{className:"date",children:ae(n.timestamp)})]})]}),q(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"follow":return a("div",{className:"notification-item",id:P,onClick:()=>l.fetchAndSetProfile(n.username),children:[a("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:()=>l.fetchAndSetProfile(n.username)}),a("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.FOLLOWED"),e("span",{className:"date",children:ae(n.timestamp)})]})]}),e("div",{className:`button ${r?"following":"follow"}`,onClick:w=>{w.stopPropagation(),v.username!==n.username&&(r?H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:n.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:n.username,following:!r}}).then(()=>{f(g=>!g)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:n.username,following:!r}}).then(()=>{f(g=>!g)}))},children:r?i("APPS.INSTAGRAM.FOLLOWING"):i("APPS.INSTAGRAM.FOLLOW")})]})}};function ze(){const{View:n,Profile:P,Account:I,Func:l,GoBack:v,Post:r,UserPanel:f,LoggedIn:L,Dm:w}=s.useContext(B),[g,p]=n,[t,E]=P,[k,N]=L,[m,T]=I,[b,M]=r,[_,F]=w,[c,S]=f,[u,G]=v,[d,h]=s.useState(!1),[y,C]=s.useState(!1),[o,O]=s.useState(null),[R,V]=s.useState(0),[$,Y]=s.useState(!1),[D,x]=s.useState(!1);s.useEffect(()=>{t.username&&(h(m.username===t.username),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:0}).then(U=>{U&&O(U)}))},[t]);const z=()=>{if($||D)return;let U=document.querySelector("#last");if(!U)return;!Z(U)&&(x(!0),A("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:R+1}).then(j=>{j&&j.length>0?(O([...o,...j]),x(!1)):Y(!0)}),V(j=>j+1))},le=()=>{t.name&&A("Instagram",{action:"updateProfile",data:{name:t.name,bio:t.bio,avatar:t.avatar}}).then(U=>{U&&C(!1)})};X("instagram:setFollowers",U=>{U.username===t.username&&E({...t,followers:U.followers})}),X("instagram:setFollowing",U=>{U.username===t.username&&E({...t,following:U.following})});const ve=s.useRef(!0);s.useEffect(()=>{if(ve.current){ve.current=!1;return}A("Instagram",{action:"toggleFollow",data:{username:t.username,following:t.isFollowing}})},[t.isFollowing]);const ke=()=>{A("AccountSwitcher",{action:"getAccounts",app:"Instagram"}).then(U=>{var ee;if(!U)return he("info","No accounts found");let J=m.isAdmin,j=(ee=U==null?void 0:U.filter(oe=>oe!==t.username))==null?void 0:ee.map(oe=>({title:oe,cb:()=>{A("AccountSwitcher",{action:"switch",app:"Instagram",account:oe}).then(ct=>{A("Instagram",{action:"isLoggedIn"}).then(fe=>{fe?(Q.APPS.INSTAGRAM.account.set(fe),T({...fe,isAdmin:J}),p("feed"),N(!0)):Q.APPS.INSTAGRAM.account.set(!1)})})}}));H.ContextMenu.set({buttons:[{title:m.username},...j,{title:"Add Account",cb:()=>{N(!1)}}]})})};return e(W,{children:t&&a("div",{className:"profile",children:[e(me,{children:y&&a(ue.div,{className:"edit-profile",initial:{y:750,opacity:.75},animate:{y:0,opacity:1},exit:{y:750,opacity:.75},transition:{duration:.3,ease:"easeInOut"},children:[a("div",{className:"edit-profile-header",children:[e("div",{className:"cancel",onClick:()=>C(!1),children:i("CANCEL")}),e("div",{className:"title",children:i("APPS.INSTAGRAM.EDIT_PROFILE")}),e("div",{className:"save",onClick:()=>le(),children:i("APPS.INSTAGRAM.DONE")})]}),a("div",{className:"edit-profile-body",children:[a("div",{className:"profile-picture",onClick:()=>{var U,J,j;H.Gallery.set({allowExternal:(j=(J=(U=ce)==null?void 0:U.value)==null?void 0:J.AllowExternal)==null?void 0:j.Instagram,onSelect:ee=>{E({...t,avatar:ee.src}),T({...m,avatar:ee.src})}})},children:[e("img",{src:l.getAvatar(t.avatar),alt:"profile"}),e("span",{children:i("APPS.INSTAGRAM.CHANGE_PICTURE")})]}),a("div",{className:"profile-items",children:[a("div",{className:"item",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.NAME")}),e(K,{placeholder:i("APPS.INSTAGRAM.NAME_PLACEHOLDER"),onChange:U=>{E({...t,name:U.target.value})},maxLength:30,defaultValue:t.name})]}),a("div",{className:"item",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.BIO")}),e(Ie,{placeholder:i("APPS.INSTAGRAM.BIO"),onChange:U=>{E({...t,bio:U.target.value})},maxLength:100,defaultValue:t.bio??""})]})]}),e("div",{className:"sign-out",onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.TITLE"),description:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"signOut"}).then(U=>{N(null),T(null),Q.APPS.INSTAGRAM.account.set(!1)})}}]})},children:"Sign Out"})]})]})}),d?e("div",{className:"instagram-header",children:a("div",{className:"name",style:{cursor:"pointer"},onClick:()=>ke(),children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})}),e(Ge,{})]})}):a("div",{className:"profile-header",children:[e("i",{className:"fas fa-chevron-left",onClick:()=>{u!=null&&u.cb?u.cb():p("feed")}}),a("div",{className:"name",children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("span",{})]}),a("div",{className:"profile-body",children:[a("div",{className:"profile-wrapper",children:[a("div",{className:"top",children:[a("div",{className:"profile-picture",style:{backgroundImage:`url(${l.getAvatar(t.avatar)})`},children:[t.isLive&&e("img",{onClick:()=>{A("Instagram",{action:"viewLive",username:t.username}),p("live")},className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"}),t.hasStory&&!t.isLive?e("img",{className:"circle","data-seen":t.seenStory===1,src:"./assets/img/icons/instagram/StoryCircle.png",onClick:U=>{let[J,j]=Pe(U);l.fetchAndSetStory({username:t.username,avatar:t.avatar,verified:t.verified},null,{x:J,y:j})}}):null]}),a("div",{className:"stats",children:[a("div",{children:[e("div",{className:"value",children:t.posts}),e("div",{className:"label",children:t.posts===1?i("APPS.INSTAGRAM.POST"):i("APPS.INSTAGRAM.POSTS")})]}),a("div",{onClick:()=>{S({display:!0,data:{title:i("APPS.INSTAGRAM.FOLLOWERS"),username:t.username,cb:()=>{E(t),p("profile"),S({display:!1})}}})},children:[e("div",{className:"value",children:t.followers}),e("div",{className:"label",children:t.followers===1?i("APPS.INSTAGRAM.FOLLOWER"):i("APPS.INSTAGRAM.FOLLOWERS")})]}),a("div",{onClick:()=>{S({display:!0,data:{title:i("APPS.INSTAGRAM.FOLLOWING"),username:t.username,cb:()=>{E(t),p("profile"),S({display:!1})}}})},children:[e("div",{className:"value",children:t.following}),e("div",{className:"label",children:i("APPS.INSTAGRAM.FOLLOWING")})]})]})]}),e("div",{className:"name",children:t.name}),e("div",{className:"description",children:ie(t.bio)??""}),e("div",{className:"buttons",children:d?d&&e("div",{className:"button edit",onClick:()=>{C(!0)},children:i("APPS.INSTAGRAM.EDIT_PROFILE")}):a(W,{children:[t.isFollowing?e("div",{className:"button following",onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:t.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{E({...t,isFollowing:!1})}}]})},children:i("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",onClick:()=>{E({...t,isFollowing:!0})},children:i("APPS.INSTAGRAM.FOLLOW")}),e("div",{className:"button following",onClick:()=>{F({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),p("dm")},children:i("APPS.INSTAGRAM.MESSAGE")})]})})]}),e("div",{className:"posts",onScroll:z,children:o&&o.map((U,J)=>{let j=J===o.length-1?"last":"",ee=JSON.parse(U.media)[0];return e("div",{id:j,onClick:()=>{G({cb:()=>{E(t),p("profile"),M(null),G(null)}}),M(U),p("post")},children:q(ee)?e("video",{src:ee,muted:!0,autoPlay:!0,loop:!0}):e("img",{src:ee})},J)})})]})]})})}function Xe(){const{Func:n,View:P,GoBack:I,Post:l}=s.useContext(B),[v,r]=P,[f,L]=I,[w,g]=l,[p,t]=s.useState(""),[E,k]=s.useState(""),[N,m]=s.useState([]);s.useState([]);const[T,b]=s.useState([]),[M,_]=s.useState(0),[F,c]=s.useState(!1),[S,u]=s.useState(!1);return s.useEffect(()=>{A("Instagram",{action:"getPosts",page:0}).then(d=>{d&&b(d)})},[]),s.useEffect(()=>{const d=setTimeout(()=>t(E),500);return()=>clearTimeout(d)},[E]),s.useEffect(()=>{p.length>0&&A("Instagram",{action:"search",query:p}).then(d=>{d&&m(d)})},[p]),a("div",{className:"search-container",children:[e("div",{className:"search-header",children:e(ge,{placeholder:"Search",onChange:d=>k(d.target.value)})}),e("div",{className:"search-body",onScroll:()=>{if(F||S||p.length>0)return;let d=document.querySelector("#last");if(!d)return;!Z(d)&&(u(!0),A("Instagram",{action:"getPosts",page:M+1}).then(y=>{y&&y.length>0?(b([...T,...y]),u(!1)):c(!0)}),_(y=>y+1))},children:p.length>0?e("div",{className:"search-results",children:N.map(d=>a("div",{className:"item",onClick:()=>{n.fetchAndSetProfile(d.username)},children:[e("div",{className:"profile-picture",children:e("img",{src:n.getAvatar(d.avatar),alt:"profile"})}),a("div",{className:"user",children:[a("div",{className:"username",children:[d.username,d.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:d.name})]})]}))}):e("div",{className:"feed-grid",children:T.map((d,h)=>{let C=Math.floor(h/3)%2==0,o=!1;o=h%3==(C?1:0),T[h+1]||(o=!1);let O=JSON.parse(d.media)[0],R=h==T.length-1?"last":"";return e("div",{id:R,className:`grid-post${o?" big":""}`,onClick:()=>{L({cb:()=>{r("search"),L(null)}}),g(d),r("post")},children:q(O)?e("video",{src:O,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:O,alt:"post"})},h)})})})]})}function Ke(){const{View:n,GoBack:P,Comments:I,Account:l,Func:v}=s.useContext(B),[r]=l,[f,L]=n,[w]=P,[g,p]=I,[t,E]=s.useState(""),k=s.useRef(null),[N,m]=s.useState(0),[T,b]=s.useState(!1),[M,_]=s.useState(!1),F=()=>{t.length!==0&&A("Instagram",{action:"postComment",data:{postId:g.post.id,comment:t}}).then(()=>{E(""),k.current.value="",p({...g,post:g.post,comments:[{user:{username:r.username,avatar:r.avatar,verified:r.verified},comment:{content:t,timestamp:new Date().getTime(),likes:0,liked:!1}},...g.comments]})})},c=()=>{if(T||M)return;let S=document.querySelector("#last");if(!S)return;!Z(S)&&(_(!0),A("Instagram",{action:"getComments",postId:g.post.id,page:N+1}).then(G=>{G&&G.length>0?(p({...g,comments:[...g.comments,...G]}),_(!1)):b(!0)}),m(G=>G+1))};return a("div",{className:"comments-container",children:[a("div",{className:"comments-header",children:[e(Ce,{onClick:()=>{w&&(w!=null&&w.cb)?w.cb():L("feed")}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.COMMENTS")}),e("span",{})]}),a("div",{className:"comments-body",onScroll:c,children:[a("div",{className:"post-info",children:[e("div",{className:"profile-picture",children:e("img",{src:v.getAvatar(g.post.avatar),alt:"profile"})}),a("div",{className:"post-data",children:[a("div",{className:"caption",children:[a("span",{className:"username",children:[g.post.username,g.post.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),ie(g.post.caption)]}),e("div",{className:"actions",children:e("div",{className:"date",children:Te(g.post.timestamp)})})]})]}),g.comments.map((S,u)=>{let G=u===g.comments.length-1;return e(qe,{data:S,last:G},u)})]}),a("div",{className:"add-comment",children:[e("div",{className:"profile-picture",children:e("img",{src:v.getAvatar(r.avatar),alt:"profile"})}),a("div",{className:"input-container",children:[e(K,{type:"text",ref:k,placeholder:i("APPS.INSTAGRAM.ADD_COMMENT_AS").format({name:r.username}),onKeyPress:S=>{S.key==="Enter"&&F()},onChange:S=>E(S.target.value)}),e("div",{className:"send",onClick:F,children:i("APPS.INSTAGRAM.POST")})]})]})]})}const qe=({data:n,last:P})=>{const{Func:I}=s.useContext(B),[l,v]=s.useState(n.comment.liked),[r,f]=s.useState(n.comment.likes);return a("div",{className:"comment",id:P&&"last",children:[a("div",{className:"user",children:[e("div",{className:"profile-picture",onClick:()=>I.fetchAndSetProfile(n.user.username),children:e("img",{src:I.getAvatar(n.user.avatar),alt:"profile"})}),a("div",{className:"comment-data",children:[a("div",{className:"caption",children:[a("span",{className:"username",onClick:()=>I.fetchAndSetProfile(n.user.username),children:[n.user.username,n.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),n.comment.content]}),a("div",{className:"actions",children:[e("div",{className:"date",children:Te(n.comment.timestamp)}),a("div",{className:"likes",children:[r," ",i("APPS.INSTAGRAM.LIKES").toLowerCase()]})]})]})]}),e(Ee,{liked:l,onClick:()=>{n.comment.id&&A("Instagram",{action:"toggleLike",data:{postId:n.comment.id,toggle:!l,isComment:!0}}).then(L=>{L&&(v(L.liked),f(L.likes))})}})]})},Te=n=>{const P=new Date(n),l=new Date().getTime()-P.getTime(),v=Math.floor(l/(1e3*60*60*24)),r=Math.floor(l/(1e3*60*60)),f=Math.floor(l/(1e3*60));let L="";return v<1?r<1?L=`${f}m`:L=`${r}h`:v<30?L=`${v}d`:L=`${P.getDate()}/${P.getMonth()+1}/${P.getFullYear()}`,L};function Je(){var F,c,S;const{View:n}=s.useContext(B),[P,I]=n,[l,v]=s.useState(0),[r,f]=s.useState([]),[L,w]=s.useState(""),[g,p]=s.useState([]),[t,E]=s.useState(""),[k,N]=s.useState(0),[m,T]=s.useState(!1),[b,M]=s.useState(!1);s.useEffect(()=>{A("Camera",{action:"getImages",page:0,filter:{showVideos:!0,showPhotos:!0}}).then(u=>{u&&p(u)})},[]);const _=u=>{if(b||m)return;let G=document.querySelector("#last");if(!G)return;!Z(G)&&(T(!0),A("Camera",{action:"getImages",page:k+1,filter:{showVideos:!0,showPhotos:!0}}).then(h=>{h&&h.length>0?(p([...g,...h]),T(!1)):M(!0)}),N(h=>h+1))};return s.useEffect(()=>{t&&t.includes("data:image")||Ve(t,u=>{if(u){const G=document.querySelector(".searchbox input");G&&(G.value=""),g.find(d=>d.src===t)||p(d=>[{src:t},...d])}})},[t]),a("div",{className:"newpost-container","data-camera":!1,children:[l===0&&a(W,{children:[a("div",{className:"newpost-header",children:[e("i",{className:"fal fa-times",onClick:()=>{I("feed")}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{r.length>0&&l==0&&v(1)},children:i("APPS.INSTAGRAM.NEXT")})]}),((S=(c=(F=ce)==null?void 0:F.value)==null?void 0:c.AllowExternal)==null?void 0:S.Instagram)&&e(ge,{placeholder:i("COMPONENTS.GALLERY.EXTERNAL_URL"),onChange:u=>E(u.target.value)}),e("div",{className:"newpost-body",onScroll:_,children:e("div",{className:"images",children:g.map((u,G)=>{let d=G===g.length-1?"last":"";return a("div",{id:d,className:"image",onClick:()=>{r.includes(u.src)?f(r.filter(y=>y!==u.src)):r.length<5&&f([...r,u.src])},children:[q(u.src)?e(Qe,{src:u.src}):e("img",{src:u.src,alt:"image"}),e("div",{className:"select",children:e(Ue,{checked:r.includes(u.src)})})]},G)})})})]}),l===1&&a(W,{children:[a("div",{className:"newpost-header",children:[e("i",{className:"fal fa-chevron-left",onClick:()=>{v(0)}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{A("Instagram",{action:"newPost",data:{caption:L,images:r}}).then(u=>{u&&I("feed")})},children:i("APPS.INSTAGRAM.POST")})]}),e("div",{className:"newpost-body",children:a("div",{className:"caption",children:[e("div",{className:"image",children:q(r[0])?e("video",{src:r[0],muted:!0}):e("img",{src:r[0],alt:"image"})}),e(Ie,{onChange:u=>{w(u.target.value)},placeholder:i("APPS.INSTAGRAM.CAPTION_PLACEHOLDER")})]})})]})]})}const Qe=({src:n})=>{const[P,I]=s.useState(null);return a(W,{children:[e("video",{src:n,crossOrigin:"anonymous",controls:!1,onMouseOver:v=>v.currentTarget.play(),onMouseOut:v=>v.currentTarget.pause(),onLoadedMetadata:v=>I(v.currentTarget.duration)}),P&&e("div",{className:"video-duration",children:(v=>{const r=Math.floor(v/60),f=De(v-r*60,0);return`${r}:${f<10?"0"+f:f}`})(P)})]})};function Ze(){const{View:n,Post:P,GoBack:I}=s.useContext(B),[l,v]=n,[r]=I,[f]=P;return e(W,{children:f&&e("div",{className:"viewpost-container",children:a(W,{children:[a("div",{className:"viewpost-header",children:[e(Ce,{onClick:()=>{r&&(r.cb?r.cb():v(r.view))}}),e("div",{className:"name",children:f.username??"Unknown"}),e("span",{})]}),e("div",{className:"profile-body",children:e(we,{data:f})})]})})})}function et(){const{Func:n,Account:P,Dm:I,View:l,GoBack:v}=s.useContext(B);te(se.Settings);const[r]=P,[f,L]=l,[w,g]=I,[p,t]=v,[E,k]=s.useState([]),N=s.useRef(null),[m,T]=s.useState({content:"",attachments:[]}),[b,M]=s.useState(0),[_,F]=s.useState(!1),[c,S]=s.useState(!1);s.useEffect(()=>{F(!1),S(!1),M(0),k([]),A("Instagram",{action:"getMessages",page:0,username:w.username}).then(d=>{d&&k(d.reverse())})},[]),X("instagram:newMessage",d=>{if(w.username!==d.sender)return;k([...E,d]);let h=document.querySelector(".dm-body-container");h.scrollTop=h.scrollHeight});const u=()=>{m.content.length===0&&m.attachments.length===0||A("Instagram",{action:"sendMessage",username:w.username,message:{content:m.content,attachments:m.attachments.length>0?m.attachments:null}}).then(d=>{if(!d)return;N.current.value="",k([...E,{sender:r.username,recipient:w.username,content:m.content,attachments:m.attachments,timestamp:Date.now()}]),T({content:"",attachments:[]});let h=document.querySelector(".dm-body-container");h.scrollTop=h.scrollHeight})},G=()=>{if(_||c)return;let d=document.querySelector("#last");if(!d)return;!Z(d)&&(S(!0),A("Instagram",{action:"getMessages",page:b+1,username:w.username}).then(y=>{y&&y.length>0?(k([...y.reverse(),...E]),S(!1)):F(!0)}),M(y=>y+1))};return a("div",{className:"dm-container",children:[a("div",{className:"dm-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{p&&p.cb?(p.cb(),t(null)):L("dmList")}}),a("div",{className:"profile",onClick:d=>{d.stopPropagation(),t({cb:()=>{g(w),L("dm")}}),n.fetchAndSetProfile(w.username)},children:[e("div",{className:"avatar",children:e("img",{src:n.getAvatar(w.avatar)})}),a("div",{className:"username",children:[w.name??w.username,w.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]})]}),e("div",{className:"dm-body-container",onScroll:G,children:e("div",{className:"dm-body",children:E.map((d,h)=>{var R;let y,C=h===0,o=d.sender===r.username?"self":"other",O=((R=E[h+1])==null?void 0:R.sender)===r.username?"self":"other";return E[h+1]?y=Math.abs(d.timestamp-E[h+1].timestamp)/36e5:O=void 0,a("div",{className:`message ${o}`,id:C?"last":"",children:[o=="other"?a("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${o!==O?"show":"hide"}`,onClick:V=>{V.stopPropagation(),t({cb:()=>{g(w),L("dm")}}),n.fetchAndSetProfile(w.username)},children:e("img",{src:n.getAvatar(w.avatar)})}),a("div",{className:"message-content",children:[d.content&&e("div",{className:"content",children:ie(d.content)}),d.attachments&&e("div",{className:"attatchments",children:d.attachments.map((V,$)=>q(V)?e("video",{src:V,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:Y=>{H.FullscreenImage.set({display:!0,image:V})}},$):e(Ne,{src:V,onClick:()=>{H.FullscreenImage.set({display:!0,image:V})}},$))})]})]}):a(W,{children:[d.content&&e("div",{className:"content",children:ie(d.content)}),d.attachments&&e("div",{className:"attatchments",children:d.attachments.map((V,$)=>q(V)?e("video",{src:V,controls:!1,loop:!0,muted:!0,autoPlay:!0,onClick:Y=>{H.FullscreenImage.set({display:!0,image:V})}},$):e("img",{src:V,onClick:()=>{H.FullscreenImage.set({display:!0,image:V})}},$))})]}),E[h+1]&&y>6?e("div",{className:"date",children:Se(d.timestamp)}):o!==O&&e("div",{className:"date",children:Se(d.timestamp)})]},h)})})}),e("div",{className:"attachments",children:m.attachments.map((d,h)=>a("div",{className:"attachment",children:[q(d)?e("video",{src:d,muted:!0,controls:!1,loop:!0,autoPlay:!0}):e(Ne,{src:d}),e(re,{onClick:()=>{T({...m,attachments:m.attachments.filter((y,C)=>C!==h)})}})]},h))}),a("div",{className:"dm-footer",children:[e(K,{type:"text",ref:N,onChange:d=>{T({...m,content:d.target.value})},onKeyDown:d=>{d.key==="Enter"&&u()},placeholder:i("APPS.INSTAGRAM.MESSAGE_PLACEHOLDER")}),m.content.length>0?e("span",{onClick:()=>u(),className:"send",children:i("APPS.INSTAGRAM.SEND")}):e(_e,{onClick:()=>{var d,h,y;m.attachments.length<3&&H.Gallery.set({includeVideos:!0,allowExternal:(y=(h=(d=ce)==null?void 0:d.value)==null?void 0:h.AllowExternal)==null?void 0:y.Instagram,onSelect:C=>T({...m,attachments:[...m.attachments,C.src]})})}})]})]})}function tt(){const{View:n,Func:P,Dm:I,Account:l,GoBack:v}=s.useContext(B),[r,f]=n,[L]=l,[w,g]=I,[p,t]=v,[E,k]=s.useState(!1),[N,m]=s.useState(""),[T,b]=s.useState(""),[M,_]=s.useState([]);s.useState([]);const[F,c]=s.useState([]),[S,u]=s.useState(0),[G,d]=s.useState(!1),[h,y]=s.useState(!1);s.useEffect(()=>{A("Instagram",{action:"getRecentMessages",page:0}).then(o=>{o&&c(o)})},[]);const C=()=>{if(G||h)return;let o=document.querySelector("#last");if(!o)return;!Z(o)&&(y(!0),A("Instagram",{action:"getRecentMessages",page:S+1}).then(R=>{R&&R.length>0?(c([...F,...R]),y(!1)):d(!0)}),u(R=>R+1))};return s.useEffect(()=>{const o=setTimeout(()=>m(T),500);return()=>clearTimeout(o)},[T]),s.useEffect(()=>{N.length>0?E?A("Instagram",{action:"search",query:N}).then(o=>{o&&_(o)}):_(F.filter(o=>{var O;return o.username.includes(N)||((O=o==null?void 0:o.name)==null?void 0:O.includes(N))&&o.username!==L.username})):_([])},[N]),s.useEffect(()=>{m(""),_([])},[E]),e("div",{className:"dm-list",children:E?a("div",{className:"slide up",children:[a("div",{className:"dm-list-header new",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{k(!1),_([])}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_MESSAGE")}),e("span",{})]}),a("div",{className:"dm-list-body ",children:[a("div",{className:"input",children:[e("span",{children:i("APPS.INSTAGRAM.TO")}),e(K,{type:"text",onChange:o=>b(o.target.value),placeholder:"Search"})]}),M.length>0&&e("div",{className:"items",children:M.map((o,O)=>a("div",{className:"item",onClick:()=>{k(!1),g(o),f("dm")},children:[e("div",{className:"avatar",onClick:R=>{R.stopPropagation(),t({cb:()=>{f("dmList"),t(null)}}),P.fetchAndSetProfile(o.username)},children:e("img",{src:P.getAvatar(o.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[o.username,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"last-message",children:o.name})]})]},O))})]})]}):a(W,{children:[a("div",{className:"dm-list-header",children:[a("div",{className:"top",children:[e("i",{className:"far fa-chevron-left",onClick:()=>f("feed")}),e("i",{className:"far fa-edit",onClick:()=>k(!0)})]}),e(ge,{placeholder:i("SEARCH"),onChange:o=>b(o.target.value)})]}),e("div",{className:"dm-list-body",onScroll:C,children:e("div",{className:"items",children:N.length>0&&!E?M.map((o,O)=>{var R;return((R=o.content)==null?void 0:R.length)===0&&(o.content=i("APPS.INSTAGRAM.SENT_A_PHOTO")),a("div",{className:"item",onClick:()=>{k(!1),g(o),f("dm")},children:[e("div",{className:"avatar",onClick:V=>{V.stopPropagation(),t({cb:()=>{f("dmList"),t(null)}}),P.fetchAndSetProfile(o.username)},children:e("img",{src:P.getAvatar(o.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),a("div",{className:"last-message",children:[o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",ae(o.timestamp)]})]})]},O)}):F.map((o,O)=>{let R=O===F.length-1;return o.content.length===0&&(o.content=i("APPS.INSTAGRAM.SENT_A_PHOTO")),a("div",{className:"item",id:R?"last":"",onClick:()=>{k(!1),g(o),f("dm")},children:[e("div",{className:"avatar",onClick:V=>{V.stopPropagation(),t({cb:()=>{f("dmList"),t(null)}}),P.fetchAndSetProfile(o.username)},children:e("img",{src:P.getAvatar(o.avatar)})}),a("div",{className:"info",children:[a("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",ae(o.timestamp)]})]},O)})})})]})})}function at(){var y,C,o,O;const{Account:n,View:P,Func:I,Stories:l,Story:v,Dm:r}=s.useContext(B),[f]=n,[L,w]=P,[g,p]=l,[t,E]=v,[k,N]=r,[m,T]=s.useState(0),[b,M]=s.useState(""),[_,F]=s.useState(!1),[c,S]=s.useState({x:0,y:0});s.useEffect(()=>{if(t){S(t.origin);for(let R=0;R<t.media.length;R++)if(!t.media[R].seen)return T(R)}},[]);const u=R=>{if(_)return F(!1);const V=R.target.getBoundingClientRect(),$=R.clientX-V.left;let Y=t.media[m];if(Y.seen||A("Instagram",{action:"viewedStory",id:Y.id}),$<V.width/2)if(m>0)T(m-1);else{let D=g.findIndex(z=>z.username===t.username),x=g[D-1];x&&I.fetchAndSetStory(x)}else if(m<t.media.length-1)T(m+1);else{let D=g.findIndex(z=>z.username===t.username),x=g[D+1];x?(d(t.username),I.fetchAndSetStory(x),T(0)):h()}},G=()=>{!b||b===""||A("Instagram",{action:"sendMessage",username:t.username,message:{content:b}}).then(R=>{R&&(N({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),w("dm"),h())})},d=R=>{t.media.length===m+1&&p(V=>V.map($=>($.username===R&&($.seen=!0),$)))},h=R=>{R!==!1&&d(t.username),E(null)};return a(ue.div,{className:"instagram-story",initial:{scale:0,transformOrigin:t!=null&&t.origin?`${((y=t==null?void 0:t.origin)==null?void 0:y.x)??0}px ${((C=t==null?void 0:t.origin)==null?void 0:C.y)??0}px`:"50% 50%"},animate:{scale:1,transformOrigin:t!=null&&t.origin?`${((o=t==null?void 0:t.origin)==null?void 0:o.x)??0}px ${((O=t==null?void 0:t.origin)==null?void 0:O.y)??0}px`:"50% 50%"},exit:{scale:0,transformOrigin:c?`${(c==null?void 0:c.x)??0}px ${(c==null?void 0:c.y)??0}px`:"50% 50%"},transition:{duration:.25,ease:"easeInOut"},children:[q(t==null?void 0:t.media[m].image)?e("video",{className:"background-image",onClick:u,autoPlay:!0,loop:!0,src:t==null?void 0:t.media[m].image}):e("div",{className:"background-image",onClick:u,style:{backgroundImage:`url(${t==null?void 0:t.media[m].image})`}}),e(me,{children:_&&e(st,{activeImage:m,close:()=>F(!1)})}),a("div",{className:"story-wrapper",children:[a("div",{className:"story-header",children:[e("div",{className:"story-steps",children:t==null?void 0:t.media.map((R,V)=>e("div",{className:m===V?"active":"",onClick:()=>T(V)},V))}),a("div",{className:"profile-details",children:[a("div",{className:"profile",onClick:()=>I.fetchAndSetProfile(t.username),children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${I.getAvatar(t==null?void 0:t.avatar)})`}}),a("div",{className:"name",children:[t==null?void 0:t.username,!1]}),e("div",{className:"time",children:ae(t==null?void 0:t.media[m].timestamp)})]}),e("div",{className:"stats",children:e(re,{onClick:()=>{if(t!=null&&t.media[m].seen)return h();A("Instagram",{action:"viewedStory",id:t==null?void 0:t.media[m].id}).then(R=>h())}})})]})]}),(t==null?void 0:t.username)===f.username?a("div",{className:"story-footer","data-stats":!0,children:[a("div",{className:"seen-by",onClick:()=>F(!0),children:[(t==null?void 0:t.media[m].viewers)&&e("div",{className:"images",children:t==null?void 0:t.media[m].viewers.map((R,V)=>e("img",{src:I.getAvatar(R.avatar)},V))}),i("APPS.INSTAGRAM.SEEN_BY").format({count:xe(t==null?void 0:t.media[m].views)??0})]}),e(re,{onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.DELETE_STORY.TITLE"),description:i("APPS.INSTAGRAM.DELETE_STORY.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.DELETE_STORY.CANCEL")},{title:i("APPS.INSTAGRAM.DELETE_STORY.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"removeFromStory",id:t==null?void 0:t.media[m].id}).then(R=>{if(!R)return he("error","Failed to remove image from story");he("info","Removed image from story"),E(null),t.media.length===1&&p(V=>V.filter($=>$.username!==t.username))})}}]})}})]}):a("div",{className:"story-footer",children:[e("div",{className:"input",children:e(K,{type:"text",placeholder:i("APPS.INSTAGRAM.SEND_A_MESSAGE"),onChange:R=>M(R.target.value),onKeyDown:R=>{R.key==="Enter"&&G()}})}),e(be,{onClick:()=>G()})]})]})]})}const st=n=>{var N;const{Func:P,Story:I}=s.useContext(B),[l,v]=I,[r,f]=s.useState([]),[L,w]=s.useState(0),[g,p]=s.useState(!1),[t,E]=s.useState(!1);s.useEffect(()=>{(n==null?void 0:n.activeImage)!==void 0&&A("Instagram",{action:"getViewers",id:l==null?void 0:l.media[n.activeImage].id,page:0}).then(m=>{m&&(f(m),m.length<15&&p(!0))})},[]);const k=m=>{if(g||t)return;let T=document.querySelector("#last");if(!T)return;!Z(T)&&(E(!0),A("Instagram",{action:"getViewers",id:l==null?void 0:l.media[n.activeImage].id,page:L+1}).then(M=>{M&&M.length>0?(f(_=>[..._,...M]),E(!1),M.length<15&&p(!0)):p(!0)}),w(M=>M+1))};return a(ue.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[a("div",{className:"story-modal-header",children:[a("div",{className:"views",children:[e(pe,{})," ",e("div",{className:"views",children:((N=l==null?void 0:l.media[n==null?void 0:n.activeImage])==null?void 0:N.views)??0})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),a("div",{className:"story-modal-content",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",onScroll:k,children:r.map((m,T)=>{let b=T===r.length-1?"last":"";return e("div",{className:"item",id:b,children:a("div",{className:"user",onClick:()=>{P.fetchAndSetProfile(m.username),v(null)},children:[e("div",{className:"profile-picture",children:e("img",{src:P.getAvatar(m.avatar)})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[m.username,m.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:m.name})]})]})},T)})})]})]})};function nt(){var L;const{Func:n,View:P,Account:I}=s.useContext(B),l=te(se.Settings),[v,r]=P,[f]=I;return e("div",{className:"instagram-footer",children:a(W,{children:[e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>r("feed"),children:e("g",{children:v=="feed"?e("path",{fill:l.display.theme=="dark"&&"#fafafa",d:"M22 23h-6.001a1 1 0 01-1-1v-5.455a2.997 2.997 0 10-5.993 0V22a1 1 0 01-1 1H2a1 1 0 01-1-1V11.543a1.002 1.002 0 01.31-.724l10-9.543a1.001 1.001 0 011.38 0l10 9.543a1.002 1.002 0 01.31.724V22a1 1 0 01-1 1z"}):e("path",{d:"M9.005 16.545a2.997 2.997 0 012.997-2.997h0A2.997 2.997 0 0115 16.545V22h7V11.543L12 2 2 11.543V22h7.005z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>r("search"),children:v=="search"?e("path",{fill:l.display.theme=="dark"&&"#fafafa",d:"M13.173 13.164l1.491-3.829-3.83 1.49zM12.001.5a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012.001.5zm5.35 7.443l-2.478 6.369a1 1 0 01-.57.569l-6.36 2.47a1 1 0 01-1.294-1.294l2.48-6.369a1 1 0 01.57-.569l6.359-2.47a1 1 0 011.294 1.294z"}):a(W,{children:[e("polygon",{fill:"none",points:"13.941 13.953 7.581 16.424 10.06 10.056 16.42 7.585 13.941 13.953",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("polygon",{fillRule:"evenodd",points:"10.06 10.056 13.949 13.945 7.581 16.424 10.06 10.056"}),e("circle",{cx:"12.001",cy:"12.005",fill:"none",r:"10.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>r("newPost"),children:a(W,{children:[e("path",{d:"M2 12v3.45c0 2.849.698 4.005 1.606 4.944.94.909 2.098 1.608 4.946 1.608h6.896c2.848 0 4.006-.7 4.946-1.608C21.302 19.455 22 18.3 22 15.45V8.552c0-2.849-.698-4.006-1.606-4.945C19.454 2.7 18.296 2 15.448 2H8.552c-2.848 0-4.006.699-4.946 1.607C2.698 4.547 2 5.703 2 8.552z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"6.545",x2:"17.455",y1:"12.001",y2:"12.001"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"12.003",x2:"12.003",y1:"6.545",y2:"17.455"})]})}),v==="notifications"?e("svg",{fill:"#262626",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{fill:l.display.theme=="dark"&&"#fafafa",d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{color:((L=l==null?void 0:l.display)==null?void 0:L.theme)==="dark"?"#ffffff":"#262626",fill:l.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>r("notifications"),children:e("path",{color:l.display.theme=="dark"&&"#fafafa",d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})}),e("img",{src:n.getAvatar(f.avatar),className:"profile",alt:"profile",onClick:()=>n.fetchAndSetProfile(f.username)})]})})}function it(){const{Account:n,UserPanel:P,GoBack:I}=s.useContext(B),[l,v]=P,[r,f]=s.useState([]),[L,w]=s.useState(0),[g,p]=s.useState(!1),[t,E]=s.useState(!1);let k={[i("APPS.INSTAGRAM.FOLLOWING")]:"getFollowing",[i("APPS.INSTAGRAM.FOLLOWERS")]:"getFollowers",[i("APPS.TWITTER.LIKED_BY")]:"getLikes"};s.useEffect(()=>{A("Instagram",{action:k[l.data.title],data:{postId:l.data.postId,username:l.data.username,page:0}}).then(m=>{m&&f(m)})},[]);const N=()=>{if(g||t)return;!Z(document.querySelector("#last"))&&(E(!0),A("Instagram",{action:k[l.data.title],data:{postId:l.data.postId,username:l.data.username,page:L+1}}).then(T=>{T&&T.length>0?(f([...r,...T]),E(!1)):p(!0)}),w(T=>T+1))};return e(W,{children:l.data&&r&&a("div",{className:"userpanel-container",children:[a("div",{className:"userpanel-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{var m;(m=l.data)==null||m.cb()}}),e("div",{className:"userpanel-title",children:l.data.title}),e("span",{})]}),e("div",{className:"userpanel-body",onScroll:N,children:e("div",{className:"items",children:r.map((m,T)=>{let b=T===r.length-1;return e(rt,{data:m,allData:l.data,last:b},T)})})})]})})}const rt=n=>{const{Func:P,Account:I,GoBack:l,UserPanel:v}=s.useContext(B),[r]=I,[f,L]=l,[w,g]=v;let p=n.data,t=n.last;const[E,k]=s.useState(p.isFollowing===1);return a("div",{className:"item",id:t?"last":"",onClick:()=>{L({cb:()=>{g({display:!0,data:n.allData})}}),P.fetchAndSetProfile(p.username)},children:[a("div",{className:"user",children:[e("div",{className:"profile-picture",children:e("img",{src:P.getAvatar(p.avatar),alt:"profile"})}),a("div",{className:"user-details",children:[a("div",{className:"username",children:[p.username,p.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:p.name})]})]}),r.username!==p.username&&e("div",{className:"action",onClick:N=>{N.stopPropagation(),p.username!==r.username&&(E?H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:p.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{A("Instagram",{action:"toggleFollow",data:{username:p.username,following:!E}}).then(()=>{k(m=>!m)})}}]}):A("Instagram",{action:"toggleFollow",data:{username:p.username,following:!E}}).then(()=>{k(m=>!m)}))},children:E?e("div",{className:"button following",children:i("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",children:i("APPS.INSTAGRAM.FOLLOW")})})]})},B=s.createContext(null);function vt(){const{Func:n}=s.useContext(Fe),P=te(se.Settings),I=te(se.App),[l,v]=n.TextColor,[r,f]=s.useState("feed"),[L,w]=s.useState(null),[g,p]=s.useState(!1),[t,E]=s.useState([]),[k,N]=s.useState(null),[m,T]=s.useState(null),[b,M]=s.useState(null),[_,F]=s.useState(null),[c,S]=s.useState(null),[u,G]=s.useState(null),[d,h]=s.useState({display:!1,data:null}),[y,C]=s.useState(!0);s.useEffect(()=>{var D;I&&(I==null?void 0:I.view)==="profile"&&O((D=I==null?void 0:I.data)==null?void 0:D.username)},[I]),s.useEffect(()=>{A("isAdmin").then(D=>{if(Q.APPS.INSTAGRAM.account.value){w({...Q.APPS.INSTAGRAM.account.value,isAdmin:D}),p(!0),C(!1);return}else if(Q.APPS.INSTAGRAM.account.value===!1)return C(!1);A("Instagram",{action:"isLoggedIn"}).then(x=>{x?(Q.APPS.INSTAGRAM.account.set(x),w({...x,isAdmin:D}),p(!0),C(!1)):(Q.APPS.INSTAGRAM.account.set(!1),C(!1))})})},[]),s.useEffect(()=>(setTimeout(()=>{r==="live"||r==="newPost"||r==="story"?(v("#fafafaed"),r=="live"&&H.IndicatorVisible.set(!1)):(v(P.display.theme==="dark"?"#fafafaed":"#000000"),H.IndicatorVisible.set(!0)),r==="dm"?ne.ReceiveAppNotifications.set(!1):ne.ReceiveAppNotifications.set(!0)},250),()=>{ne.ReceiveAppNotifications.set(!0)}),[r]);const o=(D,x)=>{D&&A("Instagram",{action:"getPost",id:D}).then(z=>{if(z){if(x)return R(z);S(z),f("post")}})},O=D=>{D&&A("Instagram",{action:"getProfile",username:D}).then(x=>{x&&(T(x),f("profile"))})},R=D=>{D.id&&A("Instagram",{action:"getComments",postId:D.id,page:0}).then(x=>{x&&(F({post:D,comments:x}),f("comments"))})},V=(D,x,z)=>{!D&&!(D!=null&&D.username)||((x==null?void 0:x.length)==0&&(x=void 0),A("Instagram",{action:"getStory",username:D.username}).then(le=>{le&&N({username:D.username,avatar:D.avatar,verified:D.verified,media:le,queue:x,origin:z})}))},$=D=>D||"./assets/img/icons/instagram/unknown-pfp.jpg",Y={feed:e(Be,{}),search:e(Xe,{}),notifications:e(je,{}),profile:e(ze,{}),live:e($e,{}),logIn:e(Ae,{}),comments:e(Ke,{}),post:e(Ze,{}),newPost:e(Je,{}),userpanel:e(it,{}),dmList:e(tt,{}),dm:e(et,{})};return s.useEffect(()=>{d.display&&f("userpanel")},[d]),e("div",{className:"instagram-container",children:e(B.Provider,{value:{View:[r,f],Account:[L,w],Profile:[m,T],Post:[c,S],Comments:[_,F],LoggedIn:[g,p],GoBack:[u,G],UserPanel:[d,h],Dm:[b,M],Stories:[t,E],Story:[k,N],Func:{fetchAndSetProfile:O,fetchAndSetStory:V,fetchAndSetComments:R,fetchAndSetPost:o,getAvatar:$}},children:y||P.airplaneMode?e("div",{className:"loading",children:e(We,{size:55,speed:.9,color:l})}):e("div",{className:"instagram-wrapper",children:g?a(W,{children:[e(me,{children:k&&e(at,{})}),Y[r],r!=="live"&&r!=="logIn"&&r!=="newPost"&&r!=="comments"&&!k&&e(nt,{})]}):e(Ae,{})})})})}export{B as InstagramContext,vt as default};
