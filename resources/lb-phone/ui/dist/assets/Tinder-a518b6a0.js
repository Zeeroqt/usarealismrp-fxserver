import{R as O,r as o,a as r,j as e,F as H}from"./jsx-runtime-55b9ff2c.js";import{f as L,L as m,h as F,B as ve,u as J,M as ye,j as Se,bF as K,b1 as X,Q as le,C as W,e as ie,ah as Ne,a8 as pe,q as z,b as Q,r as be,H as Ee,v as Ie,bG as Me,X as de,O as te,Z as Te,_ as he,ar as Ce,bH as Ae,W as De,S as ue}from"./Phone-aba84f0c.js";import{a as xe}from"./DotSpinner-bb37008a.js";import"./number-28525126.js";var re=function(a){return new Promise(function(l){setTimeout(l,a)})};const k={snapBackDuration:300,maxTilt:5,bouncePower:.1,swipeThreshold:100},Re=t=>{const a=window.getComputedStyle(t),l=a.getPropertyValue("width"),n=Number(l.split("px")[0]),h=a.getPropertyValue("height"),p=Number(h.split("px")[0]);return{x:n,y:p}},me=(t,a)=>Math.sqrt(Math.pow(t,2)+Math.pow(a,2)),ke=(t,a=1)=>{const l=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x*a/l,y:t.y*a/l}},se=async(t,a,l=!1)=>{const n=Z(t),h=Re(document.body),p=me(h.x,h.y),w=me(a.x,a.y),I=p/w,S=p/w,b=oe(a.x*S+n.x,-a.y*S+n.y);let M="";const u=200;l?t.style.transition="ease "+I+"s":t.style.transition="ease-out "+I+"s",Y(t)===0?M=j((Math.random()-.5)*u):Y(t)>0?M=j(Math.random()*u/2+Y(t)):M=j((Math.random()-1)*u/2+Y(t)),t.style.transform=b+M,await re(I*1e3)},ge=async t=>{t.style.transition=k.snapBackDuration+"ms";const a=Z(t),l=oe(a.x*-k.bouncePower,a.y*-k.bouncePower),n=j(Y(t)*-k.bouncePower);t.style.transform=l+n,await re(k.snapBackDuration*.75),t.style.transform="none",await re(k.snapBackDuration),t.style.transition="10ms"},fe=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>k.swipeThreshold)return"right";if(t.x<-k.swipeThreshold)return"left"}else{if(t.y>k.swipeThreshold)return"up";if(t.y<-k.swipeThreshold)return"down"}return"none"},we=(t,a)=>{const l=a.x-t.x,n=t.y-a.y,h=(a.time-t.time)/1e3;return{x:l/h,y:n/h}},oe=(t,a)=>"translate("+t+"px)",j=t=>"rotate("+t+"deg)",Z=t=>{const a=window.getComputedStyle(t),l=new DOMMatrix(a.transform);return{x:l.m41,y:-l.m42}},Y=t=>{const a=window.getComputedStyle(t),l=new DOMMatrix(a.transform);return-Math.asin(l.m21)/(2*Math.PI)*360},Le=(t,a,l,n)=>{const h={x:t.x+l.x,y:t.y+l.y},p={x:h.x,y:h.y,time:new Date().getTime()},w=oe(h.x),I=we(n,p).x/1e3,S=j(I*k.maxTilt);return a.style.transform=w+S,p},ne=t=>{const a=t.targetTouches[0];return{x:a.clientX,y:a.clientY}},ae=t=>({x:t.clientX,y:t.clientY}),Ve=O.forwardRef(({flickOnSwipe:t=!0,children:a,onSwipe:l,onCardLeftScreen:n,className:h,preventSwipe:p=[],swipeRequirementType:w="velocity",swipeThreshold:I=k.swipeThreshold,onSwipeRequirementFulfilled:S,onSwipeRequirementUnfulfilled:b},M)=>{k.swipeThreshold=I;const u=O.useRef(!1),c=O.useRef();O.useImperativeHandle(M,()=>({async swipe(d="right"){l&&l(d);const s=1e3,f=(Math.random()-.5)*100;d==="right"?await se(c.current,{x:s,y:f},!0):d==="left"&&await se(c.current,{x:-s,y:f},!0),c.current.style.display="none",n&&n(d)},async restoreCard(){c.current.style.display="block",await ge(c.current)}}));const E=O.useCallback(async(d,s)=>{if(u.current)return;u.current=!0;const f=Z(d),A=fe(w==="velocity"?s:f);if(A!=="none"&&(l&&l(A),t&&!p.includes(A))){const P=w==="velocity"?s:ke(f,600);await se(d,P),d.style.display="none",n&&n(A);return}ge(d)},[u,t,l,n,p,w]),y=O.useCallback(()=>{u.current=!1},[u]);return O.useLayoutEffect(()=>{let d={x:null,y:null},s={x:0,y:0},f={x:0,y:0,time:new Date().getTime()},A=!1,P="none";c.current.addEventListener("touchstart",N=>{N.preventDefault(),y(),d={x:-ne(N).x,y:-ne(N).y}}),c.current.addEventListener("mousedown",N=>{N.preventDefault(),A=!0,y(),d={x:-ae(N).x,y:-ae(N).y}});const T=N=>{if(S||b){const g=fe(w==="velocity"?s:Z(c.current));g!==P&&(P=g,P==="none"?b&&b():S&&S(g))}const i=Le(N,c.current,d,f);s=we(f,i),f=i};c.current.addEventListener("touchmove",N=>{N.preventDefault(),T(ne(N))}),c.current.addEventListener("mousemove",N=>{N.preventDefault(),A&&T(ae(N))}),c.current.addEventListener("touchend",N=>{N.preventDefault(),E(c.current,s)}),c.current.addEventListener("mouseup",N=>{A&&(N.preventDefault(),A=!1,E(c.current,s))}),c.current.addEventListener("mouseleave",N=>{A&&(N.preventDefault(),A=!1,E(c.current,s))})},[]),O.createElement("div",{ref:c,className:h},a)});function ce(){const{View:t}=o.useContext(U),[a,l]=t;return r("div",{className:"home-header",children:[e("img",{src:"./assets/img/icons/tinder/profile.svg",onClick:()=>l("profile")}),e("img",{className:"logo",src:"./assets/img/icons/tinder/logo.svg",onClick:()=>l("home")}),e("img",{src:"./assets/img/icons/tinder/messages.svg",onClick:()=>l("messageList")})]})}function Oe(){const{View:t,User:a}=o.useContext(U),[l,n]=t,[h,p]=a,[w,I]=o.useState([]),[S,b]=o.useState(0),[M,u]=o.useState(),c=o.useRef(S),E=o.useRef(0),[y,d]=o.useState(0),[s,f]=o.useState(0),[A,P]=o.useState(!1),[T,N]=o.useState(null);let[i,g]=o.useState("");o.useEffect(()=>{L("Tinder",{action:"getFeed",page:0}).then(v=>{v&&v.length>0?(I(v),b(v.length-1),E.current=v.length,d(Array(v.length).fill(0).map(x=>O.createRef()))):P(!0)})},[]);const C=v=>{b(v),c.current=v},D=S<w.length-1,_=S>=0,B=(v,x,V)=>{u(v),C(V-1),$(),v==="right"?L("Tinder",{action:"swipe",like:!0,number:x.number}).then(Pe=>{Pe&&N(x)}):v==="left"&&L("Tinder",{action:"swipe",like:!1,number:x.number})},q=(v,x)=>{c.current>=x&&y[x].current.restoreCard()},G=async v=>{_&&S<w.length&&(await y[S].current.swipe(v),$())},R=async()=>{var x,V;if(!D)return;const v=S+1;C(v),await((V=(x=y[v])==null?void 0:x.current)==null?void 0:V.restoreCard())},$=()=>{if(E.current>1){E.current=E.current-1;return}L("Tinder",{action:"getFeed",page:s+1}).then(v=>{if(v)if(v&&v.length>0){f(s+1);let x=v.length+w.length;I(V=>(V=[...V,...v],V)),E.current=v.length,b(x-1),d(Array(x).fill(0).map(V=>O.createRef()))}else P(!0)})};return r("div",{className:`home-wrapper slide ${l=="profile"?"left":"right"}`,children:[e(ce,{}),T&&r("div",{className:"match",style:{backgroundImage:`url(${T.photos[0]})`},children:[e("img",{className:"match-image",src:"./assets/img/icons/tinder/match.png"}),r("div",{className:"likes-too",children:[T.name," ",m("APPS.TINDER.LIKES_YOU_TOO").toLowerCase()]}),r("div",{className:"input",children:[e(F,{type:"text",placeholder:m("APPS.TINDER.SAY_SOMETHING_NICE"),onChange:v=>g(v.target.value)}),e("div",{className:"send",onClick:()=>{L("Tinder",{action:"sendMessage",data:{recipient:T.number,content:i}}).then(v=>{v&&(p(T),n("message"))})},children:m("APPS.TINDER.SEND")})]}),e("div",{className:"keep-swiping",onClick:()=>{N(null)},children:m("APPS.TINDER.KEEP_SWIPING")})]}),r("div",{className:"home-body",children:[r("div",{className:"cards",children:[A&&e("div",{className:"card no-more",children:e("div",{children:m("APPS.TINDER.NO_MORE")})}),w.map((v,x)=>e(Ve,{ref:y[x],className:"swipe",onSwipe:V=>B(V,v,x),onCardLeftScreen:()=>q(v,x),children:e(_e,{user:v})},x))]}),r("div",{className:"actions",children:[e("div",{className:"button red",onClick:()=>G("left"),children:e("img",{src:"./assets/img/icons/tinder/close.svg"})}),e("div",{className:`button yellow small ${D?"":"disabled"}`,onClick:()=>R(),children:e("img",{src:"./assets/img/icons/tinder/undo.svg"})}),e("div",{className:"button green",onClick:()=>G("right"),children:e("img",{src:"./assets/img/icons/tinder/heart.svg"})})]})]})]})}const _e=t=>{let a=t.user;const[l,n]=o.useState(0),[h,p]=o.useState(0);return o.useEffect(()=>{p(ee(a.dob))},[a]),r("div",{className:"card",style:{backgroundImage:`url(${a.photos[l]})`},onClick:w=>{l<a.photos.length-1?n(l+1):n(0)},children:[a.photos.length>1&&e("div",{className:"image-count",children:a.photos.map((w,I)=>e("div",{className:`image ${I==l?"active":""}`,onClick:S=>{S.stopPropagation(),n(I)}}))}),r("div",{className:"card-content",children:[r("div",{className:"name",children:[a.name," ",e("span",{children:h})]}),e("div",{className:"description",children:a.bio})]})]})};function $e(){const{Func:t}=o.useContext(ve),{LoggedIn:a,Account:l}=o.useContext(U),n=J(Q.PhoneNumber),[h,p]=t.TextColor,[w,I]=l,[S,b]=a,[M,u]=o.useState("notLoggedIn"),[c,E]=o.useState(0),[y,d]=o.useState({});o.useEffect(()=>{M=="notLoggedIn"?p("#ffffff"):p("#000000")},[M]);const[s,f]=o.useState({name:null,photos:[],dob:{day:"",month:"",year:""},bio:null,showMen:!1,showWomen:!1}),A=P=>{var T,N,i;switch(P){case 0:let g=new Date(`${(T=s.dob)==null?void 0:T.year}/${(N=s.dob)==null?void 0:N.month}/${(i=s.dob)==null?void 0:i.day}`);if(g.isValid()){let C=ee(g);s.name&&s.name.length>=2&&C>=18&&C<=100&&(f({...s,dob:g.getTime()}),E(P+1))}case 1:s.photos.length>0&&E(P+1);case 2:s.bio&&s.bio.length>=10&&E(P+1);case 3:(s.showMen||s.showWomen)&&E(P+1);case 4:(s.isMale==!0||s.isMale==!1)&&L("Tinder",{action:"createAccount",data:{...s,dob:new Date(s.dob).toISOString().split("T")[0]}}).then(C=>{C&&(z.APPS.TINDER.account.set(s),I(s),b(!0))})}};return Date.prototype.isValid=function(){return this.getTime()===this.getTime()},e("div",{className:"login-container",style:{background:M==="notLoggedIn"?"linear-gradient(45deg, #fd267a, #ff6036)":"#ffffff"},children:M==="notLoggedIn"?r(H,{children:[e("svg",{className:"logo",viewBox:"0 0 519 123",children:r("g",{fill:"none",fillRule:"evenodd",children:[e("title",{children:m("APPS.TINDER.TITLE")}),e("path",{d:"M31.5 49.6C55 41.5 59 20.4 56 1c0-.7.6-1.2 1.2-1C79.7 11 105 35 105 71c0 27.6-21.4 52-52.5 52a50 50 0 0 1-28.2-92.7c.6-.4 1.4 0 1.4.7.3 3.7 1.3 13 5.4 18.6h.4z",fill:"#ffffff"}),e("path",{d:"M171.2 101.1l1.7-2 5.3 16.8-.7.7c-4 3.7-10 5.6-17.7 5.6h-.3c-7 0-12.5-2-16.3-5.7-3.8-3.8-5.8-9.5-5.8-16.7V54h-13.5V35.5h13.5V13.2h20.8v22.3h16.5V54h-16.6v41.3c0 1.9.5 8 6.3 8 3 0 5.8-1.1 6.8-2.3zm11 19.2V35.6H203v84.7h-20.8zM192.5 1A12.5 12.5 0 1 1 180 13.6C180 6.8 185.7 1 192.5 1zm66.4 32.5c18 0 27.9 9.8 27.9 27.7v59H266V66.2c-.4-9.6-5-14-14.8-14-8.8 0-15.9 5.4-19.5 10v58h-20.8V35.7h20.8v9c6-5.8 15.6-11 27.2-11zM356 44.4V4.6h20.8v115.8H356v-8.8a34.3 34.3 0 0 1-24.7 10.7c-22.7 0-37.9-17.8-37.9-44.3 0-26.6 15.2-44.4 37.9-44.4A34 34 0 0 1 356 44.4zm0 17.9a25.6 25.6 0 0 0-19.6-10c-12.9 0-21.5 10.3-21.5 25.7 0 15.3 8.6 25.6 21.5 25.6 7.5 0 15.7-4 19.6-9.8V62.3zm69.4-28.7c24.6 0 41.7 19 41.7 46v5.7h-62.9c2.1 11.9 11.5 19.5 24.3 19.5 8.1 0 17-3.5 22.1-8.6L452 95l9.9 14.2-1 .9a48.6 48.6 0 0 1-34.1 12.2c-26 0-44.3-18.3-44.3-44.4a42.8 42.8 0 0 1 43-44.3zm-21.3 36h42.7c-1.2-12.7-11.7-18.5-21.4-18.5-14.6 0-20.1 11-21.3 18.6zm113.3-36h1.5v21l-1.8-.3c-1.5-.3-3.4-.5-5.3-.5-6.7 0-16 4.7-19.5 9.7v56.7h-20.8V35.6h20.9V45c6.9-7.2 16-11.4 25-11.4z",fill:"#ffffff"})]})}),r("div",{className:"buttons",children:[e("div",{className:"disclamer",children:m("APPS.TINDER.AGREE_TERMS")}),e("div",{className:"button create",onClick:()=>{u("createAccount")},children:m("APPS.TINDER.CREATE_ACCOUNT")})]})]}):r("div",{className:"create-account",children:[e(ye,{className:"chevron",onClick:()=>{c>0?E(c-1):u("notLoggedIn")}}),c==0&&r(H,{children:[e("div",{className:"title",children:m("APPS.TINDER.CREATE_ACCOUNT")}),r("div",{className:"form-body",children:[e(F,{defaultValue:Se(n),type:"text",disabled:!0}),e(F,{placeholder:"Name",type:"text",maxLength:25,onChange:P=>{f({...s,name:P.target.value}),P.target.value.length>=3?d({...y,name:!0}):d({...y,name:!1})}}),r("div",{className:"dob",children:[r("div",{className:"inputs",children:[e(F,{placeholder:"MM",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:P=>{f({...s,dob:{...s.dob,month:P.target.value}})}}),e("span",{children:"/"}),e(F,{placeholder:"DD",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:P=>{f({...s,dob:{...s.dob,day:P.target.value}})}}),e("span",{children:"/"}),e(F,{placeholder:"YYYY",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:4,maxLength:4,onChange:P=>{var g,C,D;let T={...s,dob:{...s.dob,year:P.target.value}};f(T);let N=new Date(`${(g=T.dob)==null?void 0:g.year}/${(C=T.dob)==null?void 0:C.month}/${(D=T.dob)==null?void 0:D.day}`),i=ee(N);i>=18&&i<100?d({...y,18:!0}):d({...y,18:!1})}})]}),e("div",{className:"disclamer",children:m("APPS.TINDER.AGE_PUBLIC")}),r("div",{className:"requirement",children:[y[18]?e(K,{className:"green"}):e(X,{className:"red"}),m("APPS.TINDER.BE_OVER_18")]}),r("div",{className:"requirement",children:[y.name?e(K,{className:"green"}):e(X,{className:"red"}),m("APPS.TINDER.NAME_MINIMUM")]})]})]})]}),c==1&&r(H,{children:[e("div",{className:"title",children:m("APPS.TINDER.ADD_PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((P,T)=>{var i;let N=((i=s.photos)==null?void 0:i[T-1])||T==0;return s.photos[T]?e("div",{className:"photo",style:{backgroundImage:`url(${s.photos[T]})`},children:e("div",{className:"button remove",onClick:()=>{let g=s.photos;g.splice(T,1),f({...s,photos:g}),g.length==0&&d({...y,photos:!1})},children:e(le,{})})}):e("div",{className:"photo",children:N&&e("div",{className:"button add",onClick:()=>{var g,C,D;W.Gallery.set({allowExternal:(D=(C=(g=ie)==null?void 0:g.value)==null?void 0:C.AllowExternal)==null?void 0:D.Tinder,onSelect:_=>f({...s,photos:[...s.photos,_.src]})}),d({...y,photos:!0})},children:e(Ne,{})})})})}),r("div",{className:"requirement",children:[y.photos?e(K,{className:"green"}):e(X,{className:"red"}),m("APPS.TINDER.PHOTOS_MINIMUM")]})]}),c==2&&r(H,{children:[e("div",{className:"title",children:m("APPS.TINDER.DESCRIPTION")}),e(pe,{placeholder:"Description",maxLength:200,onChange:P=>{f({...s,bio:P.target.value}),P.target.value.length>=10?d({...y,bio:!0}):d({...y,bio:!1})}}),r("div",{className:"requirement",children:[y.bio?e(K,{className:"green"}):e(X,{className:"red"}),m("APPS.TINDER.DESCRIPTION_MINIMUM")]})]}),c==3&&r(H,{children:[e("div",{className:"title",children:m("APPS.TINDER.SHOW_ME")}),r("div",{className:"showme",children:[e("div",{className:`button border ${s.showWomen&&!s.showMen?"active":""}`,onClick:()=>{f({...s,showMen:!1,showWomen:!0})},children:m("APPS.TINDER.WOMEN")}),e("div",{className:`button border ${s.showMen&&!s.showWomen?"active":""}`,onClick:()=>{f({...s,showMen:!0,showWomen:!1})},children:m("APPS.TINDER.MEN")}),e("div",{className:`button border ${s.showMen&&s.showWomen?"active":""}`,onClick:()=>{f({...s,showMen:!0,showWomen:!0})},children:m("APPS.TINDER.EVERYONE")})]})]}),c==4&&r(H,{children:[e("div",{className:"title",children:m("APPS.TINDER.I_AM")}),r("div",{className:"showme",children:[e("div",{className:`button border ${s.isMale===!0?"active":""}`,onClick:()=>{f({...s,isMale:!0})},children:m("APPS.TINDER.MALE")}),e("div",{className:`button border ${s.isMale===!1?"active":""}`,onClick:()=>{f({...s,isMale:!1})},children:m("APPS.TINDER.FEMALE")})]})]}),e("div",{className:"button gradient",onClick:()=>A(c),children:m("APPS.TINDER.CONTINUE")})]})})}function Fe(){const{Account:t}=o.useContext(U),[a,l]=t,[n,h]=o.useState(a);return r("div",{className:"home-wrapper slide right",style:{backgroundColor:"#F6F6F6"},children:[e(ce,{}),r("div",{className:"profile-body",children:[r("div",{className:"user",children:[e("img",{className:"profile-picture",src:n.photos[0]}),r("div",{className:"name",children:[n.name,", ",ee(n.dob)]})]}),r("div",{className:"inputs",children:[r("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.NAME")}),e(F,{type:"text",defaultValue:n.name,maxLength:10,onChange:p=>{h({...n,name:p.target.value})}})]}),r("div",{className:"input center",children:[e("div",{className:"label",children:m("APPS.TINDER.PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((p,w)=>{var S;let I=((S=n.photos)==null?void 0:S[w-1])||w==0;return n.photos[w]?e("div",{className:"photo",style:{backgroundImage:`url(${n.photos[w]})`},children:e("div",{className:"photo-button remove",onClick:()=>{let b=n.photos;b.splice(w,1),h({...n,photos:b})},children:e(le,{})})},w):e("div",{className:"photo",children:I&&e("div",{className:"photo-button add",onClick:()=>{var b,M,u;W.Gallery.set({allowExternal:(u=(M=(b=ie)==null?void 0:b.value)==null?void 0:M.AllowExternal)==null?void 0:u.Tinder,onSelect:c=>h({...n,photos:[...n.photos,c.src]})})},children:e(Ne,{})})})})})]}),r("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.ABOUT_ME")}),e(pe,{type:"text",defaultValue:n.bio,maxLength:100,onChange:p=>{h({...n,bio:p.target.value})}})]}),r("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.INTERESTED_IN")}),r("select",{value:n.showMen&&n.showWomen?"Everyone":n.showMen?"Men":"Women",onChange:p=>{switch(p.target.value){case"Everyone":h({...n,showMen:!0,showWomen:!0});break;case"Men":h({...n,showMen:!0,showWomen:!1});break;case"Women":h({...n,showMen:!1,showWomen:!0});break}},children:[e("option",{value:"Men",children:m("APPS.TINDER.MEN")}),e("option",{value:"Women",children:m("APPS.TINDER.WOMEN")}),e("option",{value:"Everyone",children:m("APPS.TINDER.EVERYONE")})]})]}),r("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.GENDER")}),r("select",{value:n.isMale?"male":"female",onChange:p=>{p.target.value=="male"?h({...n,isMale:!0}):h({...n,isMale:!1})},children:[e("option",{value:"male",children:m("APPS.TINDER.MALE")}),e("option",{value:"female",children:m("APPS.TINDER.FEMALE")})]})]})]}),e("div",{className:"button gradient",onClick:()=>{n.name.length>=2&&n.bio.length>=5&&n.photos.length>=1?L("Tinder",{action:"saveProfile",data:n}).then(p=>{p&&l(n)}):be("error","Issue saving tinder profile, (name not 2 characters, bio not over 5 or no photos)")},children:m("APPS.TINDER.SAVE")})]})]})}function He(){const{Func:t}=o.useContext(ve),{View:a,User:l}=o.useContext(U),[n,h]=t.TextColor,[p,w]=l,[I,S]=a,[b,M]=o.useState({newMatches:[],messages:[]});return o.useEffect(()=>{h("#000000"),L("Tinder",{action:"getMatches"}).then(u=>{u&&M(u)})},[]),Ee("tinder:newMessage",u=>{let c=u.sender,E=JSON.parse(JSON.stringify(b)),y=E.messages.findIndex(d=>d.number===c);if(y!==-1)E.messages.unshift(E.messages.splice(y,1)[0]);else if(y=E.newMatches.findIndex(d=>d.number===c),y!==-1)E.messages.unshift(E.newMatches.splice(y,1)[0]);else return;E.messages[0].lastMessage=u.content,M(E)}),r("div",{className:"home-wrapper slide left",children:[e(ce,{}),e(Ie,{placeholder:m("APPS.TINDER.SEARCH_MATCHES")}),r("div",{className:"message-list-body",children:[r("div",{className:"new-matches",children:[r("div",{className:"title",children:[m("APPS.TINDER.NEW_MATCHES"),b.newMatches.length>0&&e("span",{children:b.newMatches.length})]}),e("div",{className:"matches",children:b.newMatches.map((u,c)=>{var E;return r("div",{className:"new-match",onClick:()=>{w(u),S("message")},children:[e("img",{className:"profile-picture",src:(E=u.photos)==null?void 0:E[0]}),e("div",{className:"name",children:u.name})]},c)})})]}),r("div",{className:"recent-messages",children:[e("div",{className:"title",children:m("APPS.TINDER.MESSAGES")}),e("div",{className:"messages",children:b.messages.map((u,c)=>{var E;return u.lastMessage.length===0&&(u.lastMessage=m("APPS.MESSAGES.SENT_A_PHOTO")),r("div",{className:"message",onClick:()=>{w(u),S("message")},children:[e("img",{className:"profile-picture",src:(E=u.photos)==null?void 0:E[0]}),r("div",{className:"user",children:[e("div",{className:"name",children:u.name}),e("div",{className:"message",children:u.lastMessage.length>40?u.lastMessage.substring(0,40)+"...":u.lastMessage})]})]},c)})})]})]})]})}function We(){var N;const{View:t,User:a}=o.useContext(U),l=J(Q.Settings),n=J(Q.PhoneNumber),[h,p]=a,[w,I]=t,[S,b]=o.useState(0),[M,u]=o.useState(!1),[c,E]=o.useState(!1),y=o.useRef(null),[d,s]=o.useState({content:"",attachments:[]}),[f,A]=o.useState([]);o.useEffect(()=>{L("Tinder",{action:"getMessages",page:0,number:h.number}).then(i=>{i&&i.length>0?A(i.reverse()):u(!0)})},[]);const P=()=>{if(d.content.length===0&&d.attachments.length===0)return;const i={sender:n,recipient:h.number,content:d.content,attachments:d.attachments,timestamp:new Date};L("Tinder",{action:"sendMessage",data:i}).then(g=>{g&&(y.current.value="",s({content:"",attachments:[]}),A([...f,i]))})};o.useEffect(()=>{let i=document.querySelector(".message-container");i.scrollTop=i.scrollHeight},[f]);const T=i=>{if(M||c)return;let g=document.querySelector("#last");if(!g)return;!De(g)&&(E(!0),L("Tinder",{action:"getMessages",page:S+1,number:h.number}).then(D=>{D&&D.length>0?(A([...D.reverse(),...f]),E(!1)):u(!0)}),b(D=>D+1))};return Ee("tinder:newMessage",i=>{h.number===i.sender&&A([...f,i])}),r("div",{className:"home-wrapper slide left",children:[r("div",{className:"message-header",children:[e(Me,{onClick:()=>{I("messageList"),p(null)}}),r("div",{className:"user",children:[e("img",{className:"profile-picture",src:(N=h.photos)==null?void 0:N[0]}),e("div",{className:"name",children:h.name})]})]}),e("div",{className:"message-container",onScroll:T,children:e("div",{className:"message-body",children:f.map((i,g)=>{var q,G;let C,D=g===0?"last":"",_=i.sender===n?"self":"other",B=((q=f[g+1])==null?void 0:q.sender)===n?"self":"other";return f[g+1]?C=Math.abs(i.timestamp-f[g+1].timestamp)/36e5:B=void 0,r("div",{className:`message ${_}`,id:D,children:[_=="other"?r("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${_!==B?"show":"hide"}`,children:e("img",{src:(G=h.photos)==null?void 0:G[0]})}),r("div",{className:"message-content",children:[i.content&&e("div",{className:"content",children:de(i.content)}),i.attachments.length>0&&e("div",{className:"attatchments",children:i.attachments.map((R,$)=>te(R)?e("video",{src:R,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:v=>{W.FullscreenImage.set({display:!0,image:R})}},$):e(Te,{src:R,onClick:()=>{W.FullscreenImage.set({display:!0,image:R})}},$))})]})]}):r(H,{children:[i.content&&e("div",{className:"content",children:de(i.content)}),i.attachments.length>0&&e("div",{className:"attatchments",children:i.attachments.map((R,$)=>te(R)?e("video",{src:R,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:()=>{W.FullscreenImage.set({display:!0,image:R})}},$):e("img",{src:R,onClick:()=>{W.FullscreenImage.set({display:!0,image:R})}},$))})]}),f[g+1]&&C>6?e("div",{className:"date",children:he(i.timestamp,l.time.twelveHourClock)}):_!==B&&e("div",{className:"date",children:he(i.timestamp,l.time.twelveHourClock)})]},g)})})}),e("div",{className:"attachments",children:d.attachments.map((i,g)=>r("div",{className:"attachment",children:[te(i)?e("video",{src:i,controls:!1,muted:!0,loop:!0,autoPlay:!0}):e("img",{src:i}),e(le,{onClick:()=>{s({...d,attachments:d.attachments.filter((C,D)=>D!==g)})}})]}))}),r("div",{className:"message-bottom",children:[e(Ce,{className:"image",onClick:()=>{var i,g,C;d.attachments.length<3&&W.Gallery.set({includeVideos:!0,allowExternal:(C=(g=(i=ie)==null?void 0:i.value)==null?void 0:g.AllowExternal)==null?void 0:C.Messages,onSelect:D=>s({...d,attachments:[...d.attachments,D.src]})})}}),r("div",{className:"input",children:[e(F,{type:"text",placeholder:"Type a message...",ref:y,onChange:i=>{s({...d,content:i.target.value})},onKeyDown:i=>{i.key==="Enter"&&P()}}),e(Ae,{className:d.attachments.length>0||d.content.length>0?"active":"",onClick:()=>P()})]})]})]})}const U=o.createContext(null);function Ye(){const t=J(Q.Settings),[a,l]=o.useState(!1),[n,h]=o.useState(null),[p,w]=o.useState(null),[I,S]=o.useState("home"),[b,M]=o.useState(!0),u={home:e(Oe,{}),profile:e(Fe,{}),messageList:e(He,{}),message:e(We,{})};return o.useEffect(()=>{if(z.APPS.TINDER.account.value){h(z.APPS.TINDER.account.value),l(!0),M(!1);return}else if(z.APPS.TINDER.account.value===!1)return M(!1);L("Tinder",{action:"isLoggedIn"}).then(c=>{c?(h(c),l(!0),z.APPS.TINDER.account.set(c)):z.APPS.TINDER.account.set(!1),M(!1)})},[]),o.useEffect(()=>{I==="message"?ue.ReceiveAppNotifications.set(!1):ue.ReceiveAppNotifications.set(!0)},[I]),e("div",{className:"tinder-container",children:e(U.Provider,{value:{LoggedIn:[a,l],Account:[n,h],User:[p,w],View:[I,S]},children:b||t.airplaneMode?e("div",{className:"loading",children:e(xe,{size:55,speed:.9,color:"#000000"})}):a?u[I]:e($e,{})})})}function ee(t){var a=+new Date(t);return~~((Date.now()-a)/315576e5)}export{U as TinderContext,Ye as default,ee as getAge};
